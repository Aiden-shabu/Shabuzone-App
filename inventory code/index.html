<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="Shabu Zone">
  <meta name="theme-color" content="#f5f5f0">
  <title>Shabu Zone Management</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background: linear-gradient(135deg, #f5f5f0 0%, #e8e8e0 100%);
      color: #2c3e50;
      min-height: 100vh;
      overflow-x: hidden;
      touch-action: manipulation;
    }
    .header {
      background: white;
      backdrop-filter: blur(10px);
      border-bottom: 2px solid #e2e8f0;
      padding: 1rem;
      position: sticky;
      top: 0;
      z-index: 100;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .logo {
      font-size: clamp(1rem, 4vw, 1.5rem);
      font-weight: 700;
      background: linear-gradient(135deg, #7f1d1d 0%, #991b1b 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }
    .nav {
      background: white;
      border-bottom: 2px solid #e2e8f0;
      overflow-x: auto;
      position: sticky;
      top: 57px;
      z-index: 99;
      -webkit-overflow-scrolling: touch;
      scrollbar-width: none;
    }
    .nav::-webkit-scrollbar { display: none; }
    .nav-inner {
      display: flex;
      gap: 0.5rem;
      padding: 0.75rem 1rem;
      min-width: min-content;
      max-width: 1200px;
      margin: 0 auto;
    }
    .nav-btn {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.625rem 1rem;
      background: transparent;
      border: 1px solid transparent;
      border-radius: 8px;
      color: #64748b;
      cursor: pointer;
      font-size: 0.875rem;
      font-weight: 500;
      white-space: nowrap;
      transition: all 0.2s;
      min-height: 44px;
    }
    .nav-btn.active {
      background: rgba(96,165,250,0.15);
      border-color: rgba(96,165,250,0.3);
      color: #7f1d1d;
    }
    .content {
      padding: 1.5rem 1rem 4rem;
      max-width: 1200px;
      margin: 0 auto;
    }
    .card {
      background: white;
      border: 2px solid #e2e8f0;
      border-radius: 12px;
      padding: 1.25rem;
      margin-bottom: 1rem;
    }
    .stat-card {
      background: linear-gradient(135deg, rgba(96,165,250,0.1) 0%, rgba(59,130,246,0.1) 100%);
      border: 1px solid rgba(96,165,250,0.2);
      border-radius: 12px;
      padding: 1.25rem;
    }
    .stat-label {
      font-size: 0.875rem;
      color: #64748b;
      margin-bottom: 0.5rem;
    }
    .stat-value {
      font-size: 2rem;
      font-weight: 700;
      color: #7f1d1d;
    }
    .btn {
      padding: 1rem;
      background: linear-gradient(135deg, #7f1d1d 0%, #991b1b 100%);
      border: none;
      border-radius: 12px;
      color: white;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      width: 100%;
      min-height: 48px;
      transition: opacity 0.2s;
      white-space: nowrap;
    }
    .btn:active { opacity: 0.7; }
    .btn-secondary {
      background: #f8fafc;
      color: #2c3e50;
      border: 2px solid #e2e8f0;
    }
    .btn-danger {
      background: linear-gradient(135deg, rgba(248,113,113,0.3) 0%, rgba(239,68,68,0.3) 100%);
      border: 1px solid rgba(248,113,113,0.3);
      color: #f87171;
    }
    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
      gap: 1rem;
      margin-bottom: 2rem;
    }
    input, select {
      background: white;
      border: 2px solid #e2e8f0;
      border-radius: 8px;
      padding: 0.75rem;
      color: #2c3e50;
      font-size: 1rem;
      width: 100%;
      min-height: 44px;
    }
    .counter {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      justify-content: center;
    }
    .counter-btn {
      width: 44px;
      height: 44px;
      background: rgba(96,165,250,0.2);
      border: 1px solid rgba(96,165,250,0.3);
      border-radius: 8px;
      color: #7f1d1d;
      font-size: 1.5rem;
      font-weight: 700;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      user-select: none;
    }
    .counter-btn:active { background: rgba(96,165,250,0.3); }
    .counter-input {
      width: 80px;
      text-align: center;
      font-size: 1.125rem;
      font-weight: 600;
    }
    .modal {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0,0,0,0.8);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1000;
      padding: 1rem;
    }
    .modal-content {
      background: #fff;
      border-radius: 12px;
      padding: 1.5rem;
      max-width: 500px;
      width: 100%;
      max-height: 80vh;
      overflow: auto;
      color: #2c3e50;
    }
    .vendor-group {
      background: white;
      border: 2px solid #e2e8f0;
      border-radius: 12px;
      padding: 1rem;
      margin-bottom: 1rem;
    }
    .vendor-title {
      font-size: 1.125rem;
      font-weight: 700;
      color: #7f1d1d;
      margin-bottom: 0.75rem;
      padding-bottom: 0.75rem;
      border-bottom: 2px solid #e2e8f0;
    }
    .shop-item {
      display: grid;
      grid-template-columns: 1fr auto;
      gap: 1rem;
      align-items: center;
      padding: 0.75rem 0;
      border-bottom: 1px solid #e2e8f0;
    }
    .shop-item:last-child {
      border-bottom: none;
    }
    .category-badge {
      display: inline-flex;
      align-items: center;
      gap: 0.25rem;
      padding: 0.25rem 0.5rem;
      border-radius: 6px;
      font-size: 0.75rem;
      font-weight: 500;
    }
    .input-group {
      display: grid;
      gap: 0.75rem;
      margin-bottom: 1rem;
    }
    .scroll-btn {
      position: fixed;
      right: 1rem;
      width: 48px;
      height: 48px;
      background: rgba(96,165,250,0.9);
      border: none;
      border-radius: 50%;
      color: #2c3e50;
      font-size: 1.25rem;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 4px 12px rgba(0,0,0,0.3);
      z-index: 1000;
      transition: all 0.3s;
    }
    .scroll-btn:active {
      transform: scale(0.95);
    }
    .scroll-btn-top {
      bottom: 5rem;
    }
    .scroll-btn-bottom {
      bottom: 1rem;
    }
    
    /* Login & Selection Screens */
    .login-screen, .screen-container {
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      padding: 2rem;
    }
    .login-logo {
      width: 120px;
      height: 120px;
      background: linear-gradient(135deg, #7f1d1d 0%, #991b1b 100%);
      border-radius: 24px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 4rem;
      margin-bottom: 2rem;
      box-shadow: 0 8px 32px rgba(127, 29, 29, 0.3);
    }
    .login-title, .screen-title {
      font-size: 2rem;
      font-weight: 700;
      color: #7f1d1d;
      margin-bottom: 0.5rem;
    }
    .login-subtitle, .screen-subtitle {
      color: #64748b;
      margin-bottom: 2rem;
    }
    .login-input {
      width: 100%;
      max-width: 300px;
      padding: 1rem;
      font-size: 1.5rem;
      text-align: center;
      border: 2px solid #e2e8f0;
      border-radius: 12px;
      background: white;
      letter-spacing: 0.5rem;
      margin-bottom: 1rem;
    }
    .login-input:focus {
      outline: none;
      border-color: #7f1d1d;
    }
    .login-error {
      color: #ef4444;
      font-size: 0.875rem;
      margin-top: 0.5rem;
    }
    .screen-header {
      text-align: center;
      margin-bottom: 3rem;
      position: relative;
    }
    .selection-grid {
      display: grid;
      gap: 1.5rem;
      max-width: 600px;
      margin: 0 auto;
      width: 100%;
    }
    .selection-card {
      background: white;
      border: 2px solid #e2e8f0;
      border-radius: 16px;
      padding: 2rem;
      cursor: pointer;
      transition: all 0.3s;
      text-align: center;
    }
    .selection-card:hover {
      transform: translateY(-4px);
      box-shadow: 0 12px 24px rgba(0,0,0,0.1);
      border-color: #7f1d1d;
    }
    .selection-icon {
      font-size: 3rem;
      margin-bottom: 1rem;
    }
    .selection-name {
      font-size: 1.5rem;
      font-weight: 700;
      color: #2c3e50;
      margin-bottom: 0.5rem;
    }
    .selection-desc {
      color: #64748b;
      font-size: 0.875rem;
    }
    .back-btn-container {
      display: flex;
      align-items: center;
      gap: 1rem;
      margin-bottom: 2rem;
    }
    .back-btn {
      width: 40px;
      height: 40px;
      border-radius: 8px;
      border: 2px solid #e2e8f0;
      background: white;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.25rem;
      color: #2c3e50;
    }
    .back-btn:hover {
      background: #f8fafc;
    }

    /* User Management Styles */
    .register-btn {
      margin-top: 1rem;
      padding: 0.75rem 1.5rem;
      background: transparent;
      border: 2px solid #7f1d1d;
      border-radius: 12px;
      color: #7f1d1d;
      font-size: 0.875rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
      width: 100%;
      max-width: 300px;
    }
    .register-btn:hover {
      background: #7f1d1d;
      color: white;
    }
    .form-group {
      margin-bottom: 1.5rem;
    }
    .form-label {
      display: block;
      font-weight: 600;
      margin-bottom: 0.5rem;
      color: #2c3e50;
      font-size: 0.875rem;
    }
    .form-input {
      width: 100%;
      padding: 0.75rem;
      border: 2px solid #e2e8f0;
      border-radius: 8px;
      font-size: 1rem;
      background: white;
    }
    .form-input:focus {
      outline: none;
      border-color: #7f1d1d;
    }
    .checkbox-group {
      margin-top: 1rem;
      max-height: 300px;
      overflow-y: auto;
      background: #f8fafc;
      padding: 1rem;
      border-radius: 8px;
    }
    .checkbox-item {
      display: flex;
      align-items: center;
      padding: 0.75rem;
      background: white;
      border-radius: 8px;
      margin-bottom: 0.5rem;
      cursor: pointer;
    }
    .checkbox-item:hover {
      background: #f1f5f9;
    }
    .checkbox-item input[type="checkbox"] {
      width: 20px;
      height: 20px;
      margin-right: 0.75rem;
      cursor: pointer;
    }
    .checkbox-item label {
      flex: 1;
      cursor: pointer;
      font-size: 0.875rem;
      font-weight: 500;
      margin: 0;
    }
    .user-list {
      margin-top: 1.5rem;
      max-height: 400px;
      overflow-y: auto;
    }
    .user-item {
      background: #f8fafc;
      padding: 1rem;
      border-radius: 8px;
      margin-bottom: 0.75rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .user-info {
      flex: 1;
    }
    .user-name {
      font-weight: 600;
      color: #2c3e50;
      margin-bottom: 0.25rem;
    }
    .user-permissions {
      font-size: 0.75rem;
      color: #64748b;
    }
    .btn-delete {
      padding: 0.5rem 1rem;
      background: rgba(239, 68, 68, 0.1);
      border: 1px solid rgba(239, 68, 68, 0.3);
      border-radius: 6px;
      color: #ef4444;
      font-size: 0.875rem;
      cursor: pointer;
    }
    .modal-title {
      font-size: 1.25rem;
      font-weight: 700;
      color: #7f1d1d;
      margin-bottom: 1.5rem;
    }
  </style>
</head>
<body>
  <div id="root"></div>

  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-storage-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
  <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>

  <script>
    // Firebase 초기화
    try {
      if (!firebase.apps.length) {
        firebase.initializeApp({
          apiKey: "AIzaSyDmwgN1QiwNMCjjBp1Dlux3ljeVA1Dpxd0",
          authDomain: "shabu-zone-inventory.firebaseapp.com",
          databaseURL: "https://shabu-zone-inventory-default-rtdb.firebaseio.com",
          projectId: "shabu-zone-inventory",
          storageBucket: "shabu-zone-inventory.firebasestorage.app",
          messagingSenderId: "50004599942",
          appId: "1:50004599942:web:71e5571527038c44b1d07"
        });
      }
      window.db = firebase.database();
      window.storage = firebase.storage();
      window.auth = firebase.auth();
      console.log('✅ Firebase initialized successfully');
    } catch (error) {
      console.error('❌ Firebase initialization error:', error);
    }
  </script>

  <script>
    const LOGO_DATA = "data:image/png;base64,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";
    const initialItems = 
[{"name":"Tofu","vendor":"Suns","price":14.85,"current_inventory":1.0,"par":3.0,"category":"refrigerated"},{"name":"Fish ball","vendor":"All Harvest","price":84.0,"current_inventory":1.0,"par":1.0,"category":"frozen"},{"name":"순살 어묵(Korea fish ball)5 back","vendor":"Wang","price":74.5,"current_inventory":6.0,"par":0.0,"category":"frozen"},{"name":"두부어묵(fish tofu)","vendor":"Wang","price":86.0,"current_inventory":7.0,"par":0.0,"category":"frozen"},{"name":"종합어묵(fish cake)","vendor":"Wang","price":62.0,"current_inventory":7.0,"par":3.0,"category":"frozen"},{"name":"비엔나소세지(sausage)","vendor":"Hmart","price":89.0,"current_inventory":4.0,"par":0.5,"category":"refrigerated"},{"name":"Meatball","vendor":"Suns","price":127.95,"current_inventory":2.0,"par":2.0,"category":"frozen"},{"name":"Frozen Corn","vendor":"All Harvest","price":35.0,"current_inventory":1.0,"par":2.0,"category":"frozen"},{"name":"Frozen Thai Pepper","vendor":"HongKong Market","price":140.0,"current_inventory":1.0,"par":1.0,"category":"frozen"},{"name":"Wood ear mushroom","vendor":"HongKong Market","price":10.0,"current_inventory":20.0,"par":10.0,"category":"refrigerated"},{"name":"White Shemej mushroom","vendor":"Jusgo","price":30.0,"current_inventory":2.0,"par":3.0,"category":"refrigerated"},{"name":"Brown Shemej mushroom","vendor":"King","price":30.0,"current_inventory":2.0,"par":3.0,"category":"refrigerated"},{"name":"Enoki mushroom","vendor":"Greatwall","price":45.0,"current_inventory":4.0,"par":5.0,"category":"refrigerated"},{"name":"쪽파(green onion)","vendor":"King ","price":36.0,"current_inventory":3.0,"par":3.0,"category":"refrigerated"},{"name":"대파(big green onion)","vendor":"Hmart","price":32.0,"current_inventory":3.0,"par":2.0,"category":"refrigerated"},{"name":"Radish","vendor":"Hmart","price":32.0,"current_inventory":5.0,"par":2.0,"category":"refrigerated"},{"name":"Cilantro","vendor":"King","price":14.0,"current_inventory":2.0,"par":2.0,"category":"refrigerated"},{"name":"Yellow Peppers(6)","vendor":"Suns","price":16.1,"current_inventory":2.0,"par":0.0,"category":"refrigerated"},{"name":"Taro root Fresh","vendor":"King","price":30.0,"current_inventory":0.5,"par":1.0,"category":"refrigerated"},{"name":"Bean sprout","vendor":"suns","price":10.5,"current_inventory":2.0,"par":1.0,"category":"refrigerated"},{"name":"Yellow Onion ","vendor":"Suns","price":24.0,"current_inventory":1.0,"par":2.0,"category":"refrigerated"},{"name":"Red Onion","vendor":"China","price":13.5,"current_inventory":0.5,"par":0.5,"category":"refrigerated"},{"name":"Jalapeno ","vendor":"China","price":20.95,"current_inventory":0.5,"par":1.0,"category":"refrigerated"},{"name":"TW Cabbage","vendor":"King","price":20.0,"current_inventory":2.0,"par":0.0,"category":"refrigerated"},{"name":"Napa cabbage","vendor":"King","price":32.0,"current_inventory":2.0,"par":1.0,"category":"refrigerated"},{"name":"Spinach","vendor":"Suns","price":21.75,"current_inventory":2.0,"par":2.0,"category":"refrigerated"},{"name":"Baby bokchoy","vendor":"King","price":30.0,"current_inventory":1.0,"par":2.0,"category":"refrigerated"},{"name":"Tong Ho","vendor":"King","price":42.0,"current_inventory":3.0,"par":4.0,"category":"refrigerated"},{"name":"Watercress","vendor":"King","price":24.0,"current_inventory":3.0,"par":5.0,"category":"refrigerated"},{"name":"Green Leaf Lettuce","vendor":"King","price":64.0,"current_inventory":1.0,"par":1.0,"category":"refrigerated"},{"name":"단호박(kabucha)pumpkin","vendor":"King","price":30.0,"current_inventory":0.0,"par":0.0,"category":"refrigerated"},{"name":"Broccoli","vendor":"King","price":15.0,"current_inventory":1.0,"par":1.0,"category":"refrigerated"},{"name":"Udon ","vendor":"Four Season","price":35.0,"current_inventory":9.0,"par":3.0,"category":"refrigerated"},{"name":"라면사리(ramen sari)","vendor":"Wang","price":24.0,"current_inventory":19.0,"par":10.0,"category":"refrigerated"},{"name":"Egg noodle ","vendor":"China","price":49.5,"current_inventory":1.5,"par":2.0,"category":"dry"},{"name":"Vermaceli","vendor":"Suns","price":25.95,"current_inventory":1.0,"par":1.0,"category":"refrigerated"},{"name":"파래곤약(green noodle)","vendor":"Wang","price":48.5,"current_inventory":1.0,"par":2.0,"category":"dry"},{"name":"해초곤약(black noodle)","vendor":"Wang","price":48.5,"current_inventory":2.0,"par":2.0,"category":"dry"},{"name":"Rice Cake","vendor":"Wang","price":48.0,"current_inventory":2.5,"par":2.0,"category":"dry"},{"name":"조랭이떡 (small rice cake)","vendor":"Wang","price":52.0,"current_inventory":2.0,"par":2.0,"category":"dry"},{"name":"Pork dumpling","vendor":"China","price":55.5,"current_inventory":2.0,"par":2.0,"category":"refrigerated"},{"name":"Vegie dumpling","vendor":"China","price":55.0,"current_inventory":3.0,"par":2.0,"category":"refrigerated"},{"name":"Chicken Dumpling","vendor":"China","price":55.5,"current_inventory":2.0,"par":2.0,"category":"refrigerated"},{"name":"Egg  ","vendor":"China","price":18.0,"current_inventory":4.0,"par":2.0,"category":"refrigerated"},{"name":"Tomato","vendor":"Four Season","price":24.0,"current_inventory":1.0,"par":1.0,"category":"refrigerated"},{"name":"Carrot","vendor":"King","price":14.0,"current_inventory":1.0,"par":1.0,"category":"refrigerated"},{"name":"Taiwan spinach","vendor":"Jusgo","price":16.0,"current_inventory":2.0,"par":3.0,"category":"refrigerated"},{"name":"Bell pepper","vendor":"King","price":35.0,"current_inventory":1.0,"par":0.0,"category":"refrigerated"},{"name":"Crab stick","vendor":"All Harvest","price":81.4,"current_inventory":2.0,"par":2.0,"category":"refrigerated"},{"name":"Octopus","vendor":"All Harvest","price":60.0,"current_inventory":7.0,"par":5.0,"category":"refrigerated"},{"name":"Mussel (2)","vendor":"All Harvest","price":30.0,"current_inventory":1.5,"par":6.0,"category":"refrigerated"},{"name":"Oyster","vendor":"All Harvest","price":256.0,"current_inventory":3.0,"par":3.0,"category":"refrigerated"},{"name":"Short Neck clam","vendor":"All Harvest","price":32.0,"current_inventory":5.0,"par":6.0,"category":"refrigerated"},{"name":"Blue crab","vendor":"T&Y","price":270.0,"current_inventory":5.0,"par":2.0,"category":"refrigerated"},{"name":"Shrimp 30-40","vendor":"All Harvest","price":124.0,"current_inventory":4.0,"par":3.0,"category":"refrigerated"},{"name":"Shrimp 9-12","vendor":"MFE/All Harvest","price":405.6,"current_inventory":0.0,"par":0.5,"category":"refrigerated"},{"name":"Shrimp 26-30","vendor":"All Harvest","price":111.0,"current_inventory":2.0,"par":0.5,"category":"refrigerated"},{"name":"Fish Fillet","vendor":"All Harvest","price":27.0,"current_inventory":4.0,"par":6.0,"category":"refrigerated"},{"name":"Squid ring","vendor":"All Harvest","price":64.0,"current_inventory":3.0,"par":3.0,"category":"refrigerated"},{"name":"Carving Squid","vendor":"All Harvest","price":64.0,"current_inventory":3.0,"par":3.0,"category":"refrigerated"},{"name":"Baby cuttlefish(2)","vendor":"All Harvest","price":88.8,"current_inventory":2.0,"par":2.0,"category":"refrigerated"},{"name":"Scallop 30-40(3)","vendor":"All Harvest","price":174.0,"current_inventory":3.0,"par":3.0,"category":"refrigerated"},{"name":"Pork & Shrimp wonton","vendor":"All Harvest","price":55.0,"current_inventory":6.0,"par":0.0,"category":"refrigerated"},{"name":"Whelk(3)","vendor":"All Harvest","price":51.92,"current_inventory":3.0,"par":0.0,"category":"refrigerated"},{"name":"Watermelon","vendor":"Hmart","price":5.99,"current_inventory":9.0,"par":3.0,"category":"refrigerated"},{"name":"Honeydew(6)","vendor":"Hmart","price":20.0,"current_inventory":2.5,"par":0.0,"category":"refrigerated"},{"name":"Spicy chili crisp","vendor":"Suns","price":79.0,"current_inventory":2.0,"par":2.0,"category":"refrigerated"},{"name":"Cocktail Fruit Can ","vendor":"Four Season","price":35.45,"current_inventory":1.0,"par":2.0,"category":"refrigerated"},{"name":"Tomyang","vendor":"hong Kong","price":110.0,"current_inventory":2.5,"par":0.0,"category":"refrigerated"},{"name":"Fresh mushroom","vendor":"Sysco","price":19.95,"current_inventory":1.0,"par":0.0,"category":"refrigerated"},{"name":"짜장 우동면(jajang korea noodle)","vendor":"Wang","price":30.0,"current_inventory":4.0,"par":2.0,"category":"dry"},{"name":"생칼국수(korea noodle)","vendor":"Wang","price":30.0,"current_inventory":4.0,"par":1.0,"category":"dry"},{"name":"녹차칼국수(green Korea noodle)","vendor":"Wang","price":40.0,"current_inventory":4.0,"par":1.0,"category":"dry"},{"name":"Gummy bear(4)","vendor":"Suns","price":10.48,"current_inventory":16.0,"par":0.0,"category":"refrigerated"},{"name":"peeled garlic","vendor":"king","price":90.0,"current_inventory":1.5,"par":2.0,"category":"refrigerated"},{"name":"Lemon","vendor":"Sysco","price":26.5,"current_inventory":1.0,"par":1.0,"category":"refrigerated"},{"name":"Greentea icecream","vendor":"Suns","price":23.95,"current_inventory":2.0,"par":3.0,"category":"frozen"},{"name":"Chocolate Ice Cream","vendor":"Suns","price":20.95,"current_inventory":2.0,"par":3.0,"category":"frozen"},{"name":"Mango icecream","vendor":"Suns","price":22.95,"current_inventory":3.0,"par":3.0,"category":"frozen"},{"name":"Coffee icecream","vendor":"Suns","price":23.95,"current_inventory":3.0,"par":3.0,"category":"frozen"},{"name":"Strawberry Ice Cream","vendor":"Suns","price":21.95,"current_inventory":3.0,"par":3.0,"category":"frozen"},{"name":"Red Bean icecream","vendor":"Suns","price":22.958,"current_inventory":3.0,"par":3.0,"category":"frozen"},{"name":"Vanilla Icre Cream","vendor":"Suns","price":20.95,"current_inventory":2.0,"par":3.0,"category":"refrigerated"},{"name":"Rainbow Sparkles","vendor":"Suns","price":22.5,"current_inventory":2.0,"par":2.0,"category":"refrigerated"},{"name":"Extra Ice cream ","vendor":"Suns","price":23.95,"current_inventory":2.0,"par":0.0,"category":"frozen"},{"name":"Memmi","vendor":"China","price":52.95,"current_inventory":5.0,"par":0.0,"category":"refrigerated"},{"name":"Tonkotsu","vendor":"Kazy","price":92.95,"current_inventory":9.0,"par":0.0,"category":"refrigerated"},{"name":"Shoyu","vendor":"Kazy","price":64.95,"current_inventory":3.25,"par":0.0,"category":"refrigerated"},{"name":"Miso","vendor":"Kazy","price":82.85,"current_inventory":21.5,"par":0.0,"category":"refrigerated"},{"name":"Sukiyaki","vendor":"JFE","price":95.0,"current_inventory":4.0,"par":0.0,"category":"refrigerated"},{"name":"Rice","vendor":"China","price":33.95,"current_inventory":3.0,"par":1.0,"category":"dry"},{"name":"가츠오부시(bonito)","vendor":"Suns","price":83.5,"current_inventory":2.5,"par":3.0,"category":"refrigerated"},{"name":"말린표고 (shitake mushroom bag)(6)","vendor":"Suns","price":48.324999999999996,"current_inventory":5.0,"par":0.0,"category":"dry"},{"name":"건다시마(kelp)","vendor":"Wang","price":175.0,"current_inventory":1.2,"par":1.0,"category":"refrigerated"},{"name":"Mushroom Seasoning","vendor":"Suns","price":59.5,"current_inventory":9.0,"par":4.0,"category":"refrigerated"},{"name":"Dried Bean Curd Stick","vendor":"China","price":99.99,"current_inventory":1.5,"par":1.0,"category":"dry"},{"name":"말린양파(dry onion)","vendor":"Suns","price":25.95,"current_inventory":0.75,"par":1.0,"category":"dry"},{"name":"말린 새우(dry shrimp)","vendor":"Suns","price":49.45,"current_inventory":1.0,"par":1.0,"category":"dry"},{"name":"디포리(depory)","vendor":"Hmart","price":8.99,"current_inventory":7.0,"par":10.0,"category":"refrigerated"},{"name":"말린 관자(dry scallop)","vendor":"HongKong Market","price":18.49,"current_inventory":1.3,"par":10.0,"category":"dry"},{"name":"Coconut Milk","vendor":"China","price":49.95,"current_inventory":1.25,"par":2.0,"category":"refrigerated"},{"name":"Sriracha(5 warehouse)","vendor":"China","price":107.0,"current_inventory":4.3,"par":0.0,"category":"refrigerated"},{"name":"Hot sauce(4)","vendor":"Sysco","price":31.95,"current_inventory":0.75,"par":0.0,"category":"dry"},{"name":"Sweet Chili Sauce","vendor":"China","price":28.5,"current_inventory":3.3,"par":3.0,"category":"dry"},{"name":"멸치젓(korean fish sauce)","vendor":"Hmart","price":5.49,"current_inventory":2.0,"par":1.0,"category":"dry"},{"name":"까나리젓","vendor":"","price":0,"current_inventory":0.0,"par":1.0,"category":"refrigerated"},{"name":"Fish Sauce","vendor":"China","price":12.95,"current_inventory":2.0,"par":3.0,"category":"dry"},{"name":"Apple Juice","vendor":"Jusgo","price":6.491,"current_inventory":2.0,"par":1.0,"category":"refrigerated"},{"name":"Lemon Juice","vendor":"Suns","price":26.95,"current_inventory":0.5,"par":1.0,"category":"refrigerated"},{"name":"Lemonnade","vendor":"Suns","price":8.991,"current_inventory":1.5,"par":1.0,"category":"refrigerated"},{"name":"Vinegar","vendor":"China","price":8.95,"current_inventory":2.25,"par":3.0,"category":"dry"},{"name":"Mirin","vendor":"Kazy","price":44.95,"current_inventory":1.0,"par":2.0,"category":"dry"},{"name":"Soy Sauce Low Sodium","vendor":"Kazy","price":27.23,"current_inventory":1.0,"par":3.0,"category":"dry"},{"name":"Soy Sauce Original","vendor":"Kazy","price":27.23,"current_inventory":2.0,"par":3.0,"category":"dry"},{"name":"Hoisin Sauce","vendor":"Sysco","price":47.0,"current_inventory":1.0,"par":1.0,"category":"dry"},{"name":"Mayonnaise","vendor":"Suns","price":30.85,"current_inventory":2.25,"par":2.0,"category":"refrigerated"},{"name":"Sour cream","vendor":"Suns","price":6.85,"current_inventory":1.0,"par":1.0,"category":"refrigerated"},{"name":"Peanut Oil(6)","vendor":"Sysco","price":49.25,"current_inventory":0.8,"par":0.0,"category":"dry"},{"name":"Sesame oil(10)","vendor":"Suns","price":164.95,"current_inventory":1.1,"par":0.0,"category":"dry"},{"name":"Veggie Oil","vendor":"Four Season","price":39.95,"current_inventory":2.5,"par":2.0,"category":"dry"},{"name":"Cooking Wine","vendor":"Four Season","price":22.95,"current_inventory":2.0,"par":1.0,"category":"refrigerated"},{"name":"Frozen Lemon Grass","vendor":"HongKong Market","price":3.29,"current_inventory":3.0,"par":0.5,"category":"frozen"},{"name":"Baby Corn","vendor":"Four Season","price":57.0,"current_inventory":3.0,"par":1.0,"category":"refrigerated"},{"name":"Sweet Corn","vendor":"Sysco","price":40.75,"current_inventory":1.25,"par":1.0,"category":"refrigerated"},{"name":"Pineapple Chunk","vendor":"Suns","price":32.95,"current_inventory":1.0,"par":1.0,"category":"refrigerated"},{"name":"Salt","vendor":"China","price":6.13,"current_inventory":2.0,"par":1.0,"category":"dry"},{"name":"Sugar","vendor":"Suns","price":29.25,"current_inventory":1.0,"par":2.0,"category":"dry"},{"name":"볶은 콩가루(peanut powder)","vendor":"Wang","price":67.0,"current_inventory":2.0,"par":1.0,"category":"dry"},{"name":"Sesame ","vendor":"Suns","price":6.48,"current_inventory":3.0,"par":5.0,"category":"dry"},{"name":"Black sesame","vendor":"Suns","price":7.49,"current_inventory":2.0,"par":5.0,"category":"dry"},{"name":"Wasabi(10)","vendor":"Suns","price":47.5,"current_inventory":0.5,"par":0.0,"category":"refrigerated"},{"name":"Capsaicin(10)","vendor":"Wang","price":7.15,"current_inventory":1.0,"par":0.0,"category":"refrigerated"},{"name":"고추가루(pepper powder)","vendor":"Wang","price":57.2,"current_inventory":5.0,"par":2.0,"category":"dry"},{"name":"Liquid smoke(1 each)","vendor":"restaurant depot","price":0,"current_inventory":1.0,"par":0.0,"category":"refrigerated"},{"name":"Volkov 190 proof","vendor":"Liquid store","price":16.99,"current_inventory":2.0,"par":1.0,"category":"refrigerated"},{"name":"Dried Red Chili","vendor":"Suns","price":58.75,"current_inventory":1.0,"par":1.0,"category":"dry"},{"name":"Clrox","vendor":"Suns","price":12.95,"current_inventory":2.0,"par":2.0,"category":"refrigerated"},{"name":"Fabloso","vendor":"Suns","price":13.99,"current_inventory":1.0,"par":2.0,"category":"refrigerated"},{"name":"Dawn","vendor":"Suns","price":11.95,"current_inventory":8.0,"par":6.0,"category":"dry"},{"name":"Kitchen Knife","vendor":"JKS","price":0,"current_inventory":20.0,"par":0.0,"category":"dry"},{"name":"Meat Knife","vendor":"JKS","price":0,"current_inventory":2.0,"par":0.0,"category":"dry"},{"name":"Meat paper","vendor":"Heart brand","price":40.0,"current_inventory":18.0,"par":5.0,"category":"dry"},{"name":"Jelly (case)(4)","vendor":"Suns","price":0,"current_inventory":1.3,"par":0.0,"category":"dry"},{"name":"Coconut condenced milk","vendor":"Suns","price":0,"current_inventory":10.5,"par":0.0,"category":"refrigerated"},{"name":"Milk","vendor":"Suns","price":0,"current_inventory":2.0,"par":2.0,"category":"refrigerated"},{"name":"Shin Ramen","vendor":"H mart","price":16.0,"current_inventory":3.0,"par":0.0,"category":"dry"},{"name":"Hand soap ","vendor":"Suns club","price":0,"current_inventory":1.0,"par":0.0,"category":"dry"},{"name":"Fried Bean Curd Roll","vendor":"Suns club","price":80.0,"current_inventory":8.0,"par":0.0,"category":"refrigerated"},{"name":"Dry seaweed Knot","vendor":"China","price":150.0,"current_inventory":1.0,"par":0.0,"category":"refrigerated"},{"name":"Cheese rice cake","vendor":"Wang","price":54.5,"current_inventory":3.0,"par":0.0,"category":"dry"},{"name":"Sweet potato rice cake","vendor":"Wang","price":54.5,"current_inventory":3.0,"par":0.0,"category":"dry"},{"name":"Chinese donut","vendor":"suns club","price":37.95,"current_inventory":2.0,"par":0.0,"category":"dry"},{"name":"Sweet potato noodle","vendor":"Wang","price":60.0,"current_inventory":0.0,"par":0.0,"category":"dry"},{"name":"Gradual peanut","vendor":"restaurant depot","price":19.0,"current_inventory":5.0,"par":0.0,"category":"refrigerated"},{"name":"Soya bean curd sauce","vendor":"Mt trading","price":46.95,"current_inventory":6.0,"par":0.0,"category":"dry"},{"name":"Cantonese suki sauce","vendor":"ITC Trading","price":56.0,"current_inventory":11.0,"par":0.0,"category":"dry"}];

    const { useState, useEffect, createElement: h } = React;
    const { createRoot } = ReactDOM;

    const translations = {
      ko: {
        dashboard: '대시보드', count: '재고 실사', shopping: '쇼핑 리스트', add: '추가', reports: '리포트',
        shoppingList: '쇼핑 리스트',
        totalItems: '전체 품목', lowStock: '부족 재고', totalValue: '총 가치',
        lowStockAlert: '부족 재고 알림', generateShopping: '쇼핑 리스트 생성',
        item: '품목', par: 'PAR', current: '현재', qty: '수량', total: '합계',
        completePurchase: '구매 완료', vendor: '벤더', price: '가격',
        category: '카테고리', all: '전체', frozen: '냉동', refrigerated: '냉장', dry: '실온 보관',
        simpleView: '간단히 보기', copyAll: '전체 복사', close: '닫기', copied: '복사됨!',
        purchaseHistory: '구매 내역', date: '날짜', items: '품목', amount: '금액',
        noData: '구매 내역이 없습니다',
        addNewItem: '새 품목 추가', itemName: '품목명', selectVendor: '벤더 선택', addItem: '품목 추가',
        manageItems: '품목 관리', save: '저장', edit: '수정', delete: '삭제',
        addItems: '아이템 추가', manageVendors: '벤더 관리', manageCategories: '분류 관리',
        searchItems: '아이템 검색...', itemCategory: '분류 선택', selectCategory: '분류 선택',
        vendorName: '벤더명', addVendor: '벤더 추가', deleteVendor: '벤더 삭제',
        categoryName: '분류명', addCategory: '분류 추가', deleteCategory: '삭제',
        byStorage: '보관별', byCategory: '분류별',
        resetData: '데이터 초기화', enterPassword: '비밀번호 입력',
        reset: '초기화', cancel: '취소', wrongPassword: '비밀번호가 틀렸습니다!',
        resetWarning: '재고 수량, 쇼핑 리스트, 구매 내역이 초기화됩니다. 품목과 벤더는 유지됩니다.',
        dataReset: '데이터가 초기화되었습니다!',
        saveAndContinue: '저장하기', backToEdit: '← 수정하기',
        itemAnalysis: '아이템 분석', exportExcel: '엑셀 다운로드',
        lastUsed: '전날 사용', weeklyAvg: '주간 평균', showChart: '차트 보기', hideChart: '차트 닫기',
        usageChart: '사용량 그래프 (7일)', noHistory: '구매 내역이 없어 분석할 수 없습니다',
        registerCount: '등록하기', countRecords: '재고 실사 내역', countRegistered: '재고 실사가 등록되었습니다!',
        purchaseConfirmation: '구매 확인', miscellaneous: 'Miscellaneous',
        miscellaneousDesc: '재고 외 구매 아이템 (구매내역에만 기록)',
        calendarTitle: '📅 재고실사 기록',
        countCompleted: '실사 완료',
        today: '오늘',
        monthNames: ['1월', '2월', '3월', '4월', '5월', '6월', '7월', '8월', '9월', '10월', '11월', '12월'],
        dayNames: ['일', '월', '화', '수', '목', '금', '토'],
        itemNamePlaceholder: '아이템명',
        pricePlaceholder: '가격',
        quantityPlaceholder: '수량',
        addButton: '+ 추가',
        deleteButton: '삭제',
        // Management/Schedule translations  
        management: {
          title: '스케줄 관리',
          tabs: {
            employees: '직원 관리',
            requirements: '인원 설정',
            preferences: '희망 스케줄',
            schedule: '스케줄',
            excelView: '엑셀 뷰',
            sections: '섹션'
          },
          employees: {
            title: '직원 관리',
            addEmployee: '직원 추가',
            name: '이름',
            gender: '성별',
            male: '남자',
            female: '여자',
            status: '상태',
            active: '근무 가능',
            cantWork: '근무 불가',
            save: '저장',
            cancel: '취소',
            noEmployees: "아직 직원이 없습니다. '직원 추가'를 클릭하세요!",
            cantWorkDetails: '근무 불가 상세',
            reason: '사유',
            startDate: '시작일',
            endDate: '종료일'
          },
          requirements: {
            title: '주간 필요 인원',
            copyPrevious: '이전 주 복사',
            lunch: '점심',
            dinner: '저녁',
            open: '오픈~브레이크',
            eleven: '11:00~브레이크',
            elevenThirty: '11:30~브레이크',
            threeThirty: '3:30~마감',
            six: '6:00~마감',
            total: '합계',
            holiday: '특별일'
          },
          preferences: {
            title: '직원 희망 스케줄',
            selectEmployee: '-- 직원 선택 --',
            minGuarantee: '최소 보장 시프트',
            savePreferences: '저장',
            lastSaved: '마지막 저장',
            clickToCycle: '클릭하여 색상 변경',
            morning: '오전',
            evening: '오후',
            fixed: '고정'
          },
          schedule: {
            title: '주간 스케줄',
            runSchedule: '스케줄 생성',
            noSchedule: "아직 스케줄이 없습니다. '스케줄 생성'을 클릭하세요!",
            generating: '스케줄 생성 중...',
            lunch: '점심',
            dinner: '저녁'
          },
          excelView: {
            title: '엑셀 뷰 - 스케줄 편집',
            noSchedule: "아직 스케줄이 없습니다. 스케줄 탭에서 '스케줄 생성'을 먼저 실행하세요!",
            lunchCount: '점심 인원',
            dinnerCount: '저녁 인원',
            allDayCount: '종일 인원',
            clickToEdit: '클릭하여 시프트 편집',
            changeShift: '시프트 변경',
            currentShift: '현재',
            changeTo: '변경',
            switchEmployee: '직원 교체',
            off: 'OFF',
            availableEmployees: '교체 가능 직원',
            swapWith: '클릭하여 교체'
          },
          sections: {
            title: '섹션 배정',
            comingSoon: '준비 중입니다!'
          }
        }
      },
      en: {
        dashboard: 'Dashboard', count: 'Count', shopping: 'Shopping', add: 'Add', reports: 'Reports',
        shoppingList: 'Shopping List',
        totalItems: 'Total Items', lowStock: 'Low Stock', totalValue: 'Total Value',
        lowStockAlert: 'Low Stock Alert', generateShopping: 'Generate Shopping List',
        item: 'Item', par: 'PAR', current: 'Current', qty: 'Qty', total: 'Total',
        completePurchase: 'Complete Purchase', vendor: 'Vendor', price: 'Price',
        category: 'Category', all: 'All', frozen: 'Frozen', refrigerated: 'Refrigerated', dry: 'Dry Storage',
        simpleView: 'Simple View', copyAll: 'Copy All', close: 'Close', copied: 'Copied!',
        purchaseHistory: 'Purchase History', date: 'Date', items: 'Items', amount: 'Amount',
        noData: 'No purchase history yet',
        addNewItem: 'Add New Item', itemName: 'Item Name', selectVendor: 'Select Vendor', addItem: 'Add Item',
        byStorage: 'By Storage', byCategory: 'By Category',
        manageItems: 'Manage Items', save: 'Save', edit: 'Edit', delete: 'Delete',
        addItems: 'Add Items', manageVendors: 'Manage Vendors', manageCategories: 'Manage Categories',
        vendorName: 'Vendor Name', addVendor: 'Add Vendor', deleteVendor: 'Delete Vendor',
        selectCategory: 'Select Category', addCategory: 'Add Category',
        searchItems: 'Search items...', itemCategory: 'Item Category',
        resetData: 'Reset Data', enterPassword: 'Enter Password',
        reset: 'Reset', cancel: 'Cancel', wrongPassword: 'Wrong password!',
        resetWarning: 'This will reset inventory quantities, clear shopping list and purchase history.',
        dataReset: 'Data reset successfully!',
        saveAndContinue: 'Save & Continue', backToEdit: '← Back to Edit',
        itemAnalysis: 'Item Analysis', exportExcel: 'Export Excel',
        lastUsed: 'Last Used', weeklyAvg: 'Weekly Avg', showChart: 'Show Chart', hideChart: 'Hide Chart',
        usageChart: 'Usage Chart (7 Days)', noHistory: 'No purchase history for analysis',
        registerCount: 'Register', countRecords: 'Count Records', countRegistered: 'Inventory count registered!',
        purchaseConfirmation: 'Purchase Confirmation', miscellaneous: 'Miscellaneous',
        miscellaneousDesc: 'Non-inventory purchase items (recorded in history only)',
        calendarTitle: '📅 Count Records',
        countCompleted: 'Completed',
        today: 'Today',
        monthNames: ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'],
        dayNames: ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'],
        itemNamePlaceholder: 'Item Name',
        pricePlaceholder: 'Price',
        quantityPlaceholder: 'Quantity',
        addButton: '+ Add',
        deleteButton: 'Delete',
        // Management/Schedule translations
        management: {
          title: 'Schedule Manager',
          tabs: {
            employees: 'Employees',
            requirements: 'Requirements', 
            preferences: 'Preferences',
            schedule: 'Schedule',
            excelView: 'Excel View',
            sections: 'Sections'
          },
          employees: {
            title: 'Employee Management',
            addEmployee: 'Add Employee',
            name: 'Name',
            gender: 'Gender',
            male: 'Male',
            female: 'Female',
            status: 'Status',
            active: 'Active',
            cantWork: "Can't Work",
            save: 'Save',
            cancel: 'Cancel',
            noEmployees: "No employees yet. Click 'Add Employee' to start!",
            cantWorkDetails: "Can't Work Details",
            reason: 'Reason',
            startDate: 'Start Date',
            endDate: 'End Date'
          },
          requirements: {
            title: 'Weekly Requirements',
            copyPrevious: 'Copy Previous Week',
            lunch: 'LUNCH',
            dinner: 'DINNER',
            open: 'Open~Break',
            eleven: '11:00~Break',
            elevenThirty: '11:30~Break',
            threeThirty: '3:30~Close',
            six: '6:00~Close',
            total: 'Total',
            holiday: 'Holiday'
          },
          preferences: {
            title: 'Employee Preferences',
            selectEmployee: '-- Select Employee --',
            minGuarantee: 'Min. Guaranteed Shifts',
            savePreferences: 'Save Preferences',
            lastSaved: 'Last saved',
            clickToCycle: 'Click to cycle colors',
            morning: 'Morning',
            evening: 'Evening',
            fixed: 'Fixed'
          },
          schedule: {
            title: 'Weekly Schedule',
            runSchedule: 'Run Schedule',
            noSchedule: "No schedule generated yet. Click 'Run Schedule' to create!",
            generating: 'Generating schedule...',
            lunch: 'Lunch',
            dinner: 'Dinner'
          },
          excelView: {
            title: 'Excel View - Edit Schedule',
            noSchedule: "No schedule yet. Go to Schedule tab and click 'Run Schedule' first!",
            lunchCount: 'Lunch Count',
            dinnerCount: 'Dinner Count',
            allDayCount: 'All Day Count',
            clickToEdit: 'Click to edit shift',
            changeShift: 'Change Shift',
            currentShift: 'Current',
            changeTo: 'Change to',
            switchEmployee: 'Switch Employee',
            off: 'OFF',
            availableEmployees: 'Available Employees',
            swapWith: 'Click to swap with'
          },
          sections: {
            title: 'Section Assignment',
            comingSoon: 'Coming soon!'
          }
        },
        manageItems: 'Manage Items', save: 'Save', edit: 'Edit', delete: 'Delete',
        addItems: 'Add Items', manageVendors: 'Manage Vendors', manageCategories: 'Manage Categories',
        vendorName: 'Vendor Name', addVendor: 'Add Vendor', deleteVendor: 'Delete Vendor',
        addNewItem: 'Add New Item', itemName: 'Item Name', selectVendor: 'Select Vendor', 
        selectCategory: 'Select Category', addItem: 'Add Item', addCategory: 'Add Category',
        searchItems: 'Search items...', itemCategory: 'Item Category',
        resetData: 'Reset Data', enterPassword: 'Enter Password',
        reset: 'Reset', cancel: 'Cancel', wrongPassword: 'Wrong password!',
        resetWarning: 'This will reset inventory quantities, clear shopping list and purchase history.',
        dataReset: 'Data reset successfully!',
        saveAndContinue: 'Save & Continue', backToEdit: '← Back to Edit',
        itemAnalysis: 'Item Analysis', exportExcel: 'Export Excel',
        lastUsed: 'Last Used', weeklyAvg: 'Weekly Avg', showChart: 'Show Chart', hideChart: 'Hide Chart',
        usageChart: 'Usage Chart (7 Days)', noHistory: 'No purchase history for analysis',
        registerCount: 'Register', countRecords: 'Count Records', countRegistered: 'Inventory count registered!'
      },
      es: {
        dashboard: 'Panel', count: 'Inventario', shopping: 'Compras', add: 'Agregar', reports: 'Informes',
        shoppingList: 'Lista de Compras',
        totalItems: 'Total Artículos', lowStock: 'Stock Bajo', totalValue: 'Valor Total',
        lowStockAlert: 'Alerta de Stock Bajo', generateShopping: 'Generar Lista de Compras',
        item: 'Artículo', par: 'PAR', current: 'Actual', qty: 'Cant', total: 'Total',
        completePurchase: 'Completar Compra', vendor: 'Proveedor', price: 'Precio',
        category: 'Categoría', all: 'Todos', frozen: 'Congelado', refrigerated: 'Refrigerado', dry: 'Almacén Seco',
        simpleView: 'Vista Simple', copyAll: 'Copiar Todo', close: 'Cerrar', copied: '¡Copiado!',
        purchaseHistory: 'Historial de Compras', date: 'Fecha', items: 'Artículos', amount: 'Monto',
        noData: 'No hay historial de compras',
        addNewItem: 'Agregar Nuevo Artículo', itemName: 'Nombre', selectVendor: 'Seleccionar Proveedor', addItem: 'Agregar',
        manageItems: 'Gestionar Artículos', save: 'Guardar', edit: 'Editar', delete: 'Eliminar',
        addItems: 'Agregar Artículos', manageVendors: 'Gestionar Proveedores', manageCategories: 'Gestionar Categorías',
        vendorName: 'Nombre Proveedor', addVendor: 'Agregar Proveedor', deleteVendor: 'Eliminar',
        selectCategory: 'Seleccionar Categoría', addCategory: 'Agregar Categoría',
        searchItems: 'Buscar artículos...', itemCategory: 'Categoría de Artículo',
        byStorage: 'Por Almacenamiento', byCategory: 'Por Categoría',
        resetData: 'Restablecer Datos', enterPassword: 'Ingresar Contraseña',
        reset: 'Restablecer', cancel: 'Cancelar', wrongPassword: '¡Contraseña incorrecta!',
        resetWarning: 'Esto restablecerá las cantidades de inventario, lista de compras e historial.',
        dataReset: '¡Datos restablecidos!',
        saveAndContinue: 'Guardar', backToEdit: '← Editar',
        itemAnalysis: 'Análisis de Artículos', exportExcel: 'Exportar Excel',
        lastUsed: 'Último Uso', weeklyAvg: 'Promedio Semanal', showChart: 'Mostrar Gráfico', hideChart: 'Ocultar',
        usageChart: 'Gráfico de Uso (7 Días)', noHistory: 'No hay historial para análisis',
        registerCount: 'Registrar', countRecords: 'Registros de Inventario', countRegistered: '¡Inventario registrado!',
        purchaseConfirmation: 'Confirmación de Compra', miscellaneous: 'Misceláneos',
        miscellaneousDesc: 'Artículos de compra fuera del inventario (solo se registra en el historial)',
        calendarTitle: '📅 Registros de Inventario',
        countCompleted: 'Completado',
        today: 'Hoy',
        monthNames: ['Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio', 'Julio', 'Agosto', 'Septiembre', 'Octubre', 'Noviembre', 'Diciembre'],
        dayNames: ['Dom', 'Lun', 'Mar', 'Mié', 'Jue', 'Vie', 'Sáb'],
        itemNamePlaceholder: 'Nombre del Artículo',
        pricePlaceholder: 'Precio',
        quantityPlaceholder: 'Cantidad',
        addButton: '+ Agregar',
        deleteButton: 'Eliminar',
      },
      zh: {
        dashboard: '仪表板', count: '库存盘点', shopping: '购物清单', add: '添加', reports: '报告',
        totalItems: '总项目', lowStock: '低库存', totalValue: '总价值',
        lowStockAlert: '低库存警报', generateShopping: '生成购物清单',
        item: '项目', par: 'PAR', current: '当前', qty: '数量', total: '总计',
        completePurchase: '完成购买', vendor: '供应商', price: '价格',
        category: '类别', all: '全部', frozen: '冷冻', refrigerated: '冷藏', dry: '干货',
        simpleView: '简单视图', copyAll: '全部复制', close: '关闭', copied: '已复制！',
        purchaseHistory: '购买历史', date: '日期', items: '项目', amount: '金额',
        noData: '暂无购买历史',
        addNewItem: '添加新项目', itemName: '项目名称', selectVendor: '选择供应商', addItem: '添加项目',
        manageItems: '管理项目', save: '保存', edit: '编辑', delete: '删除',
        addItems: '添加项目', manageVendors: '管理供应商', vendorName: '供应商名称', addVendor: '添加供应商', deleteVendor: '删除',
        resetData: '重置数据', enterPassword: '输入密码',
        reset: '重置', cancel: '取消', wrongPassword: '密码错误！',
        resetWarning: '这将重置库存数量、购物清单和购买历史。',
        dataReset: '数据已重置！',
        saveAndContinue: '保存', backToEdit: '← 编辑',
        itemAnalysis: '项目分析', exportExcel: '导出Excel',
        lastUsed: '上次使用', weeklyAvg: '周平均', showChart: '显示图表', hideChart: '隐藏',
        usageChart: '使用图表（7天）', noHistory: '无历史记录可分析',
        registerCount: '登记', countRecords: '盘点记录', countRegistered: '库存盘点已登记！'
      },
      vi: {
        dashboard: 'Bảng điều khiển', count: 'Kiểm kho', shopping: 'Mua sắm', add: 'Thêm', reports: 'Báo cáo',
        totalItems: 'Tổng mặt hàng', lowStock: 'Hàng sắp hết', totalValue: 'Tổng giá trị',
        lowStockAlert: 'Cảnh báo hàng sắp hết', generateShopping: 'Tạo danh sách mua',
        item: 'Mặt hàng', par: 'PAR', current: 'Hiện tại', qty: 'SL', total: 'Tổng',
        completePurchase: 'Hoàn tất mua hàng', vendor: 'Nhà cung cấp', price: 'Giá',
        category: 'Danh mục', all: 'Tất cả', frozen: 'Đông lạnh', refrigerated: 'Làm lạnh', dry: 'Khô',
        simpleView: 'Xem đơn giản', copyAll: 'Sao chép tất cả', close: 'Đóng', copied: 'Đã sao chép!',
        purchaseHistory: 'Lịch sử mua hàng', date: 'Ngày', items: 'Mặt hàng', amount: 'Số tiền',
        noData: 'Chưa có lịch sử mua hàng',
        addNewItem: 'Thêm mặt hàng mới', itemName: 'Tên mặt hàng', selectVendor: 'Chọn nhà cung cấp', addItem: 'Thêm',
        manageItems: 'Quản lý mặt hàng', save: 'Lưu', edit: 'Sửa', delete: 'Xóa',
        addItems: 'Thêm mặt hàng', manageVendors: 'Quản lý nhà cung cấp', vendorName: 'Tên NCC', addVendor: 'Thêm NCC', deleteVendor: 'Xóa',
        resetData: 'Đặt lại dữ liệu', enterPassword: 'Nhập mật khẩu',
        reset: 'Đặt lại', cancel: 'Hủy', wrongPassword: 'Mật khẩu sai!',
        resetWarning: 'Điều này sẽ đặt lại số lượng tồn kho, danh sách mua và lịch sử.',
        dataReset: 'Dữ liệu đã được đặt lại!',
        saveAndContinue: 'Lưu', backToEdit: '← Sửa',
        itemAnalysis: 'Phân tích mặt hàng', exportExcel: 'Xuất Excel',
        lastUsed: 'Dùng lần cuối', weeklyAvg: 'TB tuần', showChart: 'Hiện biểu đồ', hideChart: 'Ẩn',
        usageChart: 'Biểu đồ sử dụng (7 ngày)', noHistory: 'Không có lịch sử để phân tích',
        registerCount: 'Đăng ký', countRecords: 'Lịch sử kiểm kho', countRegistered: 'Kiểm kho đã đăng ký!'
      }
    };

    const storageIcons = { frozen: '❄️', refrigerated: '🧊', dry: '📦', all: '📋' };
    const categoryColors = { frozen: '#4ade80', refrigerated: '#7f1d1d', dry: '#fbbf24' };

    function App() {
      const [items, setItems] = useState([]); // 빈 배열로 초기화
      // 로그인 & 네비게이션
      const [screen, setScreen] = useState(() => {
        const savedUser = localStorage.getItem('currentUser');
        const lastActive = localStorage.getItem('lastActiveTime');
        if (savedUser && lastActive) {
          const elapsed = Date.now() - parseInt(lastActive);
          if (elapsed <= 7200000) {
            const savedScreen = localStorage.getItem('currentScreen');
            return savedScreen || 'location';
          }
        }
        return 'login';
      });
      const [password, setPassword] = useState('');
      const [loginError, setLoginError] = useState('');
      const [currentLocation, setCurrentLocation] = useState(() => {
        return localStorage.getItem('currentLocation') || '';
      });
      const [currentModule, setCurrentModule] = useState(() => {
        return localStorage.getItem('currentModule') || '';
      });
      const [managementType, setManagementType] = useState(''); // 'server' or 'kitchen'
      const [inventoryRole, setInventoryRole] = useState(() => {
        return localStorage.getItem('inventoryRole') || '';
      }); // 'manager' or 'employee'
      
      // 사용자 관리
      const [currentUser, setCurrentUser] = useState(() => {
        const saved = localStorage.getItem('currentUser');
        const lastActive = localStorage.getItem('lastActiveTime');
        if (saved && lastActive) {
          const elapsed = Date.now() - parseInt(lastActive);
          // 2시간 (7200000ms) 이상 비활성 시 자동 로그아웃
          if (elapsed > 7200000) {
            localStorage.removeItem('currentUser');
            localStorage.removeItem('lastActiveTime');
            localStorage.removeItem('currentLocation');
            localStorage.removeItem('currentModule');
            return null;
          }
          return saved;
        }
        return null;
      });
      const [isAdmin, setIsAdmin] = useState(false);
      const [users, setUsers] = useState([]);
      const [showRegisterModal, setShowRegisterModal] = useState(false);
      const [showUserManagement, setShowUserManagement] = useState(false);
      const [editingUser, setEditingUser] = useState(null); // 편집 중인 사용자 ID
      const [locations, setLocations] = useState(['houston', 'seattle']);
      const [showAddLocation, setShowAddLocation] = useState(false);
      const [newLocationName, setNewLocationName] = useState('');
      const [registerData, setRegisterData] = useState({
        name: '',
        password: '',
        isAdmin: false,
        preferredLanguage: 'ko',
        permissions: {
          houston_inventory_employee: false,
          houston_inventory_manager: false,
          houston_server: false,
          houston_kitchen: false,
          seattle_inventory_employee: false,
          seattle_inventory_manager: false,
          seattle_server: false,
          seattle_kitchen: false
        }
      });
      
      const [activeTab, setActiveTab] = useState('dashboard');
      const [language, setLanguage] = useState(() => {
        return localStorage.getItem('appLanguage') || 'ko';
      });
      const [loading, setLoading] = useState(false);
      const [shoppingList, setShoppingList] = useState([]);
      const [orderedLists, setOrderedLists] = useState([]); // 주문 완료된 리스트들
      const [shoppingSubTab, setShoppingSubTab] = useState('list'); // 'list' or 'confirm'
      const [showAddItemModal, setShowAddItemModal] = useState(false);
      const [addItemSearch, setAddItemSearch] = useState('');
      const [addItemQuantity, setAddItemQuantity] = useState(1);
      const [miscItems, setMiscItems] = useState([]);
      const [newMisc, setNewMisc] = useState({ name: '', price: 0, quantity: 1 });
      const [shoppingStep, setShoppingStep] = useState('edit');
      const [purchaseHistory, setPurchaseHistory] = useState([]);
      const [categoryFilter, setCategoryFilter] = useState('all');
      const [filterMode, setFilterMode] = useState('storage'); // 'storage' or 'category'
      const [showSimpleView, setShowSimpleView] = useState(false);
      const [purchaseData, setPurchaseData] = useState(null);
      const [selectedPurchase, setSelectedPurchase] = useState(null);
      const [copySuccess, setCopySuccess] = useState(false);
      const [showResetModal, setShowResetModal] = useState(false);
      const [resetPassword, setResetPassword] = useState('');
      const [addSubTab, setAddSubTab] = useState('items');
      const [itemSearch, setItemSearch] = useState('');
      const [searchTrigger, setSearchTrigger] = useState(0);
      const [stockStatusFilter, setStockStatusFilter] = useState('all'); // 'all', 'low', 'ok', 'ordered'
      const [selectedDeliveryItems, setSelectedDeliveryItems] = useState({}); // {orderId: [itemIdx1, itemIdx2, ...]}
      const [expandedOrders, setExpandedOrders] = useState({}); // {orderId: true/false}
      const [vendors, setVendors] = useState([]);
      const [newVendor, setNewVendor] = useState('');
      const [vendorToDelete, setVendorToDelete] = useState(null);
      const [vendorReassignments, setVendorReassignments] = useState({});
      const [newItem, setNewItem] = useState({ 
        name: '',           // 영어 (기본)
        name_ko: '',        // 한국어
        name_es: '',        // 스페인어
        vendor: '', 
        price: 0, 
        par: 0, 
        category: 'refrigerated' 
      });
      const [editingItem, setEditingItem] = useState(null);
      const [showImageModal, setShowImageModal] = useState(false);
      const [selectedItemForImage, setSelectedItemForImage] = useState(null);
      const [uploadingImage, setUploadingImage] = useState(false);
      const [reportsSubTab, setReportsSubTab] = useState('history');
      const [expandedChart, setExpandedChart] = useState(null);
      const [itemSearchQuery, setItemSearchQuery] = useState('');
      const [showScrollButtons, setShowScrollButtons] = useState(false);
      const [tempItems, setTempItems] = useState([]);
      const [countRecords, setCountRecords] = useState([]);
      const [calendarMonth, setCalendarMonth] = useState(new Date());
      const [selectedDateRecords, setSelectedDateRecords] = useState(null);
      const [searchTerm, setSearchTerm] = useState('');
      const [countSearchTerm, setCountSearchTerm] = useState('');
      const [categories, setCategories] = useState([
        'Meat', 'Seafood', 'Vegetable', 'Dry Food', 'Korean Market',
        'Sysco - Beverages/Food', 'Sysco - Gloves', 'Sysco - Ice Cream',
        'Sysco - To-go/Cleaning', 'Sysco - Soup Base', 'Sysco - Operations'
      ]);
      const [itemCategories, setItemCategories] = useState({});
      const [newCategory, setNewCategory] = useState({ name_en: '', name_ko: '', name_es: '', icon: '📦' });
      const [categoryData, setCategoryData] = useState({});

      const categoryTranslations = {
        ko: {
          'all': '전체',
          'Meat': '고기',
          'Seafood': '해산물',
          'Vegetable': '야채',
          'Dry Food': '건조식품',
          'Korean Market': '한국마켓',
          'Sysco - Beverages/Food': 'Sysco - 음료/식품',
          'Sysco - Gloves': 'Sysco - 장갑',
          'Sysco - Ice Cream': 'Sysco - 아이스크림',
          'Sysco - To-go/Cleaning': 'Sysco - 포장/청소',
          'Sysco - Soup Base': 'Sysco - 육수',
          'Sysco - Operations': 'Sysco - 운영용품'
        },
        en: {
          'all': 'All'
        },
        es: {
          'all': 'Todos',
          'Meat': 'Carne',
          'Seafood': 'Mariscos',
          'Vegetable': 'Verduras',
          'Dry Food': 'Alimentos Secos',
          'Korean Market': 'Mercado Coreano'
        }
      };

      const categoryIcons = {
        'all': '📋',
        'Meat': '🥩',
        'Seafood': '🦐',
        'Vegetable': '🥬',
        'Dry Food': '📦',
        'Korean Market': '🇰🇷',
        'Sysco - Beverages/Food': '🥤',
        'Sysco - Gloves': '🧤',
        'Sysco - Ice Cream': '🍦',
        'Sysco - To-go/Cleaning': '🧹',
        'Sysco - Soup Base': '🍲',
        'Sysco - Operations': '⚙️'
      };

      function getCategoryName(cat) {
        // categoryData에서 먼저 확인 (사용자 추가 분류)
        if (categoryData[cat]) {
          const data = categoryData[cat];
          if (language === 'ko' && data.name_ko) return data.name_ko;
          if (language === 'es' && data.name_es) return data.name_es;
          return data.name_en || cat;
        }
        // 기본 번역에서 확인
        if (categoryTranslations[language] && categoryTranslations[language][cat]) {
          return categoryTranslations[language][cat];
        }
        return cat;
      }

      // 아이템 이름 다국어 처리
      function getItemName(item) {
        if (language === 'ko' && item.name_ko) return item.name_ko;
        if (language === 'es' && item.name_es) return item.name_es;
        return item.name; // 영어 (기본)
      }

      // getCategoryLabel은 getCategoryName과 동일
      const getCategoryLabel = getCategoryName;

      function getCategoryIcon(cat) {
        if (categoryData[cat] && categoryData[cat].icon) {
          return categoryData[cat].icon;
        }
        return categoryIcons[cat] || '📦';
      }

      const t = translations[language];

      useEffect(() => {
        if (currentLocation && screen === 'inventory') {
          loadData();
        }
      }, [currentLocation, screen]);

      useEffect(() => {
        const handleScroll = () => {
          setShowScrollButtons(window.scrollY > 300);
        };
        window.addEventListener('scroll', handleScroll);
        return () => window.removeEventListener('scroll', handleScroll);
      }, []);

      // 활동 시간 업데이트
      useEffect(() => {
        if (currentUser) {
          const updateActivity = () => {
            localStorage.setItem('lastActiveTime', Date.now().toString());
          };
          
          // 초기 설정
          updateActivity();
          
          // 사용자 활동 감지 (클릭, 키보드, 스크롤)
          window.addEventListener('click', updateActivity);
          window.addEventListener('keydown', updateActivity);
          window.addEventListener('scroll', updateActivity);
          
          // 1분마다 세션 체크
          const checkSession = setInterval(() => {
            const lastActive = localStorage.getItem('lastActiveTime');
            if (lastActive) {
              const elapsed = Date.now() - parseInt(lastActive);
              if (elapsed > 7200000) {
                handleLogout();
              }
            }
          }, 60000);
          
          return () => {
            window.removeEventListener('click', updateActivity);
            window.removeEventListener('keydown', updateActivity);
            window.removeEventListener('scroll', updateActivity);
            clearInterval(checkSession);
          };
        }
      }, [currentUser]);

      // 로그아웃 함수
      const handleLogout = async () => {
        // Firebase Auth 로그아웃
        try {
          await firebase.auth().signOut();
          console.log('✅ Firebase Auth: Signed out');
        } catch (error) {
          console.log('⚠️ Firebase Auth 로그아웃 실패 (괜찮음):', error.message);
        }
        
        localStorage.removeItem('currentUser');
        localStorage.removeItem('lastActiveTime');
        localStorage.removeItem('currentLocation');
        localStorage.removeItem('currentModule');
        localStorage.removeItem('currentScreen');
        localStorage.removeItem('inventoryRole');
        localStorage.removeItem('managementType');
        setCurrentUser(null);
        setIsAdmin(false);
        setCurrentLocation('');
        setCurrentModule('');
        setScreen('login');
        setPassword('');
      };

      // 언어 변경 시 저장
      useEffect(() => {
        localStorage.setItem('appLanguage', language);
      }, [language]);

      // 사용자 데이터 로드
      useEffect(() => {
        loadUsers();
      }, []);

      async function loadUsers() {
        try {
          const usersSnap = await window.db.ref('users').once('value');
          if (usersSnap.exists()) {
            const usersData = usersSnap.val();
            const usersList = Object.keys(usersData).map(key => ({
              id: key,
              ...usersData[key]
            }));
            setUsers(usersList);
          }
        } catch (error) {
          console.error('Error loading users:', error);
        }
      }

      // 지점 데이터 로드
      useEffect(() => {
        loadLocations();
      }, []);

      async function loadLocations() {
        try {
          const locationsSnap = await window.db.ref('locations').once('value');
          if (locationsSnap.exists()) {
            setLocations(locationsSnap.val());
          } else {
            // 기본 지점 저장
            await window.db.ref('locations').set(['houston', 'seattle']);
          }
        } catch (error) {
          console.error('Error loading locations:', error);
        }
      }

      function scrollToTop() {
        window.scrollTo({ top: 0, behavior: 'smooth' });
      }

      function scrollToBottom() {
        window.scrollTo({ top: document.body.scrollHeight, behavior: 'smooth' });
      }


      // Firebase 경로 헬퍼
      function getPath(path) {
        if (!currentLocation) {
          console.warn('⚠️ currentLocation이 설정되지 않음');
          return 'houston/inventory/' + path;
        }
        console.log('📍 Path:', currentLocation + '/inventory/' + path);
        return currentLocation + '/inventory/' + path;
      }
      
      // 로그인 & 네비게이션 함수
      async function handleLogin(e) {
        e.preventDefault();
        
        // 관리자 로그인
        if (password === '0214') {
          // Firebase Auth 익명 로그인 (보안 규칙용)
          try {
            await firebase.auth().signInAnonymously();
            console.log('✅ Firebase Auth: Admin signed in');
          } catch (error) {
            console.log('⚠️ Firebase Auth 실패 (괜찮음):', error.message);
          }
          
          setIsAdmin(true);
          const adminUser = { name: 'Admin', isAdmin: true };
          setCurrentUser(adminUser);
          localStorage.setItem('currentUser', JSON.stringify(adminUser));
          localStorage.setItem('lastActiveTime', Date.now().toString());
          setScreen('location');
          localStorage.setItem('currentScreen', 'location');
          setPassword('');
          setLoginError('');
          return;
        }
        
        // 일반 사용자 로그인
        const user = users.find(u => u.password === password);
        if (user) {
          // Firebase Auth 익명 로그인 (보안 규칙용)
          try {
            await firebase.auth().signInAnonymously();
            console.log('✅ Firebase Auth: User signed in');
          } catch (error) {
            console.log('⚠️ Firebase Auth 실패 (괜찮음):', error.message);
          }
          
          // 사용자가 관리자인지 확인
          if (user.isAdmin) {
            setIsAdmin(true);
            setCurrentUser(user);
            localStorage.setItem('currentUser', JSON.stringify(user));
            localStorage.setItem('lastActiveTime', Date.now().toString());
            
            // 사용자 선호 언어 적용
            if (user.preferredLanguage) {
              setLanguage(user.preferredLanguage);
              localStorage.setItem('language', user.preferredLanguage);
            }
            
            setScreen('location');
            localStorage.setItem('currentScreen', 'location');
            setPassword('');
            setLoginError('');
            return;
          }
          
          setIsAdmin(false);
          setCurrentUser(user);
          localStorage.setItem('currentUser', JSON.stringify(user));
          localStorage.setItem('lastActiveTime', Date.now().toString());
          
          // 사용자 선호 언어 적용
          if (user.preferredLanguage) {
            setLanguage(user.preferredLanguage);
            localStorage.setItem('language', user.preferredLanguage);
          }
          
          setPassword('');
          setLoginError('');
          
          // 권한 확인 및 페이지 이동
          const perms = user.permissions || {};
          const availablePages = [];
          
          // 동적으로 사용 가능한 페이지 생성
          locations.forEach(location => {
            if (perms[`${location}_inventory_employee`]) {
              availablePages.push({ 
                location, 
                module: 'inventory',
                role: 'employee',
                name: `${formatLocationName(location)} - Employee Inventory` 
              });
            }
            if (perms[`${location}_inventory_manager`]) {
              availablePages.push({ 
                location, 
                module: 'inventory',
                role: 'manager',
                name: `${formatLocationName(location)} - Manager Inventory` 
              });
            }
            if (perms[`${location}_server`]) {
              availablePages.push({ 
                location, 
                module: 'management', 
                type: 'server',
                name: `${formatLocationName(location)} - Server` 
              });
            }
            if (perms[`${location}_kitchen`]) {
              availablePages.push({ 
                location, 
                module: 'management', 
                type: 'kitchen',
                name: `${formatLocationName(location)} - Kitchen` 
              });
            }
          });
          
          if (availablePages.length === 0) {
            setLoginError('접근 권한이 없습니다. 관리자에게 문의하세요.');
            setCurrentUser(null);
          } else if (availablePages.length === 1) {
            // 권한이 1개만 있으면 자동 이동
            const page = availablePages[0];
            setCurrentLocation(page.location);
            localStorage.setItem('currentLocation', page.location);
            
            if (page.module === 'inventory') {
              // Employee 또는 Manager role 설정
              if (page.role) {
                setInventoryRole(page.role);
                localStorage.setItem('inventoryRole', page.role);
              }
              setScreen('inventory');
              localStorage.setItem('currentScreen', 'inventory');
              // Employee는 count 탭, Manager는 dashboard 탭
              setActiveTab(page.role === 'employee' ? 'count' : 'dashboard');
            } else {
              setManagementType(page.type);
              localStorage.setItem('managementType', page.type);
              setScreen('management');
              localStorage.setItem('currentScreen', 'management');
            }
          } else {
            // 여러 권한이 있으면 선택 화면
            setScreen('user-page-select');
            localStorage.setItem('currentScreen', 'user-page-select');
          }
        } else {
          setLoginError('비밀번호가 올바르지 않습니다');
        }
      }
      
      function selectLocation(loc) {
        setCurrentLocation(loc);
        localStorage.setItem('currentLocation', loc);
        setScreen('menu');
        localStorage.setItem('currentScreen', 'menu');
      }
      
      function selectModule(mod) {
        setCurrentModule(mod);
        localStorage.setItem('currentModule', mod);
        if (mod === 'inventory') {
          // Inventory 선택 시 Role 선택 화면으로
          setScreen('inventory-role');
          localStorage.setItem('currentScreen', 'inventory-role');
        } else if (mod === 'management') {
          setScreen('management-select');
          localStorage.setItem('currentScreen', 'management-select');
        }
      }
      
      function selectInventoryRole(role) {
        setInventoryRole(role);
        localStorage.setItem('inventoryRole', role);
        setScreen('inventory');
        localStorage.setItem('currentScreen', 'inventory');
        if (role === 'manager') {
          setActiveTab('dashboard');
        } else {
          // Employee는 Count 탭부터 시작
          setActiveTab('count');
        }
      }
      
      function selectManagementType(type) {
        setManagementType(type);
        localStorage.setItem('managementType', type);
        setScreen('management');
        localStorage.setItem('currentScreen', 'management');
      }
      
      function goBack() {
        // 일반 사용자의 경우
        if (currentUser && !isAdmin) {
          if (screen === 'inventory' || screen === 'management') {
            // Inventory나 Management에서 뒤로가기 → 사용자 페이지 선택 화면
            setScreen('user-page-select');
            localStorage.setItem('currentScreen', 'user-page-select');
            setInventoryRole('');
            localStorage.removeItem('inventoryRole');
            setManagementType('');
            localStorage.removeItem('managementType');
            return;
          }
        }
        
        // Admin의 경우 (기존 로직)
        if (screen === 'inventory') {
          setScreen('inventory-role');
          localStorage.setItem('currentScreen', 'inventory-role');
          setInventoryRole('');
          localStorage.removeItem('inventoryRole');
        } else if (screen === 'inventory-role') {
          setScreen('menu');
          localStorage.setItem('currentScreen', 'menu');
          setCurrentModule('');
          localStorage.removeItem('currentModule');
        } else if (screen === 'management') {
          setScreen('management-select');
          localStorage.setItem('currentScreen', 'management-select');
          setManagementType('');
          localStorage.removeItem('managementType');
        } else if (screen === 'management-select') {
          setScreen('menu');
          localStorage.setItem('currentScreen', 'menu');
          setCurrentModule('');
          localStorage.removeItem('currentModule');
        } else if (screen === 'menu') {
          setScreen('location');
          localStorage.setItem('currentScreen', 'location');
          setCurrentLocation('');
          localStorage.removeItem('currentLocation');
        } else if (screen === 'admin-user-management') {
          setScreen('location');
        } else if (screen === 'location') {
          setScreen('login');
          setCurrentUser(null);
          setIsAdmin(false);
        }
      }
      
      // 로그아웃
      
      // 사용자 등록
      async function handleRegister() {
        if (!registerData.name || !registerData.password) {
          alert('이름과 비밀번호를 입력해주세요');
          return;
        }
        
        // 관리자가 아니면 권한 필요
        if (!registerData.isAdmin) {
          const hasAnyPermission = Object.values(registerData.permissions).some(v => v);
          if (!hasAnyPermission) {
            alert('최소 하나 이상의 권한을 선택하거나 관리자 권한을 부여하세요');
            return;
          }
        }
        
        try {
          const newUserId = Date.now().toString();
          await window.db.ref(`users/${newUserId}`).set({
            name: registerData.name,
            password: registerData.password,
            isAdmin: registerData.isAdmin || false,
            permissions: registerData.permissions,
            createdAt: new Date().toISOString()
          });
          
          alert('사용자가 등록되었습니다');
          setShowRegisterModal(false);
          setRegisterData({
            name: '',
            password: '',
            isAdmin: false,
            preferredLanguage: 'ko',
            permissions: {}
          });
          loadUsers();
        } catch (error) {
          console.error('Error registering user:', error);
          alert('사용자 등록 중 오류가 발생했습니다');
        }
      }

      // 사용자 삭제
      async function handleDeleteUser(userId) {
        if (!confirm('이 사용자를 삭제하시겠습니까?')) return;
        
        try {
          await window.db.ref(`users/${userId}`).remove();
          alert('사용자가 삭제되었습니다');
          loadUsers();
        } catch (error) {
          console.error('Error deleting user:', error);
          alert('사용자 삭제 중 오류가 발생했습니다');
        }
      }

      // 권한 업데이트
      function updatePermission(permKey, value) {
        setRegisterData({
          ...registerData,
          permissions: {
            ...registerData.permissions,
            [permKey]: value
          }
        });
      }

      // 권한 라벨 가져오기
      function getPermissionLabel(permKey) {
        const parts = permKey.split('_');
        if (parts.length < 2) return permKey;
        
        const location = formatLocationName(parts[0]);
        const type = parts[1];
        const subtype = parts[2]; // employee or manager
        
        const typeLabels = {
          inventory: subtype === 'employee' ? 'Employee Inventory' : 
                     subtype === 'manager' ? 'Manager Inventory' : 'Inventory',
          server: 'Server Management',
          kitchen: 'Kitchen Management'
        };
        
        return `${location} - ${typeLabels[type] || type}`;
      }

      // 사용자 권한 문자열
      function getUserPermissions(user) {
        if (user.isAdmin) {
          return '🔑 관리자 (모든 권한)';
        }
        const perms = user.permissions || {};
        const activePerms = Object.keys(perms).filter(key => perms[key]).map(getPermissionLabel);
        return activePerms.join(', ') || '권한 없음';
      }

      // 페이지 선택 화면으로 이동
      function selectUserPage(page) {
        setCurrentLocation(page.location);
        if (page.module === 'inventory') {
          // Employee 또는 Manager role 설정
          if (page.role) {
            setInventoryRole(page.role);
            localStorage.setItem('inventoryRole', page.role);
          }
          setScreen('inventory');
          // Employee는 count 탭, Manager는 dashboard 탭
          setActiveTab(page.role === 'employee' ? 'count' : 'dashboard');
        } else {
          setManagementType(page.type);
          setScreen('management');
        }
      }

      // 지점 추가
      async function addLocation() {
        const locationName = newLocationName.trim().toLowerCase();
        if (!locationName) {
          alert('지점 이름을 입력하세요');
          return;
        }
        if (locations.includes(locationName)) {
          alert('이미 존재하는 지점입니다');
          return;
        }
        
        try {
          const updatedLocations = [...locations, locationName];
          await window.db.ref('locations').set(updatedLocations);
          setLocations(updatedLocations);
          setNewLocationName('');
          setShowAddLocation(false);
          alert('지점이 추가되었습니다');
        } catch (error) {
          console.error('Error adding location:', error);
          alert('지점 추가 중 오류가 발생했습니다');
        }
      }

      // 지점 삭제
      async function deleteLocation(locationName) {
        if (locationName === 'houston' || locationName === 'seattle') {
          alert('기본 지점은 삭제할 수 없습니다');
          return;
        }
        
        if (!confirm(`${locationName} 지점을 삭제하시겠습니까?\n\n관련된 모든 데이터가 삭제됩니다.`)) {
          return;
        }
        
        try {
          // 지점 데이터 삭제
          await window.db.ref(locationName).remove();
          
          // 지점 목록에서 제거
          const updatedLocations = locations.filter(loc => loc !== locationName);
          await window.db.ref('locations').set(updatedLocations);
          setLocations(updatedLocations);
          
          // 사용자 권한에서 해당 지점 제거
          const usersData = {};
          users.forEach(user => {
            const updatedPerms = { ...user.permissions };
            delete updatedPerms[`${locationName}_inventory`];
            delete updatedPerms[`${locationName}_server`];
            delete updatedPerms[`${locationName}_kitchen`];
            usersData[user.id] = { ...user, permissions: updatedPerms };
            delete usersData[user.id].id;
          });
          await window.db.ref('users').set(usersData);
          
          alert('지점이 삭제되었습니다');
          loadUsers();
        } catch (error) {
          console.error('Error deleting location:', error);
          alert('지점 삭제 중 오류가 발생했습니다');
        }
      }

      // 지점명 포맷팅
      function formatLocationName(location) {
        return location.charAt(0).toUpperCase() + location.slice(1);
      }

      // 지점 아이콘
      function getLocationIcon(location) {
        const icons = {
          houston: '🌆',
          seattle: '🌲',
          default: '📍'
        };
        return icons[location] || icons.default;
      }

      async function loadData() {
        console.log('🚀 loadData 시작');
        setLoading(true);
        try {
          console.log('📡 Firebase 데이터 로드 중...');
          
          const itemsSnap = await window.db.ref(getPath('items')).once('value');
          const shopSnap = await window.db.ref(getPath('shopping')).once('value');
          const orderedSnap = await window.db.ref(getPath('orderedLists')).once('value');
          const histSnap = await window.db.ref(getPath('history')).once('value');
          const vendorsSnap = await window.db.ref(getPath('vendors')).once('value');
          const countSnap = await window.db.ref(getPath('countRecords')).once('value');
          const categoriesSnap = await window.db.ref(getPath('categories')).once('value');
          const itemCategoriesSnap = await window.db.ref(getPath('itemCategories')).once('value');
          const categoryDataSnap = await window.db.ref(getPath('categoryData')).once('value');
          
          console.log('✅ 모든 snapshot 받음');
          
          const itemsData = itemsSnap.val() || {};
          const shopData = shopSnap.val() || [];
          const orderedData = orderedSnap.val() || [];
          const histData = histSnap.val() || [];
          const vendorsData = vendorsSnap.val() || [];
          const countData = countSnap.val() || [];
          const categoriesData = categoriesSnap.val() || [];
          const itemCategoriesData = itemCategoriesSnap.val() || {};
          const categoryDataData = categoryDataSnap.val() || {};
          
          console.log('✅ 데이터 로드 완료:', {
            items: Object.keys(itemsData).length,
            vendors: vendorsData.length,
            categories: categoriesData.length
          });
          
          // 객체를 배열로 변환 및 숫자 필드 정규화
          const itemsArray = Object.keys(itemsData).map(key => {
            const item = itemsData[key];
            return {
              id: key,
              ...item,
              current_inventory: parseFloat(item.current_inventory) || 0,
              par: parseFloat(item.par) || 0,
              price: parseFloat(item.price) || 0
            };
          });
          
          console.log('✅ Items 변환 완료:', itemsArray.length);
          console.log('📦 First item:', itemsArray[0]);
          
          console.log('📊 Setting state...');
          
          // Vendors 중복 제거 및 정리
          const uniqueVendors = [...new Set(vendorsData)].filter(v => v); // 중복 제거 + 빈 값 제거
          console.log('🏪 Vendors cleaned:', vendorsData.length, '→', uniqueVendors.length);
          
          // Items의 vendor가 vendors 목록에 있는지 확인 (수정 안 함, 경고만)
          const validatedItems = itemsArray.map(item => {
            if (!uniqueVendors.includes(item.vendor)) {
              console.warn(`⚠️ Invalid vendor for ${item.name}: "${item.vendor}" - 수동으로 변경 필요`);
            }
            return item;
          });
          
          setItems(validatedItems);
          setTempItems(validatedItems);
          setShoppingList(shopData);
          setOrderedLists(orderedData);
          setPurchaseHistory(histData);
          setVendors(uniqueVendors);
          setCountRecords(countData);
          setCategories(categoriesData);
          setItemCategories(itemCategoriesData);
          console.log('📋 ItemCategories loaded:', Object.keys(itemCategoriesData).length);
          console.log('📋 Sample mappings:', Object.entries(itemCategoriesData).slice(0, 5));
          setCategoryData(categoryDataData);
          console.log('🎨 CategoryData loaded:', Object.keys(categoryDataData).length);
          
          console.log('✅ State 업데이트 완료');
          
          setLoading(false);
        } catch (error) {
          console.error('❌ Error loading data:', error);
          console.error('Error message:', error.message);
          console.error('Error stack:', error.stack);
          setLoading(false);
        }
      }

      async function updateTempInventory(index, value) {
        const updated = [...tempItems];
        updated[index].current_inventory = parseFloat(value) || 0;
        setTempItems(updated);
      }

      async function saveCountRecord() {
        const now = new Date();
        const date = now.toISOString().split('T')[0];
        const time = now.toTimeString().split(' ')[0].slice(0, 5);
        const totalValue = tempItems.reduce((sum, item) => sum + (item.current_inventory * item.price), 0);
        
        const record = {
          id: Date.now(),
          date,
          time,
          timestamp: Date.now(),
          userName: typeof currentUser === 'string' ? JSON.parse(currentUser).name : (currentUser ? currentUser.name : 'Unknown'),
          totalValue,
          totalItems: tempItems.length,
          items: tempItems.map(item => ({
            name: item.name,
            current_inventory: item.current_inventory,
            price: item.price,
            vendor: item.vendor
          }))
        };
        
        const newRecords = [record, ...countRecords];
        
        // 🔥 중요: items를 tempItems로 덮어쓰지 말고, current_inventory만 업데이트!
        const updatedItems = items.map(item => {
          const tempItem = tempItems.find(t => t.name === item.name);
          if (tempItem) {
            return {
              ...item,
              current_inventory: tempItem.current_inventory
            };
          }
          return item;
        });
        
        setItems(updatedItems);
        setCountRecords(newRecords);
        
        await window.db.ref(getPath('items')).set(updatedItems);
        await window.db.ref(getPath('countRecords')).set(newRecords);
        
        alert(language === 'ko' ? t.countRegistered : 'Count registered!');
        setTempItems([...updatedItems]);
      }

      // Employee용 간단한 저장 함수
      async function saveCount() {
        try {
          // 현재 items 상태를 Firebase에 저장
          await window.db.ref(getPath('items')).set(items);
          
          // 재고 실사 기록 저장
          const now = new Date();
          const date = now.toISOString().split('T')[0];
          const time = now.toTimeString().split(' ')[0].slice(0, 5);
          const totalValue = items.reduce((sum, item) => sum + (item.current_inventory * item.price), 0);
          
          const record = {
            id: Date.now(),
            date,
            time,
            timestamp: Date.now(),
            userName: 'Employee',
            totalValue,
            totalItems: items.length,
            items: items.map(item => ({
              name: item.name,
              current_inventory: item.current_inventory,
              price: item.price,
              vendor: item.vendor
            }))
          };
          
          const newRecords = [record, ...countRecords];
          setCountRecords(newRecords);
          await window.db.ref(getPath('countRecords')).set(newRecords);
          
          alert('✅ 저장되었습니다!');
        } catch (error) {
          console.error('Save error:', error);
          alert('❌ 저장 실패: ' + error.message);
        }
      }

      async function updateShoppingQuantity(index, value) {
        const updated = [...shoppingList];
        updated[index].shortage = parseFloat(value) || 0;
        setShoppingList(updated);
        await window.db.ref(getPath('shopping')).set(updated);
      }

      async function updateShoppingPrice(index, value) {
        const updated = [...shoppingList];
        updated[index].price = parseFloat(value) || 0;
        setShoppingList(updated);
        await window.db.ref(getPath('shopping')).set(updated);
      }

      async function updateShoppingVendor(index, vendor) {
        const updated = [...shoppingList];
        updated[index].selected_vendor = vendor;
        setShoppingList(updated);
        await window.db.ref(getPath('shopping')).set(updated);
        
        // items의 vendor도 업데이트
        const itemName = updated[index].name;
        const itemIndex = items.findIndex(item => item.name === itemName);
        
        if (itemIndex !== -1) {
          const updatedItems = [...items];
          updatedItems[itemIndex].vendor = vendor;
          setItems(updatedItems);
          await window.db.ref(getPath('items')).set(updatedItems);
          console.log(`✅ ${itemName}: vendor 업데이트 → ${vendor}`);
        }
      }

      async function generateShoppingList() {
        // Vendor 매핑 (옛날 이름 → 새 이름)
        const vendorMapping = {
          'Suns': 'Suns club',
          'suns': 'Suns club',
          'suns club': 'Suns club'
          // King과 king은 다름
          // HongKong Market과 hong Kong은 다름
        };
        
        const list = Array.isArray(items) ? items.map(item => {
          const currentInv = parseFloat(item.current_inventory) || 0;
          const parValue = parseFloat(item.par) || 0;
          
          // Vendor 매핑 적용
          let mappedVendor = item.vendor;
          
          // 1. 정확한 매핑 확인
          if (vendorMapping[item.vendor]) {
            mappedVendor = vendorMapping[item.vendor];
          } else {
            // 2. 대소문자 무시하고 매칭 (Suns만 해당)
            const lowerVendor = item.vendor.toLowerCase();
            if (lowerVendor.includes('suns')) {
              mappedVendor = 'Suns club';
            }
          }
          
          // 3. Vendor 목록에 없으면 Not Assigned
          if (!vendors.includes(mappedVendor)) {
            console.warn(`⚠️ Vendor not found: ${item.vendor} → Not Assigned`);
            mappedVendor = '⚠️ Not Assigned';
          }
          
          return {
            ...item,
            shortage: Math.max(0, parValue - currentInv),
            selected_vendor: mappedVendor,
            vendor: undefined  // ← 옛날 vendor 제거
          };
        }).map(item => {
          // 반올림: 0.5 미만은 내림, 0.5 이상은 올림
          const rawShortage = item.shortage;
          let roundedShortage = 0;
          
          if (rawShortage >= 0.5) {
            roundedShortage = Math.ceil(rawShortage);  // 0.5 이상 → 올림
          }
          // 0.5 미만은 0으로 (내림)
          
          return {
            ...item,
            shortage: roundedShortage
          };
        }).filter(item => item.shortage > 0) : [];
        setShoppingList(list);
        setShoppingStep('edit');
        await window.db.ref(getPath('shopping')).set(list);
        setActiveTab('shopping');
      }
      
      // Vendor 일괄 업데이트 함수 (콘솔에서 실행 가능하도록 window에 등록)
      window.updateAllVendors = async function() {
        console.log('🔄 Starting vendor update...');
        const updatedItems = items.map(item => {
          let newVendor = item.vendor;
          
          // Suns 관련만 통합
          const lowerVendor = item.vendor.toLowerCase();
          if (lowerVendor.includes('suns')) {
            newVendor = 'Suns club';
            console.log(`✅ ${item.name}: ${item.vendor} → ${newVendor}`);
          }
          
          return {...item, vendor: newVendor};
        });
        
        setItems(updatedItems);
        await window.db.ref(getPath('items')).set(updatedItems);
        
        const changedCount = updatedItems.filter((item, idx) => item.vendor !== items[idx].vendor).length;
        console.log(`✅ All vendors updated! ${changedCount} items changed`);
        alert(`Vendor 업데이트 완료! 총 ${changedCount}개 수정됨`);
      };
      
      // Vendors 목록 정리 (중복 제거 + Firebase 동기화)
      window.cleanVendors = async function() {
        console.log('🧹 Cleaning vendors list...');
        
        // 1. 현재 vendors 중복 제거
        const uniqueVendors = [...new Set(vendors)].filter(v => v);
        console.log(`📋 Vendors: ${vendors.length} → ${uniqueVendors.length}`);
        
        // 2. Items에서 실제 사용 중인 vendor 수집
        const usedVendors = [...new Set(items.map(i => i.vendor))];
        console.log('📦 Used vendors:', usedVendors);
        
        // 3. Vendors 목록에 없는데 사용 중인 vendor 찾기
        const missingVendors = usedVendors.filter(v => !uniqueVendors.includes(v));
        if (missingVendors.length > 0) {
          console.warn('⚠️ Missing vendors:', missingVendors);
          alert(`경고: 다음 vendor가 목록에 없습니다:\n${missingVendors.join(', ')}\n\nVendors 탭에서 추가하거나, items의 vendor를 변경하세요.`);
        }
        
        // 4. Firebase에 정리된 목록 저장
        setVendors(uniqueVendors);
        await window.db.ref(getPath('vendors')).set(uniqueVendors);
        
        console.log('✅ Vendors cleaned!');
        alert(`Vendors 정리 완료!\n중복 제거: ${vendors.length - uniqueVendors.length}개`);
      };
      
      // Shopping List 정리 (vendor 필드 제거 + 검증)
      window.cleanShoppingList = async function() {
        console.log('🧹 Cleaning shopping list...');
        console.log('📋 Before:', shoppingList.length, 'items');
        
        const cleaned = shoppingList.map(item => {
          console.log(`\n📦 ${item.name}:`);
          console.log('  vendor:', item.vendor);
          console.log('  selected_vendor:', item.selected_vendor);
          
          // vendor 필드 제거
          const { vendor, ...rest } = item;
          
          // selected_vendor가 없으면 경고
          if (!rest.selected_vendor) {
            console.warn(`  ⚠️ No selected_vendor!`);
            rest.selected_vendor = '⚠️ Not Assigned';
          }
          
          // selected_vendor가 vendors 목록에 없으면 경고
          if (!vendors.includes(rest.selected_vendor) && rest.selected_vendor !== '⚠️ Not Assigned') {
            console.warn(`  ⚠️ Invalid vendor: ${rest.selected_vendor}`);
          }
          
          console.log('  → cleaned selected_vendor:', rest.selected_vendor);
          return rest;
        });
        
        console.log('\n✅ Cleaned:', cleaned.length, 'items');
        console.log('📤 Saving to Firebase...');
        
        setShoppingList(cleaned);
        await window.db.ref(getPath('shopping')).set(cleaned);
        
        console.log('✅ Shopping list cleaned and saved!');
        alert('Shopping List 정리 완료!\nSimple View를 다시 확인해보세요.');
      };
      
      // Shopping List 강제 리셋
      window.resetShoppingList = async function() {
        if (!confirm('현재 Shopping List를 완전히 삭제하시겠습니까?')) {
          return;
        }
        
        console.log('🗑️ Resetting shopping list...');
        console.log('현재 location:', currentLocation);
        
        try {
          const path = `${currentLocation}/inventory/shopping`;
          console.log('Firebase 경로:', path);
          
          await window.db.ref(path).set([]);
          console.log('✅ Firebase 삭제 완료!');
          
          setShoppingList([]);
          console.log('✅ State 업데이트 완료!');
          
          alert('Shopping List가 삭제되었습니다.');
          window.location.reload();
        } catch (error) {
          console.error('❌ 에러:', error);
          alert('에러: ' + error.message);
        }
      };
      
      // Order 강제 삭제
      window.forceDeleteOrder = async function(orderId) {
        if (!orderId) {
          console.error('❌ Order ID가 필요합니다!');
          console.log('사용법: window.forceDeleteOrder("1768284338491")');
          return;
        }
        
        console.log('🗑️ Deleting order:', orderId);
        console.log('현재 location:', currentLocation);
        
        try {
          const path = `${currentLocation}/inventory/orderedLists`;
          console.log('Firebase 경로:', path);
          
          const snap = await window.db.ref(path).once('value');
          const current = snap.val() || [];
          console.log('현재 주문 수:', current.length);
          
          const updated = current.filter(o => o.id !== orderId && o.id !== parseInt(orderId));
          console.log('삭제 후 주문 수:', updated.length);
          
          await window.db.ref(path).set(updated);
          console.log('✅ Firebase 업데이트 완료!');
          
          setOrderedLists(updated);
          console.log('✅ State 업데이트 완료!');
          
          alert('주문이 삭제되었습니다.');
          window.location.reload();
        } catch (error) {
          console.error('❌ 에러:', error);
          alert('에러: ' + error.message);
        }
      };
      
      // 전체 orderedLists 확인
      window.listOrders = async function() {
        console.log('📋 현재 주문 목록:');
        console.log('현재 location:', currentLocation);
        
        try {
          const path = `${currentLocation}/inventory/orderedLists`;
          const snap = await window.db.ref(path).once('value');
          const orders = snap.val() || [];
          
          console.log('총 주문 수:', orders.length);
          orders.forEach((order, idx) => {
            console.log(`\n주문 ${idx + 1}:`);
            console.log('  ID:', order.id);
            console.log('  날짜:', order.date, order.time);
            console.log('  금액:', '$' + order.totalCost.toFixed(2));
            console.log('  아이템 수:', order.totalItems);
            console.log('  완료:', order.completed ? 'Yes' : 'No');
          });
          
          return orders;
        } catch (error) {
          console.error('❌ 에러:', error);
        }
      };
      
      // 디버깅: 현재 상태 확인
      window.debugState = function() {
        console.log('=== 현재 상태 ===');
        console.log('📦 Items:', items.length, 'items');
        console.log('🛒 Shopping List:', shoppingList.length, 'items');
        console.log('📋 Ordered Lists:', orderedLists.length, 'orders');
        console.log('🏪 Vendors:', vendors);
        console.log('\n상세:');
        console.log('  Items:', items);
        console.log('  Shopping List:', shoppingList);
        console.log('  Ordered Lists:', orderedLists);
        return {
          items,
          shoppingList,
          orderedLists,
          vendors
        };
      };
      
      // Firebase 직접 확인
      window.checkFirebase = async function() {
        console.log('🔥 Firebase 데이터 확인 중...');
        
        try {
          const shoppingSnap = await window.db.ref(getPath('shopping')).once('value');
          const orderedSnap = await window.db.ref(getPath('orderedLists')).once('value');
          
          const shoppingData = shoppingSnap.val() || [];
          const orderedData = orderedSnap.val() || [];
          
          console.log('📥 Firebase Shopping List:', shoppingData.length, 'items');
          console.log('📥 Firebase Ordered Lists:', orderedData.length, 'orders');
          console.log('\n상세:');
          console.log('  Shopping:', shoppingData);
          console.log('  Ordered:', orderedData);
          
          return {
            shopping: shoppingData,
            ordered: orderedData
          };
        } catch (error) {
          console.error('❌ Firebase 에러:', error);
        }
      };


      async function completeOrder() {
        // Simple View용 데이터 준비
        const purchaseItems = shoppingList.map(item => {
          const { vendor, ...itemWithoutVendor } = item;  // vendor 제거
          return {
            ...itemWithoutVendor,
            total: item.shortage * item.price
          };
        });
        
        miscItems.forEach(item => {
          purchaseItems.push({
            name: item.name + ' (Misc)',
            category: 'miscellaneous',
            selected_vendor: 'Miscellaneous',
            shortage: item.quantity,
            price: item.price,
            total: item.quantity * item.price
          });
        });
        
        // Simple View 표시
        setPurchaseData(purchaseItems);
        setShowSimpleView(true);
      }
      
      // Simple View에서 확인 버튼 눌렀을 때 실제 주문 생성
      async function confirmOrderFromSimpleView() {
        const now = new Date();
        const date = now.toISOString().split('T')[0];
        const time = now.toTimeString().split(' ')[0].slice(0, 5);
        let totalCost = 0;
        
        const orderItems = purchaseData.map(item => {
          totalCost += item.total;
          
          // items에서 imageUrl 찾기
          const originalItem = items.find(i => i.name === item.name);
          
          return {
            name: item.name,
            category: item.category,
            vendor: item.selected_vendor,
            quantity: item.shortage,
            price: item.price,
            total: item.total,
            received: false,
            imageUrl: originalItem?.imageUrl || null
          };
        });
        
        const order = {
          id: Date.now(),
          date, 
          time,
          items: orderItems,
          totalItems: orderItems.length,
          totalCost,
          completed: false
        };
        
        const newOrderedLists = [order, ...orderedLists];
        setOrderedLists(newOrderedLists);
        setShoppingList([]);
        setMiscItems([]);
        
        await window.db.ref(getPath('orderedLists')).set(newOrderedLists);
        await window.db.ref(getPath('shopping')).set([]);
        
        setShowSimpleView(false);
        setPurchaseData(null);
        setShoppingSubTab('confirm'); // Confirm 탭으로 이동
      }
      
      // 입고 확인
      async function confirmDelivery(orderId) {
        const selectedItems = selectedDeliveryItems[orderId] || [];
        if (selectedItems.length === 0) {
          alert('Please select at least one item to confirm');
          return;
        }
        
        const orderIndex = orderedLists.findIndex(o => o.id === orderId);
        if (orderIndex === -1) return;
        
        const order = { ...orderedLists[orderIndex] };
        const updatedItems = [...items];
        
        selectedItems.forEach(itemIdx => {
          const orderItem = order.items[itemIdx];
          console.log('🔍 Processing order item:', orderItem.name);
          
          if (orderItem.received) {
            console.log('⏭️ Already received, skipping');
            return; // 이미 입고된 아이템은 스킵
          }
          
          // Misc 아이템이 아닌 경우만 재고에 반영
          if (!orderItem.name.includes('(Misc)')) {
            console.log('🔍 Searching for item in inventory:', orderItem.name);
            console.log('📦 Total items in inventory:', updatedItems.length);
            console.log('📝 First 5 item names:', updatedItems.slice(0, 5).map(i => i.name));
            
            const inventoryIdx = updatedItems.findIndex(i => i.name === orderItem.name);
            console.log('📍 Found at index:', inventoryIdx);
            
            if (inventoryIdx !== -1) {
              const oldInventory = updatedItems[inventoryIdx].current_inventory;
              updatedItems[inventoryIdx].current_inventory = 
                parseFloat(updatedItems[inventoryIdx].current_inventory || 0) + parseFloat(orderItem.quantity || 0);
              updatedItems[inventoryIdx].vendor = orderItem.vendor;
              console.log('✅ Updated:', orderItem.name, 'from', oldInventory, 'to', updatedItems[inventoryIdx].current_inventory);
            } else {
              console.error('❌ ITEM NOT FOUND IN INVENTORY:', orderItem.name);
              console.error('🔍 Trying to find similar names...');
              const similar = updatedItems.filter(i => 
                i.name.toLowerCase().includes(orderItem.name.toLowerCase()) ||
                orderItem.name.toLowerCase().includes(i.name.toLowerCase())
              );
              console.error('Similar items found:', similar.map(i => i.name));
            }
          } else {
            console.log('⏭️ Misc item, skipping inventory update');
          }
          
          // 아이템 입고 완료 표시
          order.items[itemIdx].received = true;
        });
        
        // 모든 아이템이 입고되었는지 확인
        order.completed = order.items.every(item => item.received);
        
        // History에 추가 (모든 아이템이 입고된 경우에만)
        let newHistory = purchaseHistory;
        if (order.completed) {
          const purchase = {
            id: order.id,
            date: order.date,
            time: order.time,
            items: order.items,
            totalItems: order.totalItems,
            totalCost: order.totalCost
          };
          newHistory = [purchase, ...purchaseHistory];
          setPurchaseHistory(newHistory);
        }
        
        // 업데이트
        const newOrderedLists = [...orderedLists];
        newOrderedLists[orderIndex] = order;
        
        setOrderedLists(newOrderedLists);
        setItems(updatedItems);
        
        console.log('💾 About to save to Firebase...');
        console.log('📊 updatedItems type:', Array.isArray(updatedItems) ? 'Array' : 'Object');
        console.log('📊 updatedItems length:', updatedItems.length);
        console.log('📦 Sample updated item:', updatedItems.find(i => i.name === 'Memmi'));
        
        // 선택 초기화
        const newSelected = {...selectedDeliveryItems};
        delete newSelected[orderId];
        setSelectedDeliveryItems(newSelected);
        
        await window.db.ref(getPath('orderedLists')).set(newOrderedLists);
        console.log('✅ Saved orderedLists');
        
        await window.db.ref(getPath('items')).set(updatedItems);
        console.log('✅ Saved items to Firebase');
        console.log('🔍 Verify: Reading back from Firebase...');
        
        const verifySnap = await window.db.ref(getPath('items')).once('value');
        const verifyData = verifySnap.val();
        console.log('📦 Verified data type:', Array.isArray(verifyData) ? 'Array' : 'Object');
        if (Array.isArray(verifyData)) {
          const verifyMemmi = verifyData.find(i => i && i.name === 'Memmi');
          console.log('📦 Verified Memmi:', verifyMemmi);
        }
        
        if (order.completed) {
          await window.db.ref(getPath('history')).set(newHistory);
          console.log('✅ Saved history');
        }
        
        console.log('🎉 All Firebase operations completed!');
      }

      // 이미지 리사이즈 함수
      async function resizeImage(file, maxWidth = 800, maxHeight = 800) {
        return new Promise((resolve, reject) => {
          const reader = new FileReader();
          reader.onload = (e) => {
            const img = new Image();
            img.onload = () => {
              // 캔버스 생성
              const canvas = document.createElement('canvas');
              let width = img.width;
              let height = img.height;
              
              // 비율 유지하면서 리사이즈
              if (width > height) {
                if (width > maxWidth) {
                  height *= maxWidth / width;
                  width = maxWidth;
                }
              } else {
                if (height > maxHeight) {
                  width *= maxHeight / height;
                  height = maxHeight;
                }
              }
              
              canvas.width = width;
              canvas.height = height;
              
              // 이미지 그리기
              const ctx = canvas.getContext('2d');
              ctx.drawImage(img, 0, 0, width, height);
              
              // Blob으로 변환 (품질 0.8 = 80%)
              canvas.toBlob((blob) => {
                resolve(blob);
              }, 'image/jpeg', 0.8);
            };
            img.onerror = reject;
            img.src = e.target.result;
          };
          reader.onerror = reject;
          reader.readAsDataURL(file);
        });
      }

      // 사진 업로드 함수
      async function uploadItemImage(itemName, file) {
        try {
          setUploadingImage(true);
          
          // 이미지 리사이즈 (800x800, 품질 80%)
          const resizedBlob = await resizeImage(file, 800, 800);
          
          // 파일명 생성 (공백을 언더스코어로 변경)
          const fileName = `${currentLocation.replace(/\s+/g, '_')}_${itemName.replace(/\s+/g, '_')}.jpg`;
          const storageRef = firebase.storage().ref(`item-images/${fileName}`);
          
          // 리사이즈된 파일 업로드
          await storageRef.put(resizedBlob);
          
          // 다운로드 URL 가져오기
          const imageUrl = await storageRef.getDownloadURL();
          
          // items에 imageUrl 추가
          const updatedItems = items.map(item => 
            item.name === itemName ? { ...item, imageUrl } : item
          );
          
          setItems(updatedItems);
          await window.db.ref(getPath('items')).set(updatedItems);
          
          alert(language === 'ko' ? '사진이 업로드되었습니다!' : 'Image uploaded!');
          setShowImageModal(false);
          setUploadingImage(false);
        } catch (error) {
          console.error('Image upload error:', error);
          alert(language === 'ko' ? '업로드 실패: ' + error.message : 'Upload failed: ' + error.message);
          setUploadingImage(false);
        }
      }
      
      // 사진 삭제 함수
      async function deleteItemImage(itemName) {
        try {
          const item = items.find(i => i.name === itemName);
          if (!item || !item.imageUrl) return;
          
          if (!confirm(language === 'ko' ? '사진을 삭제하시겠습니까?' : 'Delete image?')) return;
          
          // Storage에서 삭제
          const fileName = `${currentLocation.replace(/\s+/g, '_')}_${itemName.replace(/\s+/g, '_')}.jpg`;
          const storageRef = firebase.storage().ref(`item-images/${fileName}`);
          await storageRef.delete();
          
          // items에서 imageUrl 제거
          const updatedItems = items.map(item => 
            item.name === itemName ? { ...item, imageUrl: undefined } : item
          );
          
          setItems(updatedItems);
          await window.db.ref(getPath('items')).set(updatedItems);
          
          alert(language === 'ko' ? '사진이 삭제되었습니다!' : 'Image deleted!');
          setShowImageModal(false);
        } catch (error) {
          console.error('Image delete error:', error);
          alert(language === 'ko' ? '삭제 실패: ' + error.message : 'Delete failed: ' + error.message);
        }
      }

      async function addNewItem() {
        if (newItem.name && newItem.vendor) {
          const updated = [...items, { ...newItem, current_inventory: 0 }];
          setItems(updated);
          await window.db.ref(getPath('items')).set(updated);
          
          if (newItem.itemCategory) {
            await updateItemCategory(newItem.name, newItem.itemCategory);
          }
          
          setNewItem({ 
            name: '', 
            name_ko: '',
            name_es: '',
            vendor: '', 
            price: 0, 
            par: 0, 
            category: 'refrigerated', 
            itemCategory: '' 
          });
        }
      }

      async function deleteItem(index) {
        const updated = Array.isArray(items) ? items.filter((_, i) => i !== index) : [];
        setItems(updated);
        await window.db.ref(getPath('items')).set(updated);
      }

      async function saveEditItem() {
        if (editingItem !== null) {
          await window.db.ref(getPath('items')).set(items);
          setEditingItem(null);
        }
      }

      async function addVendor() {
        if (newVendor.trim() && !vendors.includes(newVendor.trim())) {
          const updated = [...vendors, newVendor.trim()].sort();
          setVendors(updated);
          await window.db.ref(getPath('vendors')).set(updated);
          setNewVendor('');
        }
      }

      async function deleteVendor(vendor) {
        // 이 vendor를 사용하는 아이템 찾기
        const affectedItems = items.filter(item => item.vendor === vendor);
        
        if (affectedItems.length > 0) {
          // 아이템이 있으면 재배치 모달 표시
          const initialReassignments = {};
          affectedItems.forEach(item => {
            // 다른 vendor 중 첫 번째를 기본값으로
            const otherVendors = vendors.filter(v => v !== vendor);
            initialReassignments[item.name] = otherVendors[0] || '';
          });
          setVendorReassignments(initialReassignments);
          setVendorToDelete(vendor);
        } else {
          // 아이템이 없으면 바로 삭제
          if (confirm(`"${vendor}" 벤더를 삭제하시겠습니까?`)) {
            const updated = vendors.filter(v => v !== vendor);
            setVendors(updated);
            await window.db.ref(getPath('vendors')).set(updated);
          }
        }
      }
      
      async function confirmVendorDeletion() {
        // 1. 아이템들의 vendor 재배치
        const updatedItems = items.map(item => {
          if (item.vendor === vendorToDelete) {
            const newVendor = vendorReassignments[item.name];
            console.log(`📦 ${item.name}: ${vendorToDelete} → ${newVendor}`);
            return {...item, vendor: newVendor};
          }
          return item;
        });
        
        setItems(updatedItems);
        await window.db.ref(getPath('items')).set(updatedItems);
        
        // 2. Vendor 삭제
        const updated = vendors.filter(v => v !== vendorToDelete);
        setVendors(updated);
        await window.db.ref(getPath('vendors')).set(updated);
        
        // 3. 모달 닫기
        setVendorToDelete(null);
        setVendorReassignments({});
        
        alert(`"${vendorToDelete}" 삭제 완료!`);
      }

      async function addCategory() {
        if (newCategory.name_en.trim() && !categories.includes(newCategory.name_en.trim())) {
          const categoryId = newCategory.name_en.trim();
          const updated = [...categories, categoryId].sort();
          const updatedData = {
            ...categoryData,
            [categoryId]: {
              name_en: newCategory.name_en.trim(),
              name_ko: newCategory.name_ko.trim(),
              name_es: newCategory.name_es.trim(),
              icon: newCategory.icon
            }
          };
          
          setCategories(updated);
          setCategoryData(updatedData);
          await window.db.ref(getPath('categories')).set(updated);
          await window.db.ref(getPath('categoryData')).set(updatedData);
          setNewCategory({ name_en: '', name_ko: '', name_es: '', icon: '📦' });
        }
      }

      async function deleteCategory(category) {
        const updated = categories.filter(c => c !== category);
        const updatedData = { ...categoryData };
        delete updatedData[category];
        
        setCategories(updated);
        setCategoryData(updatedData);
        await window.db.ref(getPath('categories')).set(updated);
        await window.db.ref(getPath('categoryData')).set(updatedData);
      }

      async function updateItemCategory(itemName, category) {
        const updated = { ...itemCategories, [itemName]: category };
        setItemCategories(updated);
        await window.db.ref(getPath('itemCategories')).set(updated);
      }

      function handleResetData() {
        if (resetPassword === '0214') {
          const resetItems = Array.isArray(items) ? items.map(item => {
            const initial = initialItems.find(i => i.name === item.name);
            return { ...item, current_inventory: initial ? initial.current_inventory : item.current_inventory };
          }) : [];
          setItems(resetItems);
          setShoppingList([]);
          setPurchaseHistory([]);
          window.db.ref(getPath('items')).set(resetItems);
          window.db.ref(getPath('shopping')).set([]);
          window.db.ref(getPath('history')).set([]);
          setShowResetModal(false);
          setResetPassword('');
          alert(t.dataReset);
        } else {
          alert(t.wrongPassword);
          setResetPassword('');
        }
      }

      function canExportExcel() {
        return countRecords.length >= 2 && purchaseHistory.length >= 1;
      }

      function getExcelRequirements() {
        const missing = [];
        if (countRecords.length < 2) {
          if (countRecords.length === 0) missing.push(language === 'ko' ? '어제 재고실사를 완료하세요' : 'Complete yesterday\'s count');
          missing.push(language === 'ko' ? '오늘 재고실사를 완료하세요' : 'Complete today\'s count');
        }
        if (purchaseHistory.length < 1) {
          missing.push(language === 'ko' ? '구매를 완료하세요' : 'Complete purchase');
        }
        return missing;
      }

      function exportToExcel() {
        if (!canExportExcel()) {
          alert(language === 'ko' ? '엑셀 다운로드에 필요한 데이터가 부족합니다!' : 'Insufficient data for export!');
          return;
        }

        const now = new Date();
        const month = now.getMonth() + 1;
        const day = now.getDate();
        const year = now.getFullYear();
        const dateStr = `${month}.${day}.${year}`;
        
        // 오늘 재고실사 (가장 최근)
        const todayCount = countRecords[0];
        // 어제 재고실사
        const yesterdayCount = countRecords[1];
        // 어제 구매
        const yesterdayPurchase = purchaseHistory[0];
        
        // 어제 재고 데이터 매핑
        const yesterdayInventory = {};
        if (yesterdayCount && yesterdayCount.items) {
          yesterdayCount.items.forEach(item => {
            yesterdayInventory[item.name] = item.current_inventory;
          });
        }
        
        // 어제 주문 데이터 매핑
        const yesterdayOrder = {};
        if (yesterdayPurchase && yesterdayPurchase.items) {
          yesterdayPurchase.items.forEach(item => {
            yesterdayOrder[item.name] = item.quantity;
          });
        }
        
        // 오늘 시작 재고 (어제 실사 + 어제 주문)
        const currentInv = {};
        items.forEach(item => {
          const yesterday = yesterdayInventory[item.name] || 0;
          const ordered = yesterdayOrder[item.name] || 0;
          currentInv[item.name] = yesterday + ordered;
        });
        
        // 오늘 저녁 재고 (현재 실사)
        const endOfDay = {};
        items.forEach(item => {
          endOfDay[item.name] = item.current_inventory;
        });
        
        const excelData = Array.isArray(items) ? items.map(item => {
          const inventory = yesterdayInventory[item.name] || 0;
          const order = yesterdayOrder[item.name] || 0;
          const current = currentInv[item.name] || 0;
          const endDay = endOfDay[item.name] || 0;
          const dailyUsage = current - endDay;
          const dailyUsageDollar = dailyUsage * item.price;
          const totalInstockPrice = current * item.price;
          
          return {
            'Name': item.name,
            'Vendor': item.vendor,
            'Unit Price / Case': item.price,
            'Total Instock Price': totalInstockPrice,
            'Inventory': inventory,
            'Order': order,
            'Current Inv': current,
            'End Of day': endDay,
            'Daily Usage #': dailyUsage,
            'Daily Usage $': dailyUsageDollar
          };
        }) : [];
        
        const wb = XLSX.utils.book_new();
        
        // 제목 추가
        const ws_data = [[`${dateStr} Daily Inventory`], [], []];
        
        // 헤더 추가
        ws_data.push(['Name', 'Vendor', 'Unit Price / Case', 'Total Instock Price', 'Inventory', 'Order', 'Current Inv', 'End Of day', 'Daily Usage #', 'Daily Usage $']);
        
        // 데이터 추가
        excelData.forEach(row => {
          ws_data.push([
            row.Name,
            row.Vendor,
            row['Unit Price / Case'],
            row['Total Instock Price'],
            row.Inventory,
            row.Order,
            row['Current Inv'],
            row['End Of day'],
            row['Daily Usage #'],
            row['Daily Usage $']
          ]);
        });
        
        const ws = XLSX.utils.aoa_to_sheet(ws_data);
        
        // 컬럼 너비 설정
        ws['!cols'] = [
          { wch: 30 }, // Name
          { wch: 15 }, // Vendor
          { wch: 18 }, // Unit Price
          { wch: 20 }, // Total Instock
          { wch: 12 }, // Inventory
          { wch: 10 }, // Order
          { wch: 12 }, // Current Inv
          { wch: 12 }, // End Of day
          { wch: 15 }, // Daily Usage #
          { wch: 15 }  // Daily Usage $
        ];
        
        XLSX.utils.book_append_sheet(wb, ws, 'Daily Inventory');
        XLSX.writeFile(wb, `${dateStr} Daily Inventory.xlsx`);
      }

      function downloadCountRecordExcel(record) {
        const wb = XLSX.utils.book_new();
        const dateStr = record.date.replace(/-/g, '.');
        
        // 재고실사 데이터
        const countData = [
          [`${dateStr} 재고실사 기록`],
          [],
          ['아이템명', '카테고리', '벤더', '가격', '재고수량', '재고가치']
        ];
        
        record.items.forEach(item => {
          countData.push([
            item.name,
            item.category,
            item.vendor || '',
            item.price,
            item.current_inventory,
            (item.price * item.current_inventory).toFixed(2)
          ]);
        });
        
        countData.push([]);
        countData.push(['총 아이템', record.totalItems]);
        countData.push(['총 재고가치', '$' + record.totalValue.toFixed(2)]);
        
        // 쇼핑 리스트 (부족 재고)
        const shoppingData = [
          [],
          [],
          ['구매 필요 아이템'],
          [],
          ['아이템명', '현재 재고', 'PAR', '부족 수량', '가격', '구매 금액']
        ];
        
        record.items.filter(item => item.par > item.current_inventory).forEach(item => {
          const shortage = item.par - item.current_inventory;
          shoppingData.push([
            item.name,
            item.current_inventory,
            item.par,
            shortage,
            item.price,
            (shortage * item.price).toFixed(2)
          ]);
        });
        
        const allData = [...countData, ...shoppingData];
        const ws = XLSX.utils.aoa_to_sheet(allData);
        
        ws['!cols'] = [
          { wch: 30 },
          { wch: 15 },
          { wch: 15 },
          { wch: 12 },
          { wch: 12 },
          { wch: 15 }
        ];
        
        XLSX.utils.book_append_sheet(wb, ws, '재고실사');
        XLSX.writeFile(wb, `${dateStr} 재고실사.xlsx`);
      }

      function downloadMonthlyUsageExcel() {
        const now = new Date();
        const year = now.getFullYear();
        const month = now.getMonth(); // 0-11
        const monthNames = ['1월', '2월', '3월', '4월', '5월', '6월', '7월', '8월', '9월', '10월', '11월', '12월'];
        
        // 이번 달 시작/끝
        const startDate = new Date(year, month, 1);
        const endDate = new Date(year, month + 1, 0);
        
        // 이번 달 구매 내역 필터
        const monthlyPurchases = purchaseHistory.filter(p => {
          const pDate = new Date(p.date);
          return pDate >= startDate && pDate <= endDate;
        });
        
        // 아이템별 사용량 집계
        const itemUsage = {};
        monthlyPurchases.forEach(purchase => {
          purchase.items.forEach(item => {
            if (!itemUsage[item.name]) {
              itemUsage[item.name] = {
                name: item.name,
                category: item.category,
                vendor: item.vendor,
                totalQuantity: 0,
                totalCost: 0,
                avgPrice: item.price
              };
            }
            itemUsage[item.name].totalQuantity += item.quantity;
            itemUsage[item.name].totalCost += item.total || (item.quantity * item.price);
          });
        });
        
        const wb = XLSX.utils.book_new();
        
        // 월간 사용량 데이터
        const usageData = [
          [`${year}년 ${monthNames[month]} 사용량 리포트`],
          [`기간: ${startDate.toISOString().split('T')[0]} ~ ${endDate.toISOString().split('T')[0]}`],
          [],
          ['아이템명', '카테고리', '벤더', '총 사용량', '평균 가격', '총 비용']
        ];
        
        Object.values(itemUsage).sort((a, b) => b.totalCost - a.totalCost).forEach(item => {
          usageData.push([
            item.name,
            item.category,
            item.vendor,
            item.totalQuantity,
            '$' + item.avgPrice.toFixed(2),
            '$' + item.totalCost.toFixed(2)
          ]);
        });
        
        const totalCost = Object.values(itemUsage).reduce((sum, item) => sum + item.totalCost, 0);
        usageData.push([]);
        usageData.push(['총 비용', '', '', '', '', '$' + totalCost.toFixed(2)]);
        
        const ws = XLSX.utils.aoa_to_sheet(usageData);
        ws['!cols'] = [
          { wch: 30 },
          { wch: 15 },
          { wch: 15 },
          { wch: 12 },
          { wch: 12 },
          { wch: 15 }
        ];
        
        XLSX.utils.book_append_sheet(wb, ws, '월간 사용량');
        XLSX.writeFile(wb, `${year}년 ${monthNames[month]} 사용량.xlsx`);
      }

      function getItemUsageData(itemName) {
        // 날짜별 사용량 계산
        const usageMap = {};
        
        // countRecords를 날짜별로 그룹화 (같은 날짜는 마지막 것만)
        const countsByDate = {};
        countRecords.forEach(count => {
          countsByDate[count.date] = count;  // 같은 날짜면 덮어씀 (마지막 것만 유지)
        });
        
        // 날짜순으로 정렬
        const sortedDates = Object.keys(countsByDate).sort();
        
        // 각 날짜별 계산
        for (let i = 1; i < sortedDates.length; i++) {
          const todayDate = sortedDates[i];
          const yesterdayDate = sortedDates[i - 1];
          
          const today = countsByDate[todayDate];
          const yesterday = countsByDate[yesterdayDate];
          
          // 오늘 재고실사에서 해당 아이템 찾기
          const todayItem = today.items.find(item => item.name === itemName);
          const yesterdayItem = yesterday.items.find(item => item.name === itemName);
          
          if (!todayItem || !yesterdayItem) continue;
          
          const todayInventory = parseFloat(todayItem.current_inventory) || 0;
          const yesterdayInventory = parseFloat(yesterdayItem.current_inventory) || 0;
          
          // 오늘 컨펌한 구매량 찾기 (orderedLists에서)
          let todayConfirmed = 0;
          orderedLists.forEach(order => {
            const orderDate = order.date;
            // 오늘 날짜와 주문 컨펌 날짜 비교
            if (orderDate === todayDate) {
              const orderItem = order.items.find(item => item.name === itemName && item.received);
              if (orderItem) {
                todayConfirmed += parseFloat(orderItem.quantity) || 0;
              }
            }
          });
          
          // 사용량 = 어제 재고 + 오늘 컨펌 - 오늘 재고
          const usage = yesterdayInventory + todayConfirmed - todayInventory;
          
          // 음수 방지 (재고가 늘어난 경우 = 컨펌 누락 가능성)
          if (usage >= 0) {
            usageMap[todayDate] = usage;
          }
        }
        
        const sortedUsageDates = Object.keys(usageMap).sort();
        const last7Days = sortedUsageDates.slice(-7);
        
        return {
          lastUsed: sortedUsageDates.length > 0 ? usageMap[sortedUsageDates[sortedUsageDates.length - 1]] : 0,
          weeklyAvg: last7Days.length > 0 ? (last7Days.reduce((sum, d) => sum + (usageMap[d] || 0), 0) / last7Days.length) : 0,
          chartData: {
            labels: last7Days,
            values: last7Days.map(d => usageMap[d] || 0)
          }
        };
      }

      function generateSimpleText() {
        const dataToUse = purchaseData || shoppingList;
        const grouped = {};
        dataToUse.forEach(item => {
          if (!grouped[item.selected_vendor]) grouped[item.selected_vendor] = [];
          grouped[item.selected_vendor].push(item);
        });
        let text = '';
        Object.entries(grouped).forEach(([vendor, items]) => {
          text += vendor + '\n';
          if (Array.isArray(items)) items.forEach(item => text += item.name + ' ' + item.shortage + '\n');
          text += '\n';
        });
        return text.trim();
      }

      function copyToClipboard() {
        navigator.clipboard.writeText(generateSimpleText()).then(() => {
          setCopySuccess(true);
          setTimeout(() => setCopySuccess(false), 2000);
        });
      }

      const lowStockItems = Array.isArray(items) ? items.filter(item => {
        const currentInv = parseFloat(item.current_inventory) || 0;
        const parValue = parseFloat(item.par) || 0;
        return currentInv < parValue;
      }) : [];
      const totalValue = Array.isArray(items) ? items.reduce((sum, item) => sum + (item.current_inventory * item.price), 0) : 0;
      const filteredItems = !Array.isArray(items) ? [] : (categoryFilter === 'all' ? items : items.filter(i => i.category === categoryFilter));
      const shoppingByVendor = {};
      shoppingList.forEach(item => {
        if (!shoppingByVendor[item.selected_vendor]) shoppingByVendor[item.selected_vendor] = [];
        shoppingByVendor[item.selected_vendor].push(item);
      });


      
      // 로그인 화면
      if (screen === 'login') {
        console.log('📱 Login screen');
        return h('div', { className: 'login-screen' }, [
          h('img', { 
            key: 'logo', 
            src: LOGO_DATA,
            alt: 'Shabu Zone',
            style: {
              width: '200px',
              height: '200px',
              objectFit: 'contain',
              marginBottom: '2rem'
            }
          }),
          h('h1', { key: 'title', className: 'login-title' }, 'Shabu Zone'),
          h('p', { key: 'subtitle', className: 'login-subtitle' }, 'Management System'),
          h('form', { 
            key: 'form', 
            onSubmit: handleLogin,
            style: {
              display: 'flex',
              flexDirection: 'column',
              alignItems: 'center',
              width: '100%'
            }
          }, [
            h('input', {
              key: 'input',
              type: 'tel',
              pattern: '[0-9]*',
              inputMode: 'numeric',
              className: 'login-input',
              placeholder: '••••',
              value: password,
              maxLength: 4,
              onChange: (e) => setPassword(e.target.value),
              autoFocus: true,
              style: {
                WebkitTextSecurity: 'disc',
                textAlign: 'center',
                letterSpacing: '0.5rem',
                fontSize: '2rem'
              }
            }),
            h('button', {
              key: 'submit',
              type: 'submit',
              className: 'login-button',
              style: {
                width: '100%',
                maxWidth: '300px',
                padding: '1rem',
                marginTop: '1rem',
                background: 'linear-gradient(135deg, #7f1d1d 0%, #991b1b 100%)',
                color: 'white',
                border: 'none',
                borderRadius: '12px',
                fontSize: '1.1rem',
                fontWeight: '700',
                cursor: 'pointer',
                transition: 'transform 0.2s, box-shadow 0.2s',
                boxShadow: '0 4px 6px rgba(127, 29, 29, 0.3)'
              },
              onMouseDown: (e) => {
                e.target.style.transform = 'scale(0.98)';
              },
              onMouseUp: (e) => {
                e.target.style.transform = 'scale(1)';
              },
              onMouseLeave: (e) => {
                e.target.style.transform = 'scale(1)';
              }
            }, '→ Login'),
            loginError && h('div', { key: 'error', className: 'login-error' }, loginError)
          ])
        ]);
      }
      
      // 관리자 전용 - 사용자 관리 화면
      if (screen === 'admin-user-management') {
        return h('div', { className: 'screen-container' }, [
          h('div', { key: 'header', className: 'screen-header' }, [
            h('img', { 
              key: 'logo',
              src: LOGO_DATA,
              alt: 'Shabu Zone',
              style: {
                width: '80px',
                height: '80px',
                objectFit: 'contain',
                marginBottom: '1rem'
              }
            }),
            h('h1', { key: 'title', className: 'screen-title' }, '사용자 관리'),
            h('p', { key: 'subtitle', className: 'screen-subtitle' }, 'User Management (Admin Only)')
          ]),
          
          h('div', { key: 'buttons', style: { maxWidth: '600px', margin: '0 auto 2rem', display: 'grid', gap: '1rem' }}, [
            h('button', {
              key: 'register',
              className: 'btn',
              onClick: () => setShowRegisterModal(true),
              style: { padding: '1.5rem' }
            }, '➕ 새 사용자 등록'),
            h('button', {
              key: 'manage',
              className: 'btn',
              onClick: () => setShowUserManagement(true),
              style: { padding: '1.5rem' }
            }, '👥 사용자 목록 관리')
          ]),
          
          h('button', {
            key: 'back',
            className: 'btn btn-secondary',
            onClick: () => setScreen('location'),
            style: { maxWidth: '300px', margin: '0 auto', width: '100%' }
          }, '← 뒤로가기'),
          
          // 등록 모달
          showRegisterModal && h('div', { 
            key: 'register-modal',
            className: 'modal',
            onClick: () => setShowRegisterModal(false)
          }, 
            h('div', { 
              className: 'modal-content',
              onClick: (e) => e.stopPropagation()
            }, [
              h('h2', { key: 'title', className: 'modal-title' }, '사용자 등록'),
              
              h('div', { key: 'name-group', className: 'form-group' }, [
                h('label', { key: 'label', className: 'form-label' }, '이름'),
                h('input', {
                  key: 'input',
                  type: 'text',
                  className: 'form-input',
                  placeholder: '사용자 이름',
                  value: registerData.name,
                  onChange: (e) => setRegisterData({ ...registerData, name: e.target.value })
                })
              ]),
              
              h('div', { key: 'password-group', className: 'form-group' }, [
                h('label', { key: 'label', className: 'form-label' }, '비밀번호'),
                h('input', {
                  key: 'input',
                  type: 'text',
                  className: 'form-input',
                  placeholder: '비밀번호',
                  value: registerData.password,
                  onChange: (e) => setRegisterData({ ...registerData, password: e.target.value })
                })
              ]),
              
              h('div', { key: 'admin-group', className: 'form-group' }, [
                h('div', { 
                  key: 'admin-checkbox', 
                  className: 'checkbox-item',
                  style: { 
                    background: 'rgba(127, 29, 29, 0.05)', 
                    border: '2px solid rgba(127, 29, 29, 0.2)',
                    padding: '1rem'
                  }
                }, [
                  h('input', {
                    key: 'checkbox',
                    type: 'checkbox',
                    id: 'isAdmin',
                    checked: registerData.isAdmin,
                    onChange: (e) => setRegisterData({ ...registerData, isAdmin: e.target.checked })
                  }),
                  h('label', { 
                    key: 'label',
                    htmlFor: 'isAdmin',
                    style: { fontWeight: '700', color: '#7f1d1d' }
                  }, '🔑 관리자 권한 (모든 지점/기능 접근 가능)')
                ])
              ]),
              
              // 선호 언어 선택
              h('div', { key: 'language-group', className: 'form-group' }, [
                h('label', { key: 'label', className: 'form-label' }, '🌍 선호 언어 (Preferred Language)'),
                h('select', {
                  key: 'select',
                  className: 'form-input',
                  value: registerData.preferredLanguage || 'ko',
                  onChange: (e) => setRegisterData({ ...registerData, preferredLanguage: e.target.value })
                }, [
                  h('option', { key: 'ko', value: 'ko' }, '🇰🇷 한국어 (Korean)'),
                  h('option', { key: 'en', value: 'en' }, '🇺🇸 English'),
                  h('option', { key: 'es', value: 'es' }, '🇪🇸 Español (Spanish)')
                ])
              ]),
              
              !registerData.isAdmin && h('div', { key: 'permissions-group', className: 'form-group' }, [
                h('label', { key: 'label', className: 'form-label' }, '접근 권한 (일반 사용자)'),
                h('div', { key: 'checkboxes', className: 'checkbox-group' },
                  locations.flatMap(location => [
                    h('div', { 
                      key: `${location}-header`, 
                      style: { 
                        fontWeight: '700', 
                        padding: '0.5rem 0.75rem',
                        background: 'rgba(127, 29, 29, 0.05)',
                        marginTop: '0.5rem',
                        borderRadius: '6px'
                      }
                    }, getLocationIcon(location) + ' ' + formatLocationName(location)),
                    h('div', { key: `${location}_inventory_employee`, className: 'checkbox-item' }, [
                      h('input', {
                        key: 'checkbox',
                        type: 'checkbox',
                        id: `${location}_inventory_employee`,
                        checked: registerData.permissions[`${location}_inventory_employee`] || false,
                        onChange: (e) => updatePermission(`${location}_inventory_employee`, e.target.checked)
                      }),
                      h('label', { 
                        key: 'label',
                        htmlFor: `${location}_inventory_employee`
                      }, '👷 Employee Inventory (직원 재고)')
                    ]),
                    h('div', { key: `${location}_inventory_manager`, className: 'checkbox-item' }, [
                      h('input', {
                        key: 'checkbox',
                        type: 'checkbox',
                        id: `${location}_inventory_manager`,
                        checked: registerData.permissions[`${location}_inventory_manager`] || false,
                        onChange: (e) => updatePermission(`${location}_inventory_manager`, e.target.checked)
                      }),
                      h('label', { 
                        key: 'label',
                        htmlFor: `${location}_inventory_manager`
                      }, '👔 Manager Inventory (매니저 재고)')
                    ]),
                    h('div', { key: `${location}_server`, className: 'checkbox-item' }, [
                      h('input', {
                        key: 'checkbox',
                        type: 'checkbox',
                        id: `${location}_server`,
                        checked: registerData.permissions[`${location}_server`] || false,
                        onChange: (e) => updatePermission(`${location}_server`, e.target.checked)
                      }),
                      h('label', { 
                        key: 'label',
                        htmlFor: `${location}_server`
                      }, '👔 Server Management (서버 관리)')
                    ]),
                    h('div', { key: `${location}_kitchen`, className: 'checkbox-item' }, [
                      h('input', {
                        key: 'checkbox',
                        type: 'checkbox',
                        id: `${location}_kitchen`,
                        checked: registerData.permissions[`${location}_kitchen`] || false,
                        onChange: (e) => updatePermission(`${location}_kitchen`, e.target.checked)
                      }),
                      h('label', { 
                        key: 'label',
                        htmlFor: `${location}_kitchen`
                      }, '👨‍🍳 Kitchen Management (주방 관리)')
                    ])
                  ])
                )
              ]),
              
              h('div', { key: 'buttons', style: { display: 'flex', gap: '0.75rem', marginTop: '1.5rem' }}, [
                h('button', {
                  key: 'cancel',
                  className: 'btn btn-secondary',
                  onClick: () => setShowRegisterModal(false)
                }, '취소'),
                h('button', {
                  key: 'submit',
                  className: 'btn',
                  onClick: handleRegister
                }, '등록')
              ])
            ])
          ),
          
          // 사용자 관리 모달
          showUserManagement && h('div', { 
            key: 'user-management-modal',
            className: 'modal',
            onClick: () => setShowUserManagement(false)
          }, 
            h('div', { 
              className: 'modal-content',
              onClick: (e) => e.stopPropagation()
            }, [
              h('h2', { key: 'title', className: 'modal-title' }, '사용자 관리'),
              
              h('div', { key: 'user-list', className: 'user-list' },
                users.length === 0 
                  ? h('p', { style: { textAlign: 'center', color: '#64748b', padding: '2rem' } }, '등록된 사용자가 없습니다')
                  : users.map(user =>
                      h('div', { 
                        key: 'item-' + user.id, 
                        style: {
                          display: 'flex',
                          flexDirection: 'column',
                          gap: '0.75rem',
                          padding: '1.5rem',
                          background: 'white',
                          border: '1px solid #e2e8f0',
                          borderRadius: '8px',
                          marginBottom: '0.75rem'
                        }
                      }, [
                        h('div', { 
                          key: 'row1',
                          style: {
                            display: 'flex',
                            justifyContent: 'space-between',
                            alignItems: 'flex-start',
                            gap: '1rem'
                          }
                        }, [
                          // 왼쪽: 이름 + 권한
                          h('div', { 
                            key: 'info', 
                            style: {
                              flex: 1,
                              minWidth: 0,
                              textAlign: 'left'
                            }
                          }, [
                            h('div', { 
                              key: 'name', 
                              style: {
                                fontSize: '1.3rem',
                                fontWeight: '700',
                                color: '#2c3e50',
                                marginBottom: '0.5rem'
                              }
                            }, user.name),
                            h('div', { 
                              key: 'perms', 
                              style: {
                                fontSize: '0.95rem',
                                color: '#64748b',
                                lineHeight: '1.5'
                              }
                            }, getUserPermissions(user))
                          ]),
                          // 오른쪽: 버튼
                          h('div', { 
                            key: 'buttons', 
                            style: { 
                              display: 'flex', 
                              gap: '0.5rem',
                              flexShrink: 0,
                              alignItems: 'flex-start'
                            }
                          }, [
                            h('button', {
                              key: 'edit',
                              style: {
                                padding: '0.75rem 1.25rem',
                                fontSize: '1rem',
                                fontWeight: '700',
                                background: editingUser === user.id ? '#64748b' : '#3b82f6',
                                color: 'white',
                                border: 'none',
                                borderRadius: '8px',
                                cursor: 'pointer',
                                whiteSpace: 'nowrap'
                              },
                              onClick: () => setEditingUser(editingUser === user.id ? null : user.id)
                            }, editingUser === user.id ? '닫기' : '편집'),
                            h('button', {
                              key: 'delete',
                              style: {
                                padding: '0.75rem 1.25rem',
                                fontSize: '1rem',
                                fontWeight: '700',
                                background: '#ef4444',
                                color: 'white',
                                border: 'none',
                                borderRadius: '8px',
                                cursor: 'pointer',
                                whiteSpace: 'nowrap'
                              },
                              onClick: () => handleDeleteUser(user.id)
                            }, '삭제')
                          ])
                        ]),
                        
                        // 편집 모드
                        editingUser === user.id && h('div', {
                          key: 'edit-form',
                          style: {
                            padding: '1rem',
                            background: '#f8fafc',
                            borderRadius: '8px',
                            border: '2px solid #3b82f6'
                          }
                        }, [
                          // 선호 언어
                          h('div', { key: 'language-group', style: { marginBottom: '1.5rem' }}, [
                            h('label', { 
                              key: 'label',
                              style: { 
                                display: 'block',
                                fontWeight: '600',
                                marginBottom: '0.5rem',
                                color: '#2c3e50'
                              }
                            }, '🌍 선호 언어'),
                            h('select', {
                              key: 'select',
                              value: user.preferredLanguage || 'ko',
                              onChange: async (e) => {
                                const newLang = e.target.value;
                                const updatedUsers = users.map(u => 
                                  u.id === user.id 
                                    ? { ...u, preferredLanguage: newLang }
                                    : u
                                );
                                setUsers(updatedUsers);
                                await window.db.ref('users').set(updatedUsers);
                                alert('✅ 언어가 변경되었습니다!');
                              },
                              style: {
                                width: '100%',
                                padding: '0.75rem',
                                border: '2px solid #e2e8f0',
                                borderRadius: '8px',
                                fontSize: '1rem',
                                background: 'white'
                              }
                            }, [
                              h('option', { key: 'ko', value: 'ko' }, '🇰🇷 한국어 (Korean)'),
                              h('option', { key: 'en', value: 'en' }, '🇺🇸 English'),
                              h('option', { key: 'es', value: 'es' }, '🇪🇸 Español (Spanish)')
                            ])
                          ]),
                          
                          // 권한 관리
                          h('div', { key: 'permissions-group' }, [
                            h('label', { 
                              key: 'label',
                              style: { 
                                display: 'block',
                                fontWeight: '600',
                                marginBottom: '0.5rem',
                                color: '#2c3e50'
                              }
                            }, '🔑 접근 권한'),
                            
                            // 각 지점별 권한
                            ...locations.flatMap(location => [
                              h('div', { 
                                key: `${location}-header`, 
                                style: { 
                                  fontWeight: '700', 
                                  padding: '0.5rem 0.75rem',
                                  background: 'rgba(127, 29, 29, 0.05)',
                                  marginTop: '0.75rem',
                                  marginBottom: '0.5rem',
                                  borderRadius: '6px',
                                  fontSize: '0.9rem'
                                }
                              }, getLocationIcon(location) + ' ' + formatLocationName(location)),
                              
                              // Employee Inventory
                              h('div', { 
                                key: `${location}_inventory_employee`, 
                                style: { 
                                  display: 'flex',
                                  alignItems: 'center',
                                  gap: '0.5rem',
                                  padding: '0.5rem',
                                  marginBottom: '0.25rem'
                                }
                              }, [
                                h('input', {
                                  key: 'checkbox',
                                  type: 'checkbox',
                                  id: `edit_${user.id}_${location}_inventory_employee`,
                                  checked: (user.permissions || {})[`${location}_inventory_employee`] || false,
                                  onChange: async (e) => {
                                    const updatedUsers = users.map(u => 
                                      u.id === user.id 
                                        ? { 
                                            ...u, 
                                            permissions: {
                                              ...(u.permissions || {}),
                                              [`${location}_inventory_employee`]: e.target.checked
                                            }
                                          }
                                        : u
                                    );
                                    setUsers(updatedUsers);
                                    await window.db.ref('users').set(updatedUsers);
                                  },
                                  style: { cursor: 'pointer' }
                                }),
                                h('label', { 
                                  key: 'label',
                                  htmlFor: `edit_${user.id}_${location}_inventory_employee`,
                                  style: { cursor: 'pointer', fontSize: '0.9rem' }
                                }, '👷 Employee Inventory')
                              ]),
                              
                              // Manager Inventory
                              h('div', { 
                                key: `${location}_inventory_manager`, 
                                style: { 
                                  display: 'flex',
                                  alignItems: 'center',
                                  gap: '0.5rem',
                                  padding: '0.5rem',
                                  marginBottom: '0.25rem'
                                }
                              }, [
                                h('input', {
                                  key: 'checkbox',
                                  type: 'checkbox',
                                  id: `edit_${user.id}_${location}_inventory_manager`,
                                  checked: (user.permissions || {})[`${location}_inventory_manager`] || false,
                                  onChange: async (e) => {
                                    const updatedUsers = users.map(u => 
                                      u.id === user.id 
                                        ? { 
                                            ...u, 
                                            permissions: {
                                              ...(u.permissions || {}),
                                              [`${location}_inventory_manager`]: e.target.checked
                                            }
                                          }
                                        : u
                                    );
                                    setUsers(updatedUsers);
                                    await window.db.ref('users').set(updatedUsers);
                                  },
                                  style: { cursor: 'pointer' }
                                }),
                                h('label', { 
                                  key: 'label',
                                  htmlFor: `edit_${user.id}_${location}_inventory_manager`,
                                  style: { cursor: 'pointer', fontSize: '0.9rem' }
                                }, '👔 Manager Inventory')
                              ]),
                              
                              // Server Management
                              h('div', { 
                                key: `${location}_server`, 
                                style: { 
                                  display: 'flex',
                                  alignItems: 'center',
                                  gap: '0.5rem',
                                  padding: '0.5rem',
                                  marginBottom: '0.25rem'
                                }
                              }, [
                                h('input', {
                                  key: 'checkbox',
                                  type: 'checkbox',
                                  id: `edit_${user.id}_${location}_server`,
                                  checked: (user.permissions || {})[`${location}_server`] || false,
                                  onChange: async (e) => {
                                    const updatedUsers = users.map(u => 
                                      u.id === user.id 
                                        ? { 
                                            ...u, 
                                            permissions: {
                                              ...(u.permissions || {}),
                                              [`${location}_server`]: e.target.checked
                                            }
                                          }
                                        : u
                                    );
                                    setUsers(updatedUsers);
                                    await window.db.ref('users').set(updatedUsers);
                                  },
                                  style: { cursor: 'pointer' }
                                }),
                                h('label', { 
                                  key: 'label',
                                  htmlFor: `edit_${user.id}_${location}_server`,
                                  style: { cursor: 'pointer', fontSize: '0.9rem' }
                                }, '🍽️ Server Management')
                              ]),
                              
                              // Kitchen Management
                              h('div', { 
                                key: `${location}_kitchen`, 
                                style: { 
                                  display: 'flex',
                                  alignItems: 'center',
                                  gap: '0.5rem',
                                  padding: '0.5rem',
                                  marginBottom: '0.25rem'
                                }
                              }, [
                                h('input', {
                                  key: 'checkbox',
                                  type: 'checkbox',
                                  id: `edit_${user.id}_${location}_kitchen`,
                                  checked: (user.permissions || {})[`${location}_kitchen`] || false,
                                  onChange: async (e) => {
                                    const updatedUsers = users.map(u => 
                                      u.id === user.id 
                                        ? { 
                                            ...u, 
                                            permissions: {
                                              ...(u.permissions || {}),
                                              [`${location}_kitchen`]: e.target.checked
                                            }
                                          }
                                        : u
                                    );
                                    setUsers(updatedUsers);
                                    await window.db.ref('users').set(updatedUsers);
                                  },
                                  style: { cursor: 'pointer' }
                                }),
                                h('label', { 
                                  key: 'label',
                                  htmlFor: `edit_${user.id}_${location}_kitchen`,
                                  style: { cursor: 'pointer', fontSize: '0.9rem' }
                                }, '👨‍🍳 Kitchen Management')
                              ])
                            ])
                          ])
                        ])
                      ])
                    )
              ),
              
              h('button', {
                key: 'close',
                className: 'btn btn-secondary',
                style: { marginTop: '1.5rem', width: '100%' },
                onClick: () => setShowUserManagement(false)
              }, '닫기')
            ])
          )
        ]);
      }

      // 사용자 페이지 선택 화면
      if (screen === 'user-page-select' && currentUser && !isAdmin) {
        console.log('📱 User page select screen');
        console.log('👤 CurrentUser:', currentUser);
        const user = typeof currentUser === 'string' ? JSON.parse(currentUser) : currentUser;
        console.log('👤 Parsed user:', user);
        const perms = user.permissions || {};
        console.log('🔑 Permissions:', perms);
        const availablePages = [];
        
        // 동적으로 사용 가능한 페이지 생성
        locations.forEach(location => {
          const locationName = formatLocationName(location);
          
          if (perms[`${location}_inventory_employee`]) {
            availablePages.push({ 
              location, 
              module: 'inventory',
              role: 'employee',
              icon: '👷',
              name: `${locationName} - Employee Inventory`,
              desc: `${locationName} 직원 재고 관리`
            });
          }
          if (perms[`${location}_inventory_manager`]) {
            availablePages.push({ 
              location, 
              module: 'inventory',
              role: 'manager',
              icon: '👔',
              name: `${locationName} - Manager Inventory`,
              desc: `${locationName} 매니저 재고 관리`
            });
          }
          if (perms[`${location}_server`]) {
            availablePages.push({ 
              location, 
              module: 'management', 
              type: 'server',
              icon: '🍽️',
              name: `${locationName} - Server Management`,
              desc: `${locationName} 서버 업무 관리`
            });
          }
          if (perms[`${location}_kitchen`]) {
            availablePages.push({ 
              location, 
              module: 'management', 
              type: 'kitchen',
              icon: '👨‍🍳',
              name: `${locationName} - Kitchen Management`,
              desc: `${locationName} 주방 업무 관리`
            });
          }
        });
        
        console.log('📋 Available pages:', availablePages.length, availablePages);
        
        return h('div', { className: 'screen-container' }, [
          h('div', { key: 'header', className: 'screen-header' }, [
            h('img', { 
              key: 'logo',
              src: LOGO_DATA,
              alt: 'Shabu Zone',
              style: {
                width: '80px',
                height: '80px',
                objectFit: 'contain',
                marginBottom: '1rem'
              }
            }),
            h('h1', { key: 'title', className: 'screen-title' }, 
              (language === 'ko' ? '환영합니다, ' : language === 'es' ? 'Bienvenido, ' : 'Welcome, ') + 
              (typeof currentUser === 'string' ? JSON.parse(currentUser).name : currentUser.name)
            ),
            h('p', { key: 'subtitle', className: 'screen-subtitle' }, 
              language === 'ko' ? '페이지를 선택하세요' : 
              language === 'es' ? 'Seleccione una página' : 
              'Select a page'
            )
          ]),
          h('div', { key: 'grid', className: 'selection-grid' }, 
            availablePages.map((page, idx) => 
              h('div', { 
                key: idx, 
                className: 'selection-card', 
                onClick: () => selectUserPage(page) 
              }, [
                h('div', { key: 'icon', className: 'selection-icon' }, page.icon),
                h('div', { key: 'name', className: 'selection-name' }, page.name),
                h('div', { key: 'desc', className: 'selection-desc' }, page.desc)
              ])
            )
          ),
          h('button', {
            key: 'logout',
            className: 'btn btn-secondary',
            onClick: () => {
              setCurrentUser(null);
              setIsAdmin(false);
              setScreen('login');
              localStorage.removeItem('currentUser');
              localStorage.removeItem('currentLocation');
              localStorage.removeItem('inventoryRole');
              localStorage.removeItem('currentScreen');
            },
            style: { maxWidth: '300px', margin: '2rem auto 0', width: '100%' }
          }, language === 'ko' ? '로그아웃' : language === 'es' ? 'Cerrar Sesión' : 'Logout')
        ]);
      }
      // 지점 선택 화면
      if (screen === 'location') {
        console.log('📱 Location screen');
        return h('div', { className: 'screen-container' }, [
          h('div', { key: 'header', className: 'screen-header' }, [
            h('img', { 
              key: 'logo',
              src: LOGO_DATA,
              alt: 'Shabu Zone',
              style: {
                width: '80px',
                height: '80px',
                objectFit: 'contain',
                marginBottom: '1rem'
              }
            }),
            h('h1', { key: 'title', className: 'screen-title' }, 'Select Location'),
            h('p', { key: 'subtitle', className: 'screen-subtitle' }, '지점을 선택하세요')
          ]),
          h('div', { key: 'grid', className: 'selection-grid' }, [
            // 동적 지점 표시
            ...locations.map(location => 
              h('div', { 
                key: location, 
                className: 'selection-card', 
                style: { position: 'relative' },
                onClick: () => selectLocation(location) 
              }, [
                h('div', { key: 'icon', className: 'selection-icon' }, getLocationIcon(location)),
                h('div', { key: 'name', className: 'selection-name' }, formatLocationName(location)),
                h('div', { key: 'desc', className: 'selection-desc' }, formatLocationName(location) + ' Location'),
                // 기본 지점이 아니면 삭제 버튼 표시
                (location !== 'houston' && location !== 'seattle') && h('button', {
                  key: 'delete',
                  onClick: (e) => {
                    e.stopPropagation();
                    deleteLocation(location);
                  },
                  style: {
                    position: 'absolute',
                    top: '10px',
                    right: '10px',
                    background: 'rgba(239, 68, 68, 0.1)',
                    border: '1px solid rgba(239, 68, 68, 0.3)',
                    borderRadius: '6px',
                    color: '#ef4444',
                    padding: '0.5rem',
                    cursor: 'pointer',
                    fontSize: '1rem'
                  }
                }, '🗑️')
              ])
            ),
            // 지점 추가 버튼
            h('div', { 
              key: 'add-location', 
              className: 'selection-card', 
              onClick: () => setShowAddLocation(true),
              style: { border: '2px dashed #e2e8f0' }
            }, [
              h('div', { key: 'icon', className: 'selection-icon' }, '➕'),
              h('div', { key: 'name', className: 'selection-name' }, '지점 추가'),
              h('div', { key: 'desc', className: 'selection-desc' }, 'Add New Location')
            ]),
            // 사용자 관리
            h('div', { key: 'user-management', className: 'selection-card', onClick: () => setScreen('admin-user-management'), style: { gridColumn: '1 / -1' }}, [
              h('div', { key: 'icon', className: 'selection-icon' }, '⚙️'),
              h('div', { key: 'name', className: 'selection-name' }, '사용자 관리'),
              h('div', { key: 'desc', className: 'selection-desc' }, 'User Management (Admin Only)')
            ])
          ]),
          
          // 지점 추가 모달
          showAddLocation && h('div', { 
            key: 'add-location-modal',
            className: 'modal',
            onClick: () => setShowAddLocation(false)
          }, 
            h('div', { 
              className: 'modal-content',
              onClick: (e) => e.stopPropagation()
            }, [
              h('h2', { key: 'title', className: 'modal-title' }, '새 지점 추가'),
              h('div', { key: 'form', className: 'form-group' }, [
                h('label', { key: 'label', className: 'form-label' }, '지점 이름 (영문 소문자)'),
                h('input', {
                  key: 'input',
                  type: 'text',
                  className: 'form-input',
                  placeholder: 'ex) dallas, austin, miami',
                  value: newLocationName,
                  onChange: (e) => setNewLocationName(e.target.value.toLowerCase()),
                  onKeyPress: (e) => e.key === 'Enter' && addLocation()
                })
              ]),
              h('div', { key: 'buttons', style: { display: 'flex', gap: '0.75rem', marginTop: '1.5rem' }}, [
                h('button', {
                  key: 'cancel',
                  className: 'btn btn-secondary',
                  onClick: () => {
                    setShowAddLocation(false);
                    setNewLocationName('');
                  }
                }, '취소'),
                h('button', {
                  key: 'add',
                  className: 'btn',
                  onClick: addLocation
                }, '추가')
              ])
            ])
          )
        ]);
      }
      
      // 메뉴 선택 화면
      if (screen === 'menu') {
        return h('div', { className: 'screen-container', style: { position: 'relative' } }, [
          h('button', { 
            key: 'back',
            className: 'back-btn',
            onClick: goBack,
            style: {
              position: 'absolute',
              left: '1.5rem',
              top: '1.5rem',
              zIndex: 10
            }
          }, '←'),
          h('div', { key: 'header', className: 'screen-header' }, [
            h('img', { 
              key: 'logo',
              src: LOGO_DATA,
              alt: 'Shabu Zone',
              style: {
                width: '80px',
                height: '80px',
                objectFit: 'contain',
                marginBottom: '1rem'
              }
            }),
            h('h1', { key: 'title', className: 'screen-title' }, currentLocation === 'houston' ? 'Houston' : 'Seattle')
          ]),
          h('div', { key: 'grid', className: 'selection-grid' }, [
            h('div', { key: 'inventory', className: 'selection-card', onClick: () => selectModule('inventory') }, [
              h('div', { key: 'icon', className: 'selection-icon' }, '📦'),
              h('div', { key: 'name', className: 'selection-name' }, 'Inventory'),
              h('div', { key: 'desc', className: 'selection-desc' }, '재고 관리 시스템')
            ]),
            h('div', { key: 'management', className: 'selection-card', onClick: () => selectModule('management') }, [
              h('div', { key: 'icon', className: 'selection-icon' }, '📅'),
              h('div', { key: 'name', className: 'selection-name' }, 'Management'),
              h('div', { key: 'desc', className: 'selection-desc' }, '스케줄 관리 시스템')
            ])
          ])
        ]);
      }

      // Management 타입 선택 화면
      if (screen === 'management-select') {
        return h('div', { className: 'screen-container', style: { position: 'relative' } }, [
          h('button', { 
            key: 'back',
            className: 'back-btn',
            onClick: goBack,
            style: {
              position: 'absolute',
              left: '1.5rem',
              top: '1.5rem',
              zIndex: 10
            }
          }, '←'),
          h('div', { key: 'header', className: 'screen-header' }, [
            h('img', { 
              key: 'logo',
              src: LOGO_DATA,
              alt: 'Shabu Zone',
              style: {
                width: '80px',
                height: '80px',
                objectFit: 'contain',
                marginBottom: '1rem'
              }
            }),
            h('h1', { key: 'title', className: 'screen-title' }, 'Management')
          ]),
          h('div', { key: 'grid', className: 'selection-grid' }, [
            h('div', { key: 'server', className: 'selection-card', onClick: () => selectManagementType('server') }, [
              h('div', { key: 'icon', className: 'selection-icon' }, '👔'),
              h('div', { key: 'name', className: 'selection-name' }, 'Server'),
              h('div', { key: 'desc', className: 'selection-desc' }, '서버 스케줄 관리')
            ]),
            h('div', { key: 'kitchen', className: 'selection-card', onClick: () => selectManagementType('kitchen') }, [
              h('div', { key: 'icon', className: 'selection-icon' }, '👨‍🍳'),
              h('div', { key: 'name', className: 'selection-name' }, 'Kitchen'),
              h('div', { key: 'desc', className: 'selection-desc' }, '키친 스케줄 관리')
            ])
          ])
        ]);
      }

      // Inventory Role 선택 화면
      if (screen === 'inventory-role') {
        return h('div', { className: 'screen-container', style: { position: 'relative' } }, [
          h('button', { 
            key: 'back',
            className: 'back-btn',
            onClick: goBack,
            style: {
              position: 'absolute',
              left: '1.5rem',
              top: '1.5rem',
              zIndex: 10
            }
          }, '←'),
          h('div', { key: 'header', className: 'screen-header' }, [
            h('img', { 
              key: 'logo',
              src: LOGO_DATA,
              alt: 'Shabu Zone',
              style: {
                width: '80px',
                height: '80px',
                objectFit: 'contain',
                marginBottom: '1rem'
              }
            }),
            h('h1', { key: 'title', className: 'screen-title' }, 'Inventory'),
            h('p', { key: 'subtitle', className: 'screen-subtitle', style: { fontSize: '0.9rem', color: '#64748b' }}, '역할을 선택하세요')
          ]),
          h('div', { key: 'grid', className: 'selection-grid', style: { gap: '1.5rem' }}, [
            // Manager Inventory
            h('div', { 
              key: 'manager', 
              className: 'selection-card', 
              onClick: () => selectInventoryRole('manager'),
              style: {
                background: 'linear-gradient(135deg, rgba(127,29,29,0.1), rgba(153,27,27,0.05))',
                border: '2px solid rgba(127,29,29,0.3)',
                cursor: 'pointer',
                transition: 'all 0.3s ease'
              }
            }, [
              h('div', { key: 'icon', className: 'selection-icon', style: { fontSize: '3.5rem', marginBottom: '1rem' }}, '👔'),
              h('div', { key: 'name', className: 'selection-name', style: { fontSize: '1.3rem', fontWeight: '700', marginBottom: '0.5rem', color: '#7f1d1d' }}, 'Manager'),
              h('div', { key: 'desc', className: 'selection-desc', style: { fontSize: '0.95rem', color: '#64748b', lineHeight: '1.4' }}, '전체 기능 접근\n사진 관리 가능')
            ]),
            
            // Employee Inventory - 심플!
            h('div', { 
              key: 'employee', 
              className: 'selection-card', 
              onClick: () => selectInventoryRole('employee'),
              style: {
                background: 'linear-gradient(135deg, rgba(59,130,246,0.1), rgba(37,99,235,0.05))',
                border: '2px solid rgba(59,130,246,0.3)',
                cursor: 'pointer',
                transition: 'all 0.3s ease'
              }
            }, [
              h('div', { key: 'icon', className: 'selection-icon', style: { fontSize: '3.5rem', marginBottom: '1rem' }}, '👷'),
              h('div', { key: 'name', className: 'selection-name', style: { fontSize: '1.3rem', fontWeight: '700', marginBottom: '0.5rem', color: '#3b82f6' }}, 'Employee'),
              h('div', { key: 'desc', className: 'selection-desc', style: { fontSize: '0.95rem', color: '#64748b', lineHeight: '1.4' }}, '재고 세기 & 쇼핑\n간편 모드')
            ])
          ])
        ]);
      }

      // Management 화면
      if (screen === 'management') {
        console.log('📱 Management screen');
        return h('div', { 
          key: 'management-wrapper',
          style: { 
            width: '100%', 
            height: '100vh',
            display: 'flex',
            flexDirection: 'column',
            background: '#f5f5f0',
            overflow: 'hidden'
          }
        }, [
          // 헤더
          h('div', { 
            key: 'header',
            style: { 
              padding: '1rem',
              background: 'white',
              borderBottom: '2px solid #e2e8f0',
              display: 'flex',
              alignItems: 'center',
              gap: '0.75rem',
              height: '60px',
              flexShrink: 0
            }
          }, [
            h('button', { 
              key: 'back',
              onClick: goBack,
              style: {
                background: 'white',
                border: '2px solid #e2e8f0',
                borderRadius: '8px',
                width: '40px',
                height: '40px',
                fontSize: '18px',
                cursor: 'pointer',
                color: '#7f1d1d',
                display: 'flex',
                alignItems: 'center',
                justifyContent: 'center',
                flexShrink: 0
              }
            }, '←'),
            h('h1', { 
              key: 'title',
              style: { 
                margin: 0,
                fontSize: '1.1rem',
                fontWeight: '700',
                color: '#7f1d1d',
                flex: 1,
                whiteSpace: 'nowrap',
                overflow: 'hidden',
                textOverflow: 'ellipsis'
              }
            }, language === 'ko' ? 
              (managementType === 'kitchen' ? '키친 관리' : '서버 관리') : 
              (managementType === 'kitchen' ? 'Kitchen' : 'Server')
            ),
            currentUser && h('div', { 
              key: 'user-info', 
              style: { 
                display: 'flex', 
                alignItems: 'center', 
                gap: '0.5rem',
                fontSize: '0.875rem',
                color: '#2c3e50',
                flexShrink: 0
              }
            }, [
              h('span', { key: 'name', style: { fontWeight: '600' }}, typeof currentUser === 'string' ? JSON.parse(currentUser).name : currentUser.name),
              h('span', { key: 'separator', style: { color: '#cbd5e1' }}, '|'),
              h('button', { 
                key: 'logout',
                onClick: handleLogout,
                style: {
                  background: 'transparent',
                  border: 'none',
                  color: '#ef4444',
                  cursor: 'pointer',
                  fontSize: '0.875rem',
                  fontWeight: '600',
                  padding: '0',
                  whiteSpace: 'nowrap'
                }
              }, language === 'ko' ? '로그아웃' : language === 'es' ? 'Salir' : 'Logout')
            ]),
            h('select', { 
              key: 'lang',
              value: language,
              onChange: (e) => setLanguage(e.target.value),
              style: { 
                background: 'white', 
                border: '2px solid #e2e8f0', 
                borderRadius: '6px', 
                padding: '0.25rem 0.5rem', 
                color: '#2c3e50', 
                fontSize: '0.75rem',
                flexShrink: 0,
                cursor: 'pointer'
              }
            }, [
              h('option', { key: 'ko', value: 'ko' }, 'KR'),
              h('option', { key: 'en', value: 'en' }, 'EN'),
              h('option', { key: 'es', value: 'es' }, 'ES')
            ])
          ]),
          
          // 스케줄러 iframe
          h('iframe', {
            key: 'scheduler',
            src: (managementType === 'kitchen' ? 'scheduler-kitchen.html' : 'scheduler.html') + '?location=' + currentLocation + '&lang=' + language,
            style: {
              width: '100%',
              height: 'calc(100vh - 60px)',
              border: 'none',
              background: 'white',
              display: 'block'
            },
            allow: 'clipboard-write'
          })
        ]);
      }

      // ===== 디버그 로그 =====
      console.log('🔍 RENDER:', {
        screen,
        loading,
        currentUser: currentUser ? (typeof currentUser === 'string' ? 'string' : 'object') : 'null',
        currentLocation,
        inventoryRole,
        isAdmin
      });
      // =======================

      if (loading) {
        console.log('⏳ Loading screen');
        return h('div', { style: { display: 'flex', alignItems: 'center', justifyContent: 'center', minHeight: '100vh', fontSize: '1.5rem', color: '#7f1d1d' }}, 'Loading...');
      }

      return h('div', null, [
        h('div', { key: 'header', className: 'header' }, [
          h('div', { 
            key: 'left', 
            style: { display: 'flex', alignItems: 'center', gap: '0.75rem' }
          }, [
            h('button', { key: 'back', className: 'back-btn', onClick: goBack }, '←'),
            h('img', { 
              key: 'logo-img', 
              src: LOGO_DATA,
              alt: 'Shabu Zone',
              onClick: () => setActiveTab('dashboard'),
              style: { 
                width: '36px', 
                height: '36px', 
                borderRadius: '8px',
                cursor: 'pointer'
              }
            }),
            h('div', { key: 'text', style: { display: 'flex', flexDirection: 'column', lineHeight: '1.2' }}, [
              h('div', { key: 'name', style: { fontSize: '1rem', fontWeight: '700', color: '#7f1d1d' }}, currentLocation === 'houston' ? 'Houston' : 'Seattle'),
              h('div', { key: 'sub', style: { fontSize: '0.75rem', color: '#64748b', marginTop: '-2px' }}, 'Inventory')
            ])
          ]),
          h('div', { key: 'right', style: { display: 'flex', alignItems: 'center', gap: '0.5rem' }}, [
            currentUser && h('div', { 
              key: 'user-info', 
              style: { 
                display: 'flex', 
                alignItems: 'center', 
                gap: '0.5rem',
                fontSize: '0.875rem',
                color: '#2c3e50'
              }
            }, [
              h('span', { key: 'name', style: { fontWeight: '600' }}, typeof currentUser === 'string' ? JSON.parse(currentUser).name : currentUser.name),
              h('span', { key: 'separator', style: { color: '#cbd5e1' }}, '|'),
              h('button', { 
                key: 'logout',
                onClick: handleLogout,
                style: {
                  background: 'transparent',
                  border: 'none',
                  color: '#ef4444',
                  cursor: 'pointer',
                  fontSize: '0.875rem',
                  fontWeight: '600',
                  padding: '0',
                  whiteSpace: 'nowrap'
                }
              }, language === 'ko' ? '로그아웃' : language === 'es' ? 'Salir' : 'Logout')
            ]),
            h('select', { 
              key: 'lang',
              value: language,
              onChange: (e) => setLanguage(e.target.value),
              style: { 
                background: 'white', 
                border: '2px solid #e2e8f0', 
                borderRadius: '6px', 
                padding: '0.25rem 0.5rem', 
                color: '#2c3e50', 
                fontSize: '0.75rem',
                cursor: 'pointer'
              }
            }, [
              h('option', { key: 'ko', value: 'ko' }, 'KR'),
              h('option', { key: 'en', value: 'en' }, 'EN'),
              h('option', { key: 'es', value: 'es' }, 'ES')
            ])
          ])
        ]),

        h('div', { key: 'nav', className: 'nav' },
          h('div', { className: 'nav-inner' }, [
            // Employee는 count, shopping만 / Manager는 전체
            (inventoryRole === 'employee' 
              ? ['count', 'shopping'] 
              : ['dashboard', 'count', 'shopping', 'reports', 'add']
            ).map(tab => {
              // Employee용 다국어 이름
              let tabLabel = t[tab];
              if (inventoryRole === 'employee') {
                if (tab === 'count') {
                  tabLabel = language === 'ko' ? '📦 재고 세기' : 
                             language === 'es' ? '📦 Contar Inventario' : 
                             '📦 Count Inventory';
                }
                if (tab === 'shopping') {
                  tabLabel = language === 'ko' ? '🛒 쇼핑하기' : 
                             language === 'es' ? '🛒 Ir de Compras' : 
                             '🛒 Shopping';
                }
              }
              
              return h('button', {
                key: tab,
                className: 'nav-btn' + (activeTab === tab ? ' active' : ''),
                onClick: () => setActiveTab(tab)
              }, tabLabel);
            })
          ])
        ),

        h('div', { key: 'content', className: 'content' }, [
          activeTab === 'dashboard' && h('div', { key: 'dash' }, [
            h('div', { key: 'grid', className: 'grid' }, [
              h('div', { key: '1', className: 'stat-card' }, [
                h('div', { key: 'l', className: 'stat-label' }, t.totalItems),
                h('div', { key: 'v', className: 'stat-value' }, items.length)
              ]),
              h('div', { key: '2', className: 'stat-card', style: { background: 'linear-gradient(135deg, rgba(248,113,113,0.1), rgba(239,68,68,0.1))', border: '1px solid rgba(248,113,113,0.2)' }}, [
                h('div', { key: 'l', className: 'stat-label' }, t.lowStock),
                h('div', { key: 'v', className: 'stat-value', style: { color: '#f87171' }}, lowStockItems.length)
              ]),
              h('div', { key: '3', className: 'stat-card', style: { background: 'linear-gradient(135deg, rgba(74,222,128,0.1), rgba(34,197,94,0.1))', border: '1px solid rgba(74,222,128,0.2)' }}, [
                h('div', { key: 'l', className: 'stat-label' }, t.totalValue),
                h('div', { key: 'v', className: 'stat-value', style: { color: '#4ade80' }}, '$' + totalValue.toFixed(0))
              ])
            ]),
            
            // 주간 가격 업데이트 알람 (매주 수요일)
            (new Date().getDay() === 3) && h('div', { key: 'price-alert', className: 'card', style: { background: 'linear-gradient(135deg, rgba(127,29,29,0.1), rgba(153,27,27,0.1))', border: '2px solid #7f1d1d', marginBottom: '1rem' }}, [
              h('div', { key: 'icon', style: { fontSize: '2rem', marginBottom: '0.5rem' }}, '💰'),
              h('h3', { key: 'title', style: { marginBottom: '0.5rem', color: '#7f1d1d', fontWeight: '700' }}, '가격 업데이트 알림'),
              h('p', { key: 'desc', style: { color: '#64748b', fontSize: '0.875rem', marginBottom: '1rem' }}, '매주 수요일은 가격 업데이트 날입니다. 벤더 가격을 확인하고 업데이트해주세요.'),
              h('button', { key: 'btn', className: 'btn', onClick: () => setActiveTab('add'), style: { background: 'linear-gradient(135deg, #7f1d1d, #991b1b)' }}, '품목 관리로 이동')
            ]),
            
            lowStockItems.length > 0 && h('div', { key: 'alert', className: 'card', style: { background: 'rgba(248,113,113,0.05)', border: '1px solid rgba(248,113,113,0.2)' }}, [
              h('h3', { key: 'title', style: { marginBottom: '1rem', color: '#f87171' }}, t.lowStockAlert),
              h('div', { key: 'list', style: { display: 'grid', gap: '0.75rem' }},
                lowStockItems.slice(0, 10).map((item, i) =>
                  h('div', { key: i, style: { display: 'flex', justifyContent: 'space-between', alignItems: 'center', padding: '0.75rem', background: 'rgba(255,255,255,0.03)', borderRadius: '8px' }}, [
                    h('div', { key: 'left', style: { display: 'flex', alignItems: 'center', gap: '0.5rem' }}, [
                      h('span', { key: 'icon' }, storageIcons[item.category]),
                      h('span', { key: 'name' }, item.name)
                    ]),
                    h('span', { key: 'qty', style: { color: '#64748b' }}, item.current_inventory + ' / ' + item.par)
                  ])
                )
              )
            ]),
            
            // 재고실사 달력
            h('div', { key: 'calendar', className: 'card', style: { marginTop: '1.5rem' }}, [
              h('div', { key: 'header', style: { display: 'flex', alignItems: 'center', justifyContent: 'space-between', marginBottom: '1rem' }}, [
                h('h3', { key: 'title', style: { color: '#7f1d1d', display: 'flex', alignItems: 'center', gap: '0.5rem', margin: 0 }}, 
                  t.calendarTitle
                ),
                h('div', { key: 'nav', style: { display: 'flex', alignItems: 'center', gap: '0.5rem' }}, [
                  h('button', {
                    key: 'prev',
                    onClick: () => {
                      const newMonth = new Date(calendarMonth);
                      newMonth.setMonth(newMonth.getMonth() - 1);
                      setCalendarMonth(newMonth);
                    },
                    style: {
                      background: 'white',
                      border: '2px solid #e2e8f0',
                      borderRadius: '6px',
                      padding: '0.25rem 0.5rem',
                      cursor: 'pointer',
                      color: '#7f1d1d',
                      fontWeight: '600'
                    }
                  }, '←'),
                  h('div', { 
                    key: 'month',
                    style: { 
                      fontSize: '0.875rem', 
                      fontWeight: '600', 
                      color: '#2c3e50',
                      minWidth: '120px',
                      textAlign: 'center'
                    }
                  }, calendarMonth.getFullYear() + '년 ' + t.monthNames[calendarMonth.getMonth()]),
                  h('button', {
                    key: 'next',
                    onClick: () => {
                      const newMonth = new Date(calendarMonth);
                      newMonth.setMonth(newMonth.getMonth() + 1);
                      setCalendarMonth(newMonth);
                    },
                    style: {
                      background: 'white',
                      border: '2px solid #e2e8f0',
                      borderRadius: '6px',
                      padding: '0.25rem 0.5rem',
                      cursor: 'pointer',
                      color: '#7f1d1d',
                      fontWeight: '600'
                    }
                  }, '→')
                ])
              ]),
              h('div', { key: 'dates', style: { display: 'grid', gridTemplateColumns: 'repeat(7, 1fr)', gap: '0.5rem' }},
                (() => {
                  const dates = [];
                  const countDates = new Set(countRecords.map(r => r.date));
                  const today = new Date();
                  const year = calendarMonth.getFullYear();
                  const month = calendarMonth.getMonth();
                  
                  // 해당 월의 1일
                  const firstDay = new Date(year, month, 1);
                  // 해당 월의 마지막 날
                  const lastDay = new Date(year, month + 1, 0);
                  // 1일이 무슨 요일인지 (0=일요일)
                  const startDay = firstDay.getDay();
                  
                  // 빈 칸 추가 (이전 달)
                  for (let i = 0; i < startDay; i++) {
                    dates.push(
                      h('div', { key: 'empty-' + i, style: { padding: '0.5rem' }})
                    );
                  }
                  
                  // 날짜 추가
                  for (let day = 1; day <= lastDay.getDate(); day++) {
                    const date = new Date(year, month, day);
                    const dateStr = date.toISOString().split('T')[0];
                    const hasCount = countDates.has(dateStr);
                    const isToday = dateStr === today.toISOString().split('T')[0];
                    
                    dates.push(
                      h('div', { 
                        key: dateStr,
                        onClick: hasCount ? () => {
                          const recordsForDate = countRecords.filter(r => r.date === dateStr);
                          setSelectedDateRecords({ date: dateStr, records: recordsForDate });
                        } : undefined,
                        style: { 
                          padding: '0.5rem',
                          borderRadius: '8px',
                          textAlign: 'center',
                          background: hasCount ? 'linear-gradient(135deg, #4ade80, #22c55e)' : (isToday ? '#f8fafc' : 'white'),
                          border: isToday ? '2px solid #7f1d1d' : '1px solid #e2e8f0',
                          fontSize: '0.75rem',
                          cursor: hasCount ? 'pointer' : 'default',
                          transition: 'transform 0.2s',
                          ':hover': hasCount ? { transform: 'scale(1.05)' } : {}
                        }
                      }, [
                        h('div', { key: 'date', style: { fontWeight: '600', color: hasCount ? 'white' : '#2c3e50' }}, day),
                        h('div', { key: 'day', style: { fontSize: '0.625rem', color: hasCount ? 'rgba(255,255,255,0.8)' : '#64748b' }}, 
                          t.dayNames[date.getDay()])
                      ])
                    );
                  }
                  return dates;
                })()
              ),
              h('div', { key: 'legend', style: { display: 'flex', gap: '1rem', marginTop: '1rem', fontSize: '0.75rem', justifyContent: 'center' }}, [
                h('div', { key: 'done', style: { display: 'flex', alignItems: 'center', gap: '0.25rem' }}, [
                  h('div', { key: 'box', style: { width: '16px', height: '16px', borderRadius: '4px', background: 'linear-gradient(135deg, #4ade80, #22c55e)' }}),
                  h('span', { key: 'text', style: { color: '#64748b' }}, t.countCompleted)
                ]),
                h('div', { key: 'today', style: { display: 'flex', alignItems: 'center', gap: '0.25rem' }}, [
                  h('div', { key: 'box', style: { width: '16px', height: '16px', borderRadius: '4px', border: '2px solid #7f1d1d', background: '#f8fafc' }}),
                  h('span', { key: 'text', style: { color: '#64748b' }}, t.today)
                ])
              ])
            ]),
            
            h('button', { key: 'gen', className: 'btn', onClick: generateShoppingList, style: { marginTop: '2rem' }}, t.generateShopping)
          ]),

          activeTab === 'count' && h('div', { key: 'count' }, [
            // Employee용 심플 모드
            inventoryRole === 'employee' ? h('div', { key: 'employee-count' }, [
              // 검색 칸
              h('div', { key: 'search', style: { marginBottom: '1rem' }}, 
                h('input', {
                  type: 'text',
                  placeholder: language === 'ko' ? '🔍 아이템 검색...' : 
                               language === 'es' ? '🔍 Buscar artículo...' : 
                               '🔍 Search item...',
                  value: countSearchTerm,
                  onChange: (e) => setCountSearchTerm(e.target.value),
                  style: {
                    width: '100%',
                    padding: '1rem',
                    borderRadius: '12px',
                    border: '2px solid #e2e8f0',
                    fontSize: '1.1rem',
                    outline: 'none'
                  }
                })
              ),
              
              // 필터 모드 선택
              h('div', { key: 'filter-mode', style: { display: 'flex', gap: '0.5rem', marginBottom: '1rem' }}, [
                h('button', { 
                  key: 'storage',
                  onClick: () => { setFilterMode('storage'); setCategoryFilter('all'); },
                  style: { 
                    flex: 1,
                    padding: '0.75rem',
                    background: filterMode === 'storage' ? '#3b82f6' : '#f8fafc',
                    border: filterMode === 'storage' ? '2px solid #3b82f6' : '2px solid #e2e8f0',
                    borderRadius: '12px',
                    color: filterMode === 'storage' ? 'white' : '#64748b',
                    cursor: 'pointer',
                    fontWeight: '700',
                    fontSize: '1rem'
                  }
                }, language === 'ko' ? '보관별' : language === 'es' ? 'Por Almacenamiento' : 'By Storage'),
                h('button', { 
                  key: 'category',
                  onClick: () => { setFilterMode('category'); setCategoryFilter('all'); },
                  style: { 
                    flex: 1,
                    padding: '0.75rem',
                    background: filterMode === 'category' ? '#3b82f6' : '#f8fafc',
                    border: filterMode === 'category' ? '2px solid #3b82f6' : '2px solid #e2e8f0',
                    borderRadius: '12px',
                    color: filterMode === 'category' ? 'white' : '#64748b',
                    cursor: 'pointer',
                    fontWeight: '700',
                    fontSize: '1rem'
                  }
                }, language === 'ko' ? '분류별' : language === 'es' ? 'Por Categoría' : 'By Category')
              ]),
              
              // 필터 버튼들
              h('div', { key: 'filter', style: { display: 'flex', gap: '0.5rem', marginBottom: '1.5rem', overflowX: 'auto' }},
                (filterMode === 'storage' 
                  ? ['all', 'frozen', 'refrigerated', 'dry']
                  : ['all', ...categories, 'Uncategorized']
                ).map(cat =>
                  h('button', {
                    key: cat,
                    onClick: () => setCategoryFilter(cat),
                    style: {
                      padding: '0.75rem 1.25rem',
                      background: categoryFilter === cat ? '#3b82f6' : 'white',
                      border: categoryFilter === cat ? '2px solid #3b82f6' : '2px solid #e2e8f0',
                      borderRadius: '12px',
                      color: categoryFilter === cat ? 'white' : '#64748b',
                      cursor: 'pointer',
                      fontSize: '1rem',
                      fontWeight: '600',
                      whiteSpace: 'nowrap',
                      display: 'flex',
                      alignItems: 'center',
                      gap: '0.5rem'
                    }
                  }, filterMode === 'storage' 
                    ? [
                        h('span', { key: 'icon' }, cat === 'all' ? '📦' : storageIcons[cat]),
                        h('span', { key: 'text' }, 
                          cat === 'all' ? (language === 'ko' ? '전체' : language === 'es' ? 'Todo' : 'All') : 
                          cat === 'frozen' ? (language === 'ko' ? '냉동' : language === 'es' ? 'Congelado' : 'Frozen') : 
                          cat === 'refrigerated' ? (language === 'ko' ? '냉장' : language === 'es' ? 'Refrigerado' : 'Refrigerated') : 
                          (language === 'ko' ? '실온' : language === 'es' ? 'Temperatura Ambiente' : 'Room Temp')
                        )
                      ]
                    : [
                        h('span', { key: 'icon' }, cat === 'all' ? '📦' : (categoryData[cat]?.icon || '📦')),
                        h('span', { key: 'text' }, 
                          cat === 'all' ? (language === 'ko' ? '전체' : language === 'es' ? 'Todo' : 'All') : 
                          cat === 'Uncategorized' ? (language === 'ko' ? '미분류' : language === 'es' ? 'Sin Categorizar' : 'Uncategorized') :
                          getCategoryLabel(cat)
                        )
                      ]
                  )
                )
              ),
              
              // 아이템 카드
              h('div', { key: 'items', style: { display: 'flex', flexDirection: 'column', gap: '1rem', paddingBottom: '100px' }},
                items
                  .filter(item => {
                    // 검색 필터
                    if (countSearchTerm && !item.name.toLowerCase().includes(countSearchTerm.toLowerCase())) return false;
                    
                    // 보관별/분류별 필터
                    if (categoryFilter !== 'all') {
                      if (filterMode === 'storage') {
                        // 보관별 (냉동/냉장/실온)
                        if (item.category !== categoryFilter) return false;
                      } else {
                        // 분류별 (Meat, Seafood 등)
                        const itemCat = itemCategories[item.name];
                        if (categoryFilter === 'Uncategorized') {
                          if (itemCat) return false;
                        } else {
                          if (itemCat !== categoryFilter) return false;
                        }
                      }
                    }
                    return true;
                  })
                  .map((item, idx) => {
                    const actualIdx = items.findIndex(i => i.name === item.name);
                    return h('div', {
                      key: item.name,
                      style: {
                        background: 'white',
                        borderRadius: '16px',
                        padding: '1.5rem',
                        boxShadow: '0 2px 8px rgba(0,0,0,0.1)',
                        border: '2px solid #e2e8f0'
                      }
                    }, [
                      // 아이템 이름 + 분류
                      h('div', { 
                        key: 'header',
                        style: { 
                          display: 'flex',
                          justifyContent: 'space-between',
                          alignItems: 'center',
                          marginBottom: '1rem'
                        }
                      }, [
                        h('div', {
                          key: 'name',
                          style: { 
                            fontSize: '1.3rem', 
                            fontWeight: '700', 
                            color: '#2c3e50',
                            display: 'flex',
                            alignItems: 'center',
                            gap: '0.5rem'
                          }
                        }, [
                          h('span', { key: 'icon' }, storageIcons[item.category]),
                          h('span', { key: 'text' }, getItemName(item))
                        ]),
                        // 분류 표시
                        itemCategories[item.name] && h('div', {
                          key: 'category-badge',
                          style: {
                            padding: '0.4rem 0.8rem',
                            background: '#f0f9ff',
                            border: '1px solid #3b82f6',
                            borderRadius: '8px',
                            fontSize: '0.8rem',
                            fontWeight: '600',
                            color: '#3b82f6'
                          }
                        }, itemCategories[item.name])
                      ]),
                      
                      // 사진 (원본 비율!)
                      item.imageUrl && h('img', {
                        key: 'image',
                        src: item.imageUrl,
                        style: {
                          width: '100%',
                          maxHeight: '250px',
                          objectFit: 'contain',
                          borderRadius: '12px',
                          marginBottom: '1rem',
                          background: '#f8fafc',
                          cursor: 'pointer'
                        },
                        onClick: () => {
                          // 사진 크게 보기 모달
                          const modal = document.createElement('div');
                          modal.style.cssText = 'position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.9);display:flex;align-items:center;justify-content:center;z-index:9999;padding:1rem;';
                          modal.onclick = () => modal.remove();
                          const img = document.createElement('img');
                          img.src = item.imageUrl;
                          img.style.cssText = 'max-width:100%;max-height:100%;object-fit:contain;';
                          modal.appendChild(img);
                          document.body.appendChild(modal);
                        }
                      }),
                      
                      // 수량 조절 (한 줄)
                      h('div', {
                        key: 'counter',
                        style: {
                          display: 'flex',
                          alignItems: 'center',
                          justifyContent: 'center',
                          gap: '0.5rem',
                          marginBottom: '1rem'
                        }
                      }, [
                        // -1
                        h('button', {
                          key: 'minus1',
                          onClick: () => {
                            const u = [...items];
                            const val = parseFloat(u[actualIdx].current_inventory) || 0;
                            u[actualIdx].current_inventory = Math.max(0, val - 1);
                            setItems(u);
                          },
                          style: {
                            width: '55px',
                            height: '55px',
                            borderRadius: '10px',
                            border: '2px solid #ef4444',
                            background: 'white',
                            color: '#ef4444',
                            fontSize: '1.4rem',
                            fontWeight: '700',
                            cursor: 'pointer'
                          }
                        }, '-1'),
                        
                        // -0.5
                        h('button', {
                          key: 'minus05',
                          onClick: () => {
                            const u = [...items];
                            const val = parseFloat(u[actualIdx].current_inventory) || 0;
                            u[actualIdx].current_inventory = Math.max(0, val - 0.5);
                            setItems(u);
                          },
                          style: {
                            width: '55px',
                            height: '55px',
                            borderRadius: '10px',
                            border: '2px solid #ef4444',
                            background: 'white',
                            color: '#ef4444',
                            fontSize: '1.2rem',
                            fontWeight: '700',
                            cursor: 'pointer'
                          }
                        }, '-0.5'),
                        
                        // -0.25
                        h('button', {
                          key: 'minus025',
                          onClick: () => {
                            const u = [...items];
                            const val = parseFloat(u[actualIdx].current_inventory) || 0;
                            u[actualIdx].current_inventory = Math.max(0, val - 0.25);
                            setItems(u);
                          },
                          style: {
                            width: '55px',
                            height: '55px',
                            borderRadius: '10px',
                            border: '2px solid #ef4444',
                            background: 'white',
                            color: '#ef4444',
                            fontSize: '1rem',
                            fontWeight: '700',
                            cursor: 'pointer'
                          }
                        }, '-0.25'),
                        
                        // 입력칸 (박스만 크게!)
                        h('input', {
                          key: 'input',
                          type: 'number',
                          inputMode: 'decimal',
                          value: item.current_inventory,
                          onChange: (e) => {
                            const u = [...items];
                            u[actualIdx].current_inventory = parseFloat(e.target.value) || 0;
                            setItems(u);
                          },
                          style: {
                            width: '110px',
                            height: '82px',
                            fontSize: '1.8rem',
                            fontWeight: '700',
                            textAlign: 'center',
                            border: '3px solid #3b82f6',
                            borderRadius: '10px',
                            outline: 'none',
                            background: '#f0f9ff'
                          }
                        }),
                        
                        // +0.25
                        h('button', {
                          key: 'plus025',
                          onClick: () => {
                            const u = [...items];
                            const val = parseFloat(u[actualIdx].current_inventory) || 0;
                            u[actualIdx].current_inventory = val + 0.25;
                            setItems(u);
                          },
                          style: {
                            width: '55px',
                            height: '55px',
                            borderRadius: '10px',
                            border: '2px solid #10b981',
                            background: 'white',
                            color: '#10b981',
                            fontSize: '1rem',
                            fontWeight: '700',
                            cursor: 'pointer'
                          }
                        }, '+0.25'),
                        
                        // +0.5
                        h('button', {
                          key: 'plus05',
                          onClick: () => {
                            const u = [...items];
                            const val = parseFloat(u[actualIdx].current_inventory) || 0;
                            u[actualIdx].current_inventory = val + 0.5;
                            setItems(u);
                          },
                          style: {
                            width: '55px',
                            height: '55px',
                            borderRadius: '10px',
                            border: '2px solid #10b981',
                            background: 'white',
                            color: '#10b981',
                            fontSize: '1.2rem',
                            fontWeight: '700',
                            cursor: 'pointer'
                          }
                        }, '+0.5'),
                        
                        // +1
                        h('button', {
                          key: 'plus1',
                          onClick: () => {
                            const u = [...items];
                            const val = parseFloat(u[actualIdx].current_inventory) || 0;
                            u[actualIdx].current_inventory = val + 1;
                            setItems(u);
                          },
                          style: {
                            width: '55px',
                            height: '55px',
                            borderRadius: '10px',
                            border: '2px solid #10b981',
                            background: 'white',
                            color: '#10b981',
                            fontSize: '1.4rem',
                            fontWeight: '700',
                            cursor: 'pointer'
                          }
                        }, '+1')
                      ]),
                      
                      // PAR 표시
                      h('div', {
                        key: 'par',
                        style: {
                          fontSize: '0.9rem',
                          color: '#64748b',
                          textAlign: 'center'
                        }
                      }, `${language === 'ko' ? 'Par' : language === 'es' ? 'Par' : 'Par'}: ${item.par}`)
                    ]);  // 카드 닫기
                  })  // map 닫기
              ),
              
              // 저장 버튼
              h('button', {
                key: 'save',
                onClick: saveCount,
                style: {
                  position: 'fixed',
                  bottom: '2rem',
                  left: '50%',
                  transform: 'translateX(-50%)',
                  width: 'calc(100% - 3rem)',
                  maxWidth: '500px',
                  padding: '1.2rem',
                  background: 'linear-gradient(135deg, #10b981 0%, #059669 100%)',
                  color: 'white',
                  border: 'none',
                  borderRadius: '16px',
                  fontSize: '1.2rem',
                  fontWeight: '700',
                  cursor: 'pointer',
                  boxShadow: '0 4px 12px rgba(16,185,129,0.4)',
                  zIndex: 100
                }
              }, language === 'ko' ? '✅ 저장하기' : language === 'es' ? '✅ Guardar' : '✅ Save')
              
            ]) : 
            // Manager용 기존 화면
            h('div', { key: 'manager-count' }, [
            // 검색 칸
            h('div', { key: 'search', style: { marginBottom: '1rem' }}, 
              h('input', {
                type: 'text',
                placeholder: '🔍 ' + (t.searchItems || 'Search items...'),
                value: countSearchTerm,
                onChange: (e) => setCountSearchTerm(e.target.value),
                style: {
                  width: '100%',
                  padding: '0.75rem',
                  borderRadius: '8px',
                  border: '2px solid #e2e8f0',
                  fontSize: '1rem',
                  outline: 'none'
                }
              })
            ),

            h('div', { key: 'mode-switch', style: { display: 'flex', gap: '0.5rem', marginBottom: '1rem' }}, [
              h('button', { 
                key: 'storage',
                onClick: () => { setFilterMode('storage'); setCategoryFilter('all'); },
                style: { 
                  flex: 1,
                  padding: '0.75rem',
                  background: filterMode === 'storage' ? '#7f1d1d' : '#f8fafc',
                  border: filterMode === 'storage' ? '2px solid #7f1d1d' : '2px solid #e2e8f0',
                  borderRadius: '8px',
                  color: filterMode === 'storage' ? 'white' : '#64748b',
                  cursor: 'pointer',
                  fontWeight: '600'
                }
              }, t.byStorage || '보관별'),
              h('button', { 
                key: 'category',
                onClick: () => { setFilterMode('category'); setCategoryFilter('all'); },
                style: { 
                  flex: 1,
                  padding: '0.75rem',
                  background: filterMode === 'category' ? '#7f1d1d' : '#f8fafc',
                  border: filterMode === 'category' ? '2px solid #7f1d1d' : '2px solid #e2e8f0',
                  borderRadius: '8px',
                  color: filterMode === 'category' ? 'white' : '#64748b',
                  cursor: 'pointer',
                  fontWeight: '600'
                }
              }, t.byCategory || '분류별')
            ]),

            h('div', { key: 'filter', style: { display: 'flex', flexWrap: 'wrap', gap: '0.5rem', marginBottom: '1rem' }},
              (filterMode === 'storage' 
                ? ['all', 'frozen', 'refrigerated', 'dry']
                : ['all', ...categories, 'Uncategorized']
              ).map(cat =>
                h('button', {
                  key: cat,
                  onClick: () => setCategoryFilter(cat),
                  style: {
                    padding: '0.5rem 1rem',
                    background: categoryFilter === cat ? '#7f1d1d' : 'white',
                    border: categoryFilter === cat ? '2px solid #7f1d1d' : '2px solid #e2e8f0',
                    borderRadius: '8px',
                    color: categoryFilter === cat ? 'white' : '#64748b',
                    cursor: 'pointer',
                    fontSize: '0.875rem',
                    whiteSpace: 'nowrap',
                    display: 'flex',
                    alignItems: 'center',
                    gap: '0.25rem'
                  }
                }, filterMode === 'storage' 
                  ? [storageIcons[cat], ' ', cat === 'all' ? t.all : t[cat]]
                  : [getCategoryIcon(cat), ' ', getCategoryName(cat)]
                )
              )
            ),

            (() => {
              let filtered = Array.isArray(tempItems) ? tempItems : [];
              
              // 검색어 필터링
              if (countSearchTerm) {
                filtered = filtered.filter(item => 
                  item.name.toLowerCase().includes(countSearchTerm.toLowerCase())
                );
              }
              
              // 카테고리 필터링
              if (filterMode === 'storage' && categoryFilter !== 'all') {
                filtered = filtered.filter(i => i.category === categoryFilter);
              } else if (filterMode === 'category' && categoryFilter !== 'all') {
                if (categoryFilter === 'Uncategorized') {
                  filtered = filtered.filter(i => !itemCategories[i.name]);
                } else {
                  filtered = filtered.filter(i => itemCategories[i.name] === categoryFilter);
                }
              }
              
              return (Array.isArray(filtered) ? filtered : []).map((item, i) => {
                const globalIndex = tempItems.findIndex(it => it.name === item.name);
                const itemCategory = itemCategories[item.name] || 'Uncategorized';
                if (i < 3) {
                  console.log('Item:', item.name, 'Category:', itemCategory, 'From:', itemCategories[item.name]);
                }
                return h('div', { key: i, className: 'card', style: { color: '#2c3e50' }}, [
                  h('div', { key: 'info', style: { marginBottom: '0.75rem' }}, [
                    h('div', { key: 'name', style: { fontWeight: '600', marginBottom: '0.25rem', display: 'flex', alignItems: 'center', gap: '0.5rem', color: '#2c3e50' }}, [
                      h('span', { key: 'icon', className: 'category-badge', style: { background: `${categoryColors[item.category]}20`, color: categoryColors[item.category], border: `1px solid ${categoryColors[item.category]}40` }}, storageIcons[item.category]),
                      h('span', { key: 'text' }, item.name + ' - ' + (itemCategory === 'Uncategorized' ? itemCategory : (getCategoryIcon(itemCategory) || '') + ' ' + getCategoryName(itemCategory)))
                    ]),
                    h('div', { key: 'meta', style: { fontSize: '0.875rem', color: '#64748b' }}, 'PAR: ' + item.par + ' | ' + item.vendor + ' | $' + item.price)
                  ]),
                  h('div', { key: 'counter', style: { display: 'flex', gap: '0.5rem', alignItems: 'center', justifyContent: 'center' } }, [
                    h('button', { 
                      key: 'minus1', 
                      style: { 
                        padding: '0.5rem 0.75rem', 
                        background: '#ef4444', 
                        color: 'white', 
                        border: 'none', 
                        borderRadius: '8px', 
                        cursor: 'pointer', 
                        fontWeight: '600',
                        fontSize: '0.875rem'
                      }, 
                      onClick: () => updateTempInventory(globalIndex, Math.max(0, item.current_inventory - 1)) 
                    }, '-1'),
                    h('button', { 
                      key: 'minus05', 
                      style: { 
                        padding: '0.5rem 0.75rem', 
                        background: '#f87171', 
                        color: 'white', 
                        border: 'none', 
                        borderRadius: '8px', 
                        cursor: 'pointer', 
                        fontWeight: '600',
                        fontSize: '0.875rem'
                      }, 
                      onClick: () => updateTempInventory(globalIndex, Math.max(0, item.current_inventory - 0.5)) 
                    }, '-0.5'),
                    h('button', { 
                      key: 'minus025', 
                      style: { 
                        padding: '0.5rem 0.75rem', 
                        background: '#fca5a5', 
                        color: 'white', 
                        border: 'none', 
                        borderRadius: '8px', 
                        cursor: 'pointer', 
                        fontWeight: '600',
                        fontSize: '0.875rem'
                      }, 
                      onClick: () => updateTempInventory(globalIndex, Math.max(0, item.current_inventory - 0.25)) 
                    }, '-0.25'),
                    h('input', { 
                      key: 'input', 
                      type: 'number',
                      inputMode: 'decimal',
                      pattern: '[0-9]*',
                      step: '0.01', 
                      value: item.current_inventory, 
                      onFocus: (e) => e.target.select(),
                      onChange: (e) => updateTempInventory(globalIndex, parseFloat(e.target.value) || 0),
                      style: {
                        width: '80px',
                        padding: '0.5rem',
                        border: '2px solid #e2e8f0',
                        borderRadius: '8px',
                        textAlign: 'center',
                        fontSize: '1rem',
                        fontWeight: '600'
                      }
                    }),
                    h('button', { 
                      key: 'plus025', 
                      style: { 
                        padding: '0.5rem 0.75rem', 
                        background: '#86efac', 
                        color: 'white', 
                        border: 'none', 
                        borderRadius: '8px', 
                        cursor: 'pointer', 
                        fontWeight: '600',
                        fontSize: '0.875rem'
                      }, 
                      onClick: () => updateTempInventory(globalIndex, item.current_inventory + 0.25) 
                    }, '+0.25'),
                    h('button', { 
                      key: 'plus05', 
                      style: { 
                        padding: '0.5rem 0.75rem', 
                        background: '#4ade80', 
                        color: 'white', 
                        border: 'none', 
                        borderRadius: '8px', 
                        cursor: 'pointer', 
                        fontWeight: '600',
                        fontSize: '0.875rem'
                      }, 
                      onClick: () => updateTempInventory(globalIndex, item.current_inventory + 0.5) 
                    }, '+0.5'),
                    h('button', { 
                      key: 'plus1', 
                      style: { 
                        padding: '0.5rem 0.75rem', 
                        background: '#22c55e', 
                        color: 'white', 
                        border: 'none', 
                        borderRadius: '8px', 
                        cursor: 'pointer', 
                        fontWeight: '600',
                        fontSize: '0.875rem'
                      }, 
                      onClick: () => updateTempInventory(globalIndex, item.current_inventory + 1) 
                    }, '+1')
                  ])
                ]);
              });
            })(),

            h('button', { key: 'register', className: 'btn', onClick: saveCountRecord, style: { marginTop: '1.5rem', background: 'linear-gradient(135deg, #4ade80 0%, #22c55e 100%)' }}, '✓ ' + t.registerCount)
          ])  // Manager Count 닫기
          ]),  // Count 탭 전체 닫기

          activeTab === 'shopping' && h('div', { key: 'shop' }, [
            // 서브탭 네비게이션
            h('div', { key: 'tabs', style: { display: 'flex', gap: '0.5rem', marginBottom: '1.5rem', overflowX: 'auto' }}, [
              h('button', { 
                key: 'list', 
                className: 'nav-btn' + (shoppingSubTab === 'list' ? ' active' : ''), 
                onClick: () => setShoppingSubTab('list') 
              }, '📝 Shopping List'),
              h('button', { 
                key: 'confirm', 
                className: 'nav-btn' + (shoppingSubTab === 'confirm' ? ' active' : ''), 
                onClick: () => setShoppingSubTab('confirm'),
                style: orderedLists.filter(o => !o.completed).length > 0 ? { position: 'relative' } : {}
              }, [
                '✅ Confirm Delivery',
                orderedLists.filter(o => !o.completed).length > 0 && h('span', { 
                  key: 'badge',
                  style: { 
                    position: 'absolute', 
                    top: '-5px', 
                    right: '-5px', 
                    background: '#ef4444', 
                    color: 'white', 
                    borderRadius: '10px', 
                    padding: '2px 6px', 
                    fontSize: '0.75rem',
                    fontWeight: 'bold'
                  }
                }, orderedLists.filter(o => !o.completed).length)
              ]),
              inventoryRole !== 'employee' && h('button', { 
                key: 'stock', 
                className: 'nav-btn' + (shoppingSubTab === 'stock' ? ' active' : ''), 
                onClick: () => setShoppingSubTab('stock') 
              }, '📊 Current Stock')
            ]),

            // Shopping List 탭
            shoppingSubTab === 'list' && h('div', { key: 'list-content' }, [
              // Employee: 쇼핑리스트 생성 버튼
              inventoryRole === 'employee' && h('button', {
                key: 'generate-list-btn',
                className: 'btn',
                onClick: generateShoppingList,
                style: {
                  width: '100%',
                  marginBottom: '1rem',
                  background: 'linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)',
                  display: 'flex',
                  alignItems: 'center',
                  justifyContent: 'center',
                  gap: '0.5rem',
                  fontSize: '1.1rem',
                  padding: '1rem'
                }
              }, ['🛒 ', language === 'ko' ? '쇼핑리스트 생성' : language === 'es' ? 'Generar Lista de Compras' : 'Generate Shopping List']),
              
              // Manager: 아이템 추가 버튼
              inventoryRole !== 'employee' && h('button', {
                key: 'add-item-btn',
                className: 'btn',
                onClick: () => setShowAddItemModal(true),
                style: {
                  width: '100%',
                  marginBottom: '1rem',
                  background: 'linear-gradient(135deg, #10b981 0%, #059669 100%)',
                  display: 'flex',
                  alignItems: 'center',
                  justifyContent: 'center',
                  gap: '0.5rem'
                }
              }, ['➕ ', language === 'ko' ? '아이템 추가' : 'Add Item']),
              
              shoppingList.length === 0 ? h('div', { key: 'empty', className: 'card', style: { textAlign: 'center', padding: '2rem', color: '#64748b' }}, 'No items in shopping list') : [
                
                h('div', { 
                  key: 'header', 
                  style: { 
                    display: 'flex', 
                    justifyContent: 'space-between', 
                    alignItems: 'center', 
                    marginBottom: '1rem',
                    gap: '0.75rem'
                  }
                }, [
                  h('h3', { key: 'title', style: { color: '#7f1d1d', margin: 0, flex: 1 }}, t.shoppingList || '쇼핑 리스트'),
                  h('div', { 
                    key: 'buttons', 
                    style: { 
                      display: 'flex', 
                      gap: '0.5rem',
                      flexShrink: 0
                    }
                  }, [
                    h('button', {
                      key: 'clean',
                      type: 'button',
                      className: 'btn',
                      onClick: async (e) => {
                        e.preventDefault();
                        e.stopPropagation();
                        
                        if (confirm('Shopping List를 정리하시겠습니까?\n(vendor 필드 제거)')) {
                          try {
                            const cleaned = shoppingList.map(item => {
                              const { vendor, ...rest } = item;
                              if (!rest.selected_vendor) {
                                rest.selected_vendor = '⚠️ Not Assigned';
                              }
                              return rest;
                            });
                            
                            await window.db.ref(getPath('shopping')).set(cleaned);
                            setShoppingList(cleaned);
                            
                            alert('정리 완료!');
                            window.location.reload();
                          } catch (error) {
                            alert('에러: ' + error.message);
                          }
                        }
                      },
                      style: {
                        background: '#3b82f6',
                        padding: '0.5rem 0.875rem',
                        fontSize: '0.85rem',
                        whiteSpace: 'nowrap'
                      }
                    }, '🔧 Clean'),
                    h('button', {
                      key: 'cancel',
                      type: 'button',
                      className: 'btn',
                      onClick: async (e) => {
                        console.log('🔴 Cancel 버튼 클릭됨!');
                        console.log('  이벤트:', e);
                        console.log('  현재 Shopping List:', shoppingList);
                        console.log('  Shopping List 길이:', shoppingList.length);
                        
                        e.preventDefault();
                        e.stopPropagation();
                        
                        console.log('  confirm 팝업 표시 중...');
                        const userConfirmed = confirm('쇼핑 리스트를 삭제하시겠습니까?');
                        console.log('  사용자 응답:', userConfirmed);
                        
                        if (userConfirmed) {
                          console.log('✅ 삭제 진행 중...');
                          
                          try {
                            console.log('  1. Firebase 삭제 시작');
                            await window.db.ref(getPath('shopping')).set([]);
                            console.log('  2. Firebase 삭제 완료!');
                            
                            console.log('  3. State 업데이트');
                            setShoppingList([]);
                            
                            console.log('✅ 모든 작업 완료! 페이지 새로고침...');
                            alert('삭제 완료!');
                            
                            // 페이지 새로고침으로 확실하게 반영
                            window.location.reload();
                          } catch (error) {
                            console.error('❌ 에러 발생:', error);
                            alert('에러: ' + error.message);
                          }
                        } else {
                          console.log('❌ 사용자가 취소함');
                        }
                      },
                      style: {
                        background: '#ef4444',
                        padding: '0.5rem 0.875rem',
                        fontSize: '0.85rem',
                        whiteSpace: 'nowrap'
                      }
                    }, '✕ Cancel')
                  ])
                ]),
                  
                ['frozen', 'refrigerated', 'dry'].map(cat => {
                  const catItems = Array.isArray(shoppingList) ? shoppingList.filter(item => item.category === cat) : [];
                  if (catItems.length === 0) return null;
                  return h('div', { key: cat, className: 'vendor-group', style: { marginBottom: '1.5rem' }}, [
                    h('div', { key: 'title', style: { fontSize: '1rem', fontWeight: '700', color: categoryColors[cat], marginBottom: '1rem', display: 'flex', alignItems: 'center', gap: '0.5rem' }}, [
                      storageIcons[cat], ' ', t[cat]
                    ]),
                    catItems.sort((a, b) => a.name.localeCompare(b.name)).map((item, i) => {
                      const globalIndex = shoppingList.findIndex(si => si.name === item.name);
                      
                      // Employee: 사진 + 수량만 표시
                      if (inventoryRole === 'employee') {
                        return h('div', { 
                          key: i, 
                          className: 'card', 
                          style: { 
                            marginBottom: '0.75rem', 
                            padding: '1.5rem',
                            display: 'flex',
                            flexDirection: 'column',
                            gap: '1rem'
                          }
                        }, [
                          // 아이템 이름
                          h('div', { 
                            key: 'name', 
                            style: { 
                              fontWeight: '700', 
                              fontSize: '1.2rem',
                              color: '#2c3e50' 
                            }
                          }, item.name),
                          
                          // 사진
                          item.imageUrl && h('img', {
                            key: 'image',
                            src: item.imageUrl,
                            style: {
                              width: '100%',
                              maxHeight: '200px',
                              objectFit: 'contain',
                              borderRadius: '12px',
                              background: '#f8fafc',
                              cursor: 'pointer'
                            },
                            onClick: () => {
                              const modal = document.createElement('div');
                              modal.style.cssText = 'position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.9);display:flex;align-items:center;justify-content:center;z-index:9999;padding:1rem;';
                              modal.onclick = () => modal.remove();
                              const img = document.createElement('img');
                              img.src = item.imageUrl;
                              img.style.cssText = 'max-width:100%;max-height:100%;object-fit:contain;';
                              modal.appendChild(img);
                              document.body.appendChild(modal);
                            }
                          }),
                          
                          // 수량 조절
                          h('div', { 
                            key: 'quantity', 
                            style: { 
                              display: 'flex', 
                              alignItems: 'center', 
                              justifyContent: 'center',
                              gap: '1rem' 
                            }
                          }, [
                            h('span', { 
                              key: 'label', 
                              style: { 
                                fontSize: '1.1rem', 
                                fontWeight: '600',
                                color: '#64748b' 
                              }
                            }, t.quantity || 'Quantity:'),
                            h('div', { key: 'counter', className: 'counter' }, [
                              h('button', { 
                                key: 'minus', 
                                className: 'counter-btn', 
                                style: { 
                                  width: '50px', 
                                  height: '50px',
                                  fontSize: '1.5rem'
                                }, 
                                onClick: () => updateShoppingQuantity(globalIndex, Math.max(0, item.shortage - 0.5)) 
                              }, '-'),
                              h('input', { 
                                key: 'qty', 
                                className: 'counter-input',
                                type: 'number',
                                inputMode: 'decimal',
                                pattern: '[0-9]*',
                                step: '0.5',
                                value: item.shortage,
                                style: { 
                                  width: '100px',
                                  height: '50px',
                                  fontSize: '1.5rem',
                                  textAlign: 'center'
                                },
                                onFocus: (e) => e.target.select(),
                                onChange: (e) => updateShoppingQuantity(globalIndex, e.target.value) 
                              }),
                              h('button', { 
                                key: 'plus', 
                                className: 'counter-btn', 
                                style: { 
                                  width: '50px', 
                                  height: '50px',
                                  fontSize: '1.5rem'
                                }, 
                                onClick: () => updateShoppingQuantity(globalIndex, item.shortage + 0.5) 
                              }, '+')
                            ])
                          ])
                        ]);
                      }
                      
                      // Manager: 전체 정보 표시
                      return h('div', { key: i, className: 'card', style: { marginBottom: '0.75rem', padding: '1rem' }}, [
                        h('div', { key: 'name', style: { fontWeight: '600', marginBottom: '0.75rem', color: '#2c3e50' }}, getItemName(item)),
                        h('div', { key: 'inputs', style: { display: 'grid', gap: '0.75rem' }}, [
                          h('div', { key: 'row1', style: { display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '0.5rem' }}, [
                            h('div', { key: 'price-group', style: { display: 'flex', alignItems: 'center', gap: '0.25rem' }}, [
                              h('span', { key: 'label', style: { fontSize: '0.875rem', color: '#64748b', minWidth: '30px' }}, t.price),
                              h('input', {
                                key: 'price',
                                type: 'number',
                                inputMode: 'decimal',
                                pattern: '[0-9]*',
                                step: '0.01',
                                value: item.price,
                                onFocus: (e) => e.target.select(),
                                onChange: (e) => updateShoppingPrice(globalIndex, e.target.value),
                                style: { flex: 1, background: 'white', border: '2px solid #e2e8f0', borderRadius: '6px', padding: '0.5rem', color: '#2c3e50', fontSize: '0.875rem' }
                              })
                            ]),
                            h('div', { key: 'vendor-group' }, [
                              h('select', {
                                key: 'vendor',
                                value: item.selected_vendor,
                                onChange: (e) => updateShoppingVendor(globalIndex, e.target.value),
                                style: { 
                                  width: '100%', 
                                  background: item.selected_vendor === '⚠️ Not Assigned' ? '#fef2f2' : 'white',
                                  border: item.selected_vendor === '⚠️ Not Assigned' ? '2px solid #ef4444' : '2px solid #e2e8f0',
                                  borderRadius: '6px', 
                                  padding: '0.5rem', 
                                  color: item.selected_vendor === '⚠️ Not Assigned' ? '#ef4444' : '#2c3e50',
                                  fontSize: '0.875rem',
                                  fontWeight: item.selected_vendor === '⚠️ Not Assigned' ? '700' : '400'
                                }
                              }, [
                                item.selected_vendor === '⚠️ Not Assigned' && h('option', { key: 'not-assigned', value: '⚠️ Not Assigned' }, '⚠️ Not Assigned'),
                                ...vendors.map(v => h('option', { key: v, value: v }, v))
                              ])
                            ])
                          ]),
                          h('div', { key: 'row2', className: 'counter' }, [
                            h('button', { key: 'minus', className: 'counter-btn', style: { width: '40px', height: '40px' }, onClick: () => updateShoppingQuantity(globalIndex, Math.max(0, item.shortage - 0.5)) }, '-'),
                            h('input', { 
                              key: 'qty', 
                              className: 'counter-input',
                              type: 'number',
                              inputMode: 'decimal',
                              pattern: '[0-9]*',
                              step: '0.5',
                              value: item.shortage,
                              style: { width: '80px' },
                              onFocus: (e) => e.target.select(),
                              onChange: (e) => updateShoppingQuantity(globalIndex, e.target.value) 
                            }),
                            h('button', { key: 'plus', className: 'counter-btn', style: { width: '40px', height: '40px' }, onClick: () => updateShoppingQuantity(globalIndex, item.shortage + 0.5) }, '+')
                          ])
                        ])
                      ]);
                    })
                  ]);
                }),
                
                h('div', { key: 'misc-section', style: { marginTop: '2rem', padding: '1.5rem', background: 'rgba(127,29,29,0.05)', borderRadius: '12px', border: '2px dashed #7f1d1d' }}, [
                  h('h4', { key: 'title', style: { marginBottom: '1rem', color: '#7f1d1d', fontWeight: '700' }}, t.miscellaneous),
                  h('p', { key: 'desc', style: { fontSize: '0.875rem', color: '#64748b', marginBottom: '1rem' }}, t.miscellaneousDesc),
                  
                  miscItems.map((item, i) =>
                    h('div', { key: i, className: 'card', style: { marginBottom: '0.75rem', display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}, [
                      h('div', { key: 'info' }, [
                        h('div', { key: 'name', style: { fontWeight: '600', color: '#2c3e50' }}, item.name),
                        h('div', { key: 'price', style: { fontSize: '0.875rem', color: '#64748b' }}, `${item.quantity} × $${item.price} = $${(item.quantity * item.price).toFixed(2)}`)
                      ]),
                      h('button', { key: 'delete', onClick: () => setMiscItems(miscItems.filter((_, idx) => idx !== i)), style: { background: '#ef4444', color: 'white', border: 'none', borderRadius: '6px', padding: '0.5rem 1rem', cursor: 'pointer' }}, t.deleteButton)
                    ])
                  ),
                  
                  h('div', { key: 'add-form', style: { display: 'grid', gap: '0.75rem', marginTop: '1rem' }}, [
                    h('input', { key: 'name', type: 'text', placeholder: t.itemNamePlaceholder, value: newMisc.name, onChange: (e) => setNewMisc({...newMisc, name: e.target.value}) }),
                    h('div', { key: 'row', style: { display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '0.5rem' }}, [
                      h('div', { key: 'price-wrapper', style: { display: 'flex', alignItems: 'center', gap: '0.5rem' }}, [
                        h('label', { key: 'label', style: { fontWeight: '600', color: '#2c3e50', fontSize: '0.875rem', minWidth: '50px' }}, 'Price:'),
                        h('input', { key: 'price', type: 'number', step: '0.01', placeholder: '$0.00', value: newMisc.price, onChange: (e) => setNewMisc({...newMisc, price: parseFloat(e.target.value) || 0}), style: { flex: 1 }})
                      ]),
                      h('div', { key: 'qty-wrapper', style: { display: 'flex', alignItems: 'center', gap: '0.5rem' }}, [
                        h('label', { key: 'label', style: { fontWeight: '600', color: '#2c3e50', fontSize: '0.875rem', minWidth: '40px' }}, 'Unit:'),
                        h('input', { key: 'qty', type: 'number', step: '0.5', placeholder: '1', value: newMisc.quantity, onChange: (e) => setNewMisc({...newMisc, quantity: parseFloat(e.target.value) || 1}), style: { flex: 1 }})
                      ])
                    ]),
                    h('button', { key: 'add', className: 'btn btn-secondary', onClick: () => { if (newMisc.name) { setMiscItems([...miscItems, newMisc]); setNewMisc({ name: '', price: 0, quantity: 1 }); }}, disabled: !newMisc.name }, t.addButton)
                  ])
                ]),
                
                h('button', { 
                  key: 'complete', 
                  className: 'btn', 
                  onClick: completeOrder,
                  style: { marginTop: '1.5rem', background: 'linear-gradient(135deg, #4ade80 0%, #22c55e 100%)' }
                }, '📦 Complete Order')
              ]
            ]),

            // Confirm Delivery 탭
            shoppingSubTab === 'confirm' && h('div', { key: 'confirm-content' }, [
              h('h3', { key: 'title', style: { marginBottom: '1rem', color: '#7f1d1d' }}, '✅ Confirm Delivery'),
              
              orderedLists.length === 0 ? 
                h('div', { key: 'empty', className: 'card', style: { textAlign: 'center', padding: '2rem', color: '#64748b' }}, 'No orders to confirm') :
                orderedLists.map(order => {
                  const pendingItems = order.items.filter(item => !item.received);
                  const receivedCount = order.items.filter(item => item.received).length;
                  const selectedForThisOrder = selectedDeliveryItems[order.id] || [];
                  const isExpanded = expandedOrders[order.id];
                  
                  return h('div', { 
                    key: order.id, 
                    className: 'card',
                    style: { 
                      marginBottom: '0.75rem',
                      padding: '0.875rem',
                      background: order.completed ? 'rgba(34, 197, 94, 0.1)' : 'white',
                      border: order.completed ? '2px solid #22c55e' : '1px solid #e2e8f0',
                      overflow: 'hidden'
                    }
                  }, [
                    // 헤더 - 항상 보임 (클릭 가능)
                    h('div', { 
                      key: 'header', 
                      style: { 
                        display: 'flex', 
                        justifyContent: 'space-between', 
                        alignItems: 'flex-start', 
                        padding: '0',
                  whiteSpace: 'nowrap',
                        gap: '0.5rem'
                      }
                    }, [
                      h('div', { 
                        key: 'left', 
                        onClick: () => {
                          const newExpanded = {...expandedOrders};
                          newExpanded[order.id] = !isExpanded;
                          setExpandedOrders(newExpanded);
                        },
                        style: { 
                          display: 'flex', 
                          alignItems: 'flex-start', 
                          gap: '0.5rem',
                          flex: 1,
                          cursor: 'pointer',
                          minWidth: 0
                        }
                      }, [
                        h('div', { 
                          key: 'icon', 
                          style: { 
                            fontSize: '1rem',
                            transition: 'transform 0.3s',
                            transform: isExpanded ? 'rotate(90deg)' : 'rotate(0deg)',
                            marginTop: '0.125rem',
                            flexShrink: 0
                          }
                        }, '▶'),
                        h('div', { key: 'info', style: { minWidth: 0 }}, [
                          h('div', { 
                            key: 'date', 
                            style: { 
                              fontWeight: '700', 
                              color: '#2c3e50', 
                              fontSize: '0.95rem',
                              lineHeight: '1.3'
                            }
                          }, `${order.date} ${order.time}`),
                          h('div', { 
                            key: 'stats', 
                            style: { 
                              fontSize: '0.75rem', 
                              color: '#64748b', 
                              marginTop: '0.125rem',
                              lineHeight: '1.3'
                            }
                          }, 
                            order.completed ? 
                              `✅ ${order.totalItems} items` :
                              `⏳ ${receivedCount}/${order.totalItems}` + 
                              (selectedForThisOrder.length > 0 && isExpanded ? ` • ${selectedForThisOrder.length} sel` : '')
                          )
                        ])
                      ]),
                      h('div', { 
                        key: 'right', 
                        style: { 
                          display: 'flex', 
                          alignItems: 'flex-start',
                          flexDirection: 'column',
                          gap: '0.375rem',
                          flexShrink: 0
                        }
                      }, [
                        h('div', {
                          key: 'top-row',
                          style: {
                            display: 'flex',
                            alignItems: 'center',
                            gap: '0.375rem'
                          }
                        }, [
                          h('button', {
                            key: 'view',
                            type: 'button',
                            className: 'btn',
                            onClick: (e) => {
                              e.stopPropagation();
                              const viewData = order.items.map(item => ({
                                name: item.name,
                                category: item.category,
                                selected_vendor: item.vendor,
                                shortage: item.quantity,
                                price: item.price,
                                total: item.total
                              }));
                              setPurchaseData(viewData);
                              setShowSimpleView(true);
                            },
                            style: { 
                              padding: '0.375rem 0.625rem',
                              background: '#3b82f6',
                              fontSize: '0.75rem',
                              minWidth: 0,
                              whiteSpace: 'nowrap'
                            }
                          }, '📋'),
                          h('button', {
                            key: 'delete',
                            type: 'button',
                            className: 'btn',
                            onClick: async (e) => {
                              console.log('🗑️ Order 삭제 버튼 클릭됨!');
                              console.log('  주문 ID:', order.id);
                              
                              e.stopPropagation();
                              
                              const userConfirmed = confirm(`주문을 삭제하시겠습니까?\n${order.date} ${order.time}\n$${order.totalCost.toFixed(2)}`);
                              console.log('  사용자 응답:', userConfirmed);
                              
                              if (userConfirmed) {
                                console.log('✅ 삭제 진행 중...');
                                
                                try {
                                  console.log('  1. Firebase 업데이트 시작');
                                  const updated = orderedLists.filter(o => o.id !== order.id);
                                  await window.db.ref(getPath('orderedLists')).set(updated);
                                  console.log('  2. Firebase 업데이트 완료!');
                                  
                                  console.log('  3. State 업데이트');
                                  setOrderedLists(updated);
                                  
                                  console.log('✅ 모든 작업 완료! 페이지 새로고침...');
                                  alert('삭제 완료!');
                                  window.location.reload();
                                } catch (error) {
                                  console.error('❌ 에러 발생:', error);
                                  alert('에러: ' + error.message);
                                }
                              } else {
                                console.log('❌ 사용자가 취소함');
                              }
                            },
                            style: { 
                              padding: '0.375rem 0.625rem',
                              background: '#ef4444',
                              fontSize: '0.75rem',
                              minWidth: 0,
                              whiteSpace: 'nowrap'
                            }
                          }, '🗑️'),
                          !order.completed && pendingItems.length > 0 && h('div', {
                            key: 'badge',
                            style: {
                              background: '#ef4444',
                              color: 'white',
                              padding: '0.25rem 0.5rem',
                              borderRadius: '10px',
                              fontSize: '0.7rem',
                              fontWeight: '700',
                              whiteSpace: 'nowrap'
                            }
                          }, `${pendingItems.length}`)
                        ]),
                        h('div', { 
                          key: 'cost', 
                          style: { 
                            fontSize: '1rem', 
                            fontWeight: '700', 
                            color: '#7f1d1d',
                            textAlign: 'right'
                          }
                        }, `$${order.totalCost.toFixed(2)}`)
                      ])
                    ]),
                    
                    // 아이템 리스트 - 펼쳤을 때만 보임
                    isExpanded && h('div', { key: 'content', style: { padding: '0.75rem 0 0 0', borderTop: '1px solid #e2e8f0' }}, [
                      h('div', { key: 'items', style: { marginTop: '0.5rem' }},
                        order.items.map((item, idx) => {
                          const isSelected = selectedForThisOrder.includes(idx);
                          
                          // Employee: 사진 + 수량만
                          if (inventoryRole === 'employee') {
                            return h('div', { 
                              key: idx,
                              style: { 
                                display: 'flex',
                                flexDirection: 'column',
                                padding: '1rem',
                                marginBottom: '0.75rem',
                                background: item.received ? 'rgba(34, 197, 94, 0.1)' : (isSelected ? 'rgba(59, 130, 246, 0.1)' : 'white'),
                                borderRadius: '12px',
                                border: item.received ? '2px solid #22c55e' : (isSelected ? '2px solid #3b82f6' : '2px solid #e2e8f0'),
                                gap: '1rem'
                              }
                            }, [
                              // 체크박스 + 이름
                              h('div', {
                                key: 'header',
                                style: {
                                  display: 'flex',
                                  alignItems: 'center',
                                  gap: '0.75rem'
                                }
                              }, [
                                h('input', {
                                  key: 'checkbox',
                                  type: 'checkbox',
                                  checked: item.received || isSelected,
                                  disabled: order.completed || item.received,
                                  onChange: () => {
                                    if (!order.completed && !item.received) {
                                      const newSelected = {...selectedDeliveryItems};
                                      if (!newSelected[order.id]) {
                                        newSelected[order.id] = [];
                                      }
                                      
                                      if (isSelected) {
                                        newSelected[order.id] = newSelected[order.id].filter(i => i !== idx);
                                        if (newSelected[order.id].length === 0) {
                                          delete newSelected[order.id];
                                        }
                                      } else {
                                        newSelected[order.id].push(idx);
                                      }
                                      
                                      setSelectedDeliveryItems(newSelected);
                                    }
                                  },
                                  style: { 
                                    width: '24px', 
                                    height: '24px',
                                    flexShrink: 0,
                                    cursor: (order.completed || item.received) ? 'not-allowed' : 'pointer'
                                  }
                                }),
                                h('div', { 
                                  key: 'name', 
                                  style: { 
                                    fontWeight: '700', 
                                    fontSize: '1.1rem',
                                    color: '#2c3e50',
                                    flex: 1
                                  }
                                }, item.name),
                                item.received && h('span', { 
                                  key: 'status', 
                                  style: { 
                                    color: '#22c55e', 
                                    fontWeight: '600', 
                                    fontSize: '1.5rem',
                                    flexShrink: 0
                                  }
                                }, '✓')
                              ]),
                              
                              // 사진
                              item.imageUrl && h('img', {
                                key: 'image',
                                src: item.imageUrl,
                                style: {
                                  width: '100%',
                                  maxHeight: '200px',
                                  objectFit: 'contain',
                                  borderRadius: '12px',
                                  background: '#f8fafc',
                                  cursor: 'pointer'
                                },
                                onClick: () => {
                                  const modal = document.createElement('div');
                                  modal.style.cssText = 'position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.9);display:flex;align-items:center;justify-content:center;z-index:9999;padding:1rem;';
                                  modal.onclick = () => modal.remove();
                                  const img = document.createElement('img');
                                  img.src = item.imageUrl;
                                  img.style.cssText = 'max-width:100%;max-height:100%;object-fit:contain;';
                                  modal.appendChild(img);
                                  document.body.appendChild(modal);
                                }
                              }),
                              
                              // 수량
                              h('div', { 
                                key: 'quantity', 
                                style: { 
                                  textAlign: 'center',
                                  fontSize: '1.2rem',
                                  fontWeight: '600',
                                  color: '#2c3e50',
                                  padding: '0.75rem',
                                  background: '#f8fafc',
                                  borderRadius: '8px'
                                }
                              }, `${t.quantity || 'Quantity'}: ${item.quantity}`)
                            ]);
                          }
                          
                          // Manager: 기존 표시
                          return h('div', { 
                            key: idx,
                            style: { 
                              display: 'flex',
                              alignItems: 'center',
                              padding: '0.625rem',
                              marginBottom: '0.375rem',
                              background: item.received ? 'rgba(34, 197, 94, 0.1)' : (isSelected ? 'rgba(59, 130, 246, 0.1)' : 'rgba(248, 113, 113, 0.05)'),
                              borderRadius: '6px',
                              border: item.received ? '1px solid #22c55e' : (isSelected ? '2px solid #3b82f6' : '1px solid #fecaca'),
                              gap: '0.5rem'
                            }
                          }, [
                            h('input', {
                              key: 'checkbox',
                              type: 'checkbox',
                              checked: item.received || isSelected,
                              disabled: order.completed || item.received,
                              onChange: () => {
                                if (!order.completed && !item.received) {
                                  const newSelected = {...selectedDeliveryItems};
                                  if (!newSelected[order.id]) {
                                    newSelected[order.id] = [];
                                  }
                                  
                                  if (isSelected) {
                                    newSelected[order.id] = newSelected[order.id].filter(i => i !== idx);
                                    if (newSelected[order.id].length === 0) {
                                      delete newSelected[order.id];
                                    }
                                  } else {
                                    newSelected[order.id].push(idx);
                                  }
                                  
                                  setSelectedDeliveryItems(newSelected);
                                }
                              },
                              style: { 
                                width: '18px', 
                                height: '18px',
                                flexShrink: 0,
                                cursor: (order.completed || item.received) ? 'not-allowed' : 'pointer'
                              }
                            }),
                            h('div', { key: 'details', style: { flex: 1, minWidth: 0 }}, [
                              h('div', { 
                                key: 'name', 
                                style: { 
                                  fontWeight: '600', 
                                  color: '#2c3e50',
                                  fontSize: '0.85rem',
                                  overflow: 'hidden',
                                  textOverflow: 'ellipsis',
                                  whiteSpace: 'nowrap'
                                }
                              }, item.name),
                              h('div', { 
                                key: 'meta', 
                                style: { 
                                  fontSize: '0.7rem', 
                                  color: '#64748b',
                                  marginTop: '0.125rem'
                                }
                              }, 
                                `${item.quantity} × $${item.price}`
                              )
                            ]),
                            item.received && h('span', { 
                              key: 'status', 
                              style: { 
                                color: '#22c55e', 
                                fontWeight: '600', 
                                fontSize: '1.1rem',
                                flexShrink: 0
                              }
                            }, '✓'),
                            !item.received && isSelected && h('span', { 
                              key: 'pending', 
                              style: { 
                                color: '#3b82f6', 
                                fontWeight: '600', 
                                fontSize: '0.7rem',
                                flexShrink: 0
                              }
                            }, 'SEL')
                          ])
                        })
                      ),
                      
                      !order.completed && pendingItems.length > 0 && h('div', { 
                        key: 'actions', 
                        style: { 
                          marginTop: '0.75rem', 
                          paddingTop: '0.75rem', 
                          borderTop: '1px solid #e2e8f0', 
                          display: 'flex',
                          flexDirection: 'column',
                          gap: '0.5rem'
                        }
                      }, [
                        h('button', {
                          key: 'select-all',
                          className: 'btn',
                          onClick: () => {
                            const pendingIndices = order.items
                              .map((item, idx) => item.received ? null : idx)
                              .filter(idx => idx !== null);
                            
                            const newSelected = {...selectedDeliveryItems};
                            newSelected[order.id] = pendingIndices;
                            setSelectedDeliveryItems(newSelected);
                          },
                          style: { 
                            background: '#3b82f6',
                            padding: '0.625rem',
                            fontSize: '0.85rem'
                          }
                        }, `Select All (${pendingItems.length})`),
                        selectedForThisOrder.length > 0 && h('button', {
                          key: 'confirm',
                          className: 'btn',
                          onClick: () => confirmDelivery(order.id),
                          style: { 
                            background: '#22c55e',
                            padding: '0.625rem',
                            fontSize: '0.85rem'
                          }
                        }, `✓ Confirm (${selectedForThisOrder.length})`)
                      ])
                    ])
                  ]);
                })
            ]),

            // Current Stock 탭
            shoppingSubTab === 'stock' && h('div', { key: 'stock-content' }, [
              h('div', { key: 'header', style: { display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '1rem' }}, [
                h('h3', { key: 'title', style: { color: '#7f1d1d' }}, '📊 Current Stock Status'),
                h('select', {
                  key: 'filter',
                  value: stockStatusFilter,
                  onChange: (e) => setStockStatusFilter(e.target.value),
                  style: {
                    padding: '0.5rem 1rem',
                    borderRadius: '8px',
                    border: '2px solid #e2e8f0',
                    background: 'white',
                    color: '#2c3e50',
                    fontWeight: '600',
                    cursor: 'pointer'
                  }
                }, [
                  h('option', { key: 'all', value: 'all' }, '🔍 All Items'),
                  h('option', { key: 'low', value: 'low' }, '🔴 Low Stock'),
                  h('option', { key: 'ok', value: 'ok' }, '🟢 Sufficient'),
                  h('option', { key: 'ordered', value: 'ordered' }, '🟡 On Order')
                ])
              ]),
              
              h('div', { key: 'table-wrapper', style: { overflowX: 'auto' }}, [
                h('table', { key: 'table', style: { width: '100%', borderCollapse: 'collapse', fontSize: '0.875rem' }}, [
                  h('thead', { key: 'head' }, [
                    h('tr', { key: 'row', style: { background: '#f8fafc', borderBottom: '2px solid #e2e8f0' }}, [
                      h('th', { key: 'name', style: { padding: '0.75rem', textAlign: 'left', fontWeight: '700', color: '#2c3e50' }}, 'Item'),
                      h('th', { key: 'current', style: { padding: '0.75rem', textAlign: 'center', fontWeight: '700', color: '#2c3e50' }}, 'Current'),
                      h('th', { key: 'par', style: { padding: '0.75rem', textAlign: 'center', fontWeight: '700', color: '#2c3e50' }}, 'PAR'),
                      h('th', { key: 'shortage', style: { padding: '0.75rem', textAlign: 'center', fontWeight: '700', color: '#2c3e50' }}, 'Shortage'),
                      h('th', { key: 'ordered', style: { padding: '0.75rem', textAlign: 'center', fontWeight: '700', color: '#2c3e50' }}, 'Ordered'),
                      h('th', { key: 'status', style: { padding: '0.75rem', textAlign: 'center', fontWeight: '700', color: '#2c3e50' }}, 'Status')
                    ])
                  ]),
                  h('tbody', { key: 'body' },
                    (() => {
                      return items.filter(item => {
                        const shortage = Math.max(0, item.par - item.current_inventory);
                        
                        // 진행 중인 주문에서 이 아이템의 미입고 수량 계산
                        let orderedQty = 0;
                        orderedLists.forEach(order => {
                          if (!order.completed) {
                            order.items.forEach(orderItem => {
                              if (orderItem.name === item.name && !orderItem.received) {
                                orderedQty += orderItem.quantity;
                              }
                            });
                          }
                        });
                        
                        // 필터링
                        if (stockStatusFilter === 'low') return shortage > 0;
                        if (stockStatusFilter === 'ok') return shortage === 0;
                        if (stockStatusFilter === 'ordered') return orderedQty > 0;
                        return true; // 'all'
                      }).map((item, idx) => {
                        const shortage = Math.max(0, item.par - item.current_inventory);
                        
                        // 진행 중인 주문에서 이 아이템의 미입고 수량 계산
                        let orderedQty = 0;
                        orderedLists.forEach(order => {
                          if (!order.completed) {
                            order.items.forEach(orderItem => {
                              if (orderItem.name === item.name && !orderItem.received) {
                                orderedQty += orderItem.quantity;
                              }
                            });
                          }
                        });
                        
                        const statusColor = shortage > 0 ? '#ef4444' : '#22c55e';
                        const statusText = shortage > 0 ? '🔴 Low' : '🟢 OK';
                        
                        return h('tr', { 
                          key: idx,
                          style: { borderBottom: '1px solid #e2e8f0' }
                        }, [
                          h('td', { key: 'name', style: { padding: '0.75rem', fontWeight: '600', color: '#2c3e50' }}, getItemName(item)),
                          h('td', { key: 'current', style: { padding: '0.75rem', textAlign: 'center', color: '#64748b' }}, item.current_inventory.toFixed(1)),
                          h('td', { key: 'par', style: { padding: '0.75rem', textAlign: 'center', color: '#64748b' }}, item.par.toFixed(1)),
                          h('td', { key: 'shortage', style: { padding: '0.75rem', textAlign: 'center', fontWeight: '600', color: shortage > 0 ? '#ef4444' : '#64748b' }}, 
                            shortage > 0 ? `-${shortage.toFixed(1)}` : '0'
                          ),
                          h('td', { key: 'ordered', style: { padding: '0.75rem', textAlign: 'center', fontWeight: '600', color: orderedQty > 0 ? '#f59e0b' : '#64748b' }}, 
                            orderedQty > 0 ? `+${orderedQty.toFixed(1)}` : '0'
                          ),
                          h('td', { key: 'status', style: { padding: '0.75rem', textAlign: 'center', fontWeight: '600', color: statusColor }}, statusText)
                        ]);
                      });
                    })()
                  )
                ])
              ])
            ]),
            
            // 아이템 추가 모달
            showAddItemModal && h('div', {
              key: 'add-item-modal',
              style: {
                position: 'fixed',
                top: 0,
                left: 0,
                right: 0,
                bottom: 0,
                background: 'rgba(0,0,0,0.5)',
                display: 'flex',
                alignItems: 'center',
                justifyContent: 'center',
                zIndex: 1000,
                padding: '1rem'
              },
              onClick: () => setShowAddItemModal(false)
            }, [
              h('div', {
                key: 'modal-content',
                className: 'card',
                style: {
                  maxWidth: '500px',
                  width: '100%',
                  maxHeight: '80vh',
                  overflow: 'auto'
                },
                onClick: (e) => e.stopPropagation()
              }, [
                h('h3', { key: 'title', style: { color: '#7f1d1d', marginBottom: '1rem' }}, 
                  language === 'ko' ? '아이템 추가' : 'Add Item'),
                
                // 검색창
                h('input', {
                  key: 'search',
                  type: 'text',
                  placeholder: language === 'ko' ? '🔍 아이템 검색...' : '🔍 Search items...',
                  value: addItemSearch,
                  onChange: (e) => setAddItemSearch(e.target.value),
                  style: {
                    width: '100%',
                    padding: '0.75rem',
                    border: '2px solid #e2e8f0',
                    borderRadius: '8px',
                    fontSize: '1rem',
                    marginBottom: '1rem'
                  }
                }),
                
                // 아이템 목록
                h('div', { key: 'items-' + addItemSearch, style: { maxHeight: '400px', overflow: 'auto' }}, 
                  items
                    .filter(item => {
                      // 이미 쇼핑리스트에 있는 아이템 제외
                      const inShoppingList = shoppingList.some(si => si.name === item.name);
                      if (inShoppingList) return false;
                      
                      // 검색 필터
                      if (addItemSearch) {
                        return item.name.toLowerCase().includes(addItemSearch.toLowerCase());
                      }
                      return true;
                    })
                    .map(item => 
                      h('div', {
                        key: item.name,
                        style: {
                          padding: '0.75rem',
                          border: '1px solid #e2e8f0',
                          borderRadius: '8px',
                          marginBottom: '0.5rem',
                          cursor: 'pointer',
                          background: 'white',
                          transition: 'all 0.2s'
                        },
                        onMouseEnter: (e) => e.currentTarget.style.background = '#f8fafc',
                        onMouseLeave: (e) => e.currentTarget.style.background = 'white',
                        onClick: async () => {
                          // 수량 입력 받기
                          const qty = prompt(
                            language === 'ko' ? `${item.name} 수량을 입력하세요:` : `Enter quantity for ${item.name}:`,
                            '1'
                          );
                          
                          if (qty && parseFloat(qty) > 0) {
                            const newItem = {
                              ...item,
                              shortage: parseFloat(qty),
                              selected_vendor: item.vendor || '⚠️ Not Assigned'
                            };
                            
                            const updatedList = [...shoppingList, newItem];
                            setShoppingList(updatedList);
                            await window.db.ref(getPath('shopping')).set(updatedList);
                            
                            setShowAddItemModal(false);
                            setAddItemSearch('');
                            alert(language === 'ko' ? '추가되었습니다!' : 'Added!');
                          }
                        }
                      }, [
                        h('div', { key: 'name', style: { fontWeight: '600', marginBottom: '0.25rem' }}, 
                          storageIcons[item.category] + ' ' + item.name),
                        h('div', { key: 'info', style: { fontSize: '0.875rem', color: '#64748b' }},
                          `${item.vendor || 'No vendor'} • $${item.price}`)
                      ])
                    )
                ),
                
                // 닫기 버튼
                h('button', {
                  key: 'close',
                  className: 'btn',
                  onClick: () => {
                    setShowAddItemModal(false);
                    setAddItemSearch('');
                  },
                  style: {
                    marginTop: '1rem',
                    background: '#64748b'
                  }
                }, language === 'ko' ? '닫기' : 'Close')
              ])
            ])
          ]),

          activeTab === 'reports' && h('div', { key: 'reports' }, [
            h('div', { key: 'tabs', style: { display: 'flex', gap: '0.5rem', marginBottom: '1.5rem', overflowX: 'auto' }}, [
              h('button', { key: 'history', className: 'nav-btn' + (reportsSubTab === 'history' ? ' active' : ''), onClick: () => setReportsSubTab('history') }, t.purchaseHistory),
              h('button', { key: 'analysis', className: 'nav-btn' + (reportsSubTab === 'analysis' ? ' active' : ''), onClick: () => setReportsSubTab('analysis') }, t.itemAnalysis),
              h('button', { key: 'count', className: 'nav-btn' + (reportsSubTab === 'count' ? ' active' : ''), onClick: () => setReportsSubTab('count') }, t.countRecords),
              h('button', { key: 'excel', className: 'nav-btn' + (reportsSubTab === 'excel' ? ' active' : ''), onClick: () => setReportsSubTab('excel') }, t.exportExcel)
            ]),

            reportsSubTab === 'history' && [
              purchaseHistory.length === 0 ? h('div', { key: 'empty', className: 'card', style: { textAlign: 'center', padding: '2rem', color: '#64748b' }}, t.noData) :
              purchaseHistory.map((purchase, i) =>
                h('div', { 
                  key: i, 
                  className: 'card', 
                  style: { color: '#2c3e50', cursor: 'pointer' },
                  onClick: () => setSelectedPurchase(purchase)
                }, [
                  h('div', { key: 'header', style: { display: 'flex', justifyContent: 'space-between', marginBottom: '0.75rem', paddingBottom: '0.75rem', borderBottom: '2px solid #e2e8f0' }}, [
                    h('div', { key: 'date', style: { fontWeight: '600' }}, purchase.date + ' ' + purchase.time),
                    h('div', { key: 'total', style: { fontWeight: '700', color: '#4ade80' }}, '$' + purchase.totalCost.toFixed(2))
                  ]),
                  h('div', { key: 'summary', style: { fontSize: '0.875rem', color: '#64748b' }}, purchase.totalItems + ' items')
                ])
              )
            ],

            reportsSubTab === 'analysis' && [
              h('div', { key: 'search-bar', className: 'card', style: { marginBottom: '1rem', padding: '1rem' }}, [
                h('input', {
                  key: 'search',
                  type: 'text',
                  placeholder: language === 'ko' ? '🔍 아이템 검색...' : '🔍 Search items...',
                  value: itemSearchQuery,
                  onChange: (e) => setItemSearchQuery(e.target.value),
                  style: {
                    width: '100%',
                    padding: '0.75rem',
                    border: '2px solid #e2e8f0',
                    borderRadius: '8px',
                    fontSize: '1rem',
                    outline: 'none'
                  },
                  onFocus: (e) => e.target.style.borderColor = '#7f1d1d',
                  onBlur: (e) => e.target.style.borderColor = '#e2e8f0'
                })
              ]),
              purchaseHistory.length === 0 ? h('div', { key: 'empty', className: 'card', style: { textAlign: 'center', padding: '2rem', color: '#64748b' }}, t.noHistory) :
              (() => {
                // 검색 필터링
                const filteredItems = items.filter(item => 
                  item.name.toLowerCase().includes(itemSearchQuery.toLowerCase())
                );
                
                return filteredItems.length === 0 ? 
                  h('div', { key: 'no-results', className: 'card', style: { textAlign: 'center', padding: '2rem', color: '#64748b' }}, 
                    language === 'ko' ? '검색 결과가 없습니다' : 'No results found') :
                  filteredItems.map((item, idx) => {
                    const usage = getItemUsageData(item.name);
                    return h('div', { key: item.name, className: 'card', style: { color: '#2c3e50' }}, [
                      h('div', { key: 'header', style: { display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '0.75rem' }}, [
                        h('div', { key: 'left' }, [
                          h('div', { key: 'name', style: { fontWeight: '600', display: 'flex', alignItems: 'center', gap: '0.5rem', color: '#2c3e50' }}, [
                            h('span', { key: 'icon' }, storageIcons[item.category]),
                            h('span', { key: 'text' }, item.name)
                          ]),
                          h('div', { key: 'stats', style: { fontSize: '0.875rem', color: '#64748b', marginTop: '0.25rem' }}, 
                            t.lastUsed + ': ' + usage.lastUsed.toFixed(1) + ' | ' + t.weeklyAvg + ': ' + usage.weeklyAvg.toFixed(1))
                        ]),
                        usage.chartData.values.length > 0 && h('button', { 
                          key: 'chart-btn',
                          onClick: () => setExpandedChart(expandedChart === item.name ? null : item.name),
                          style: { 
                            background: expandedChart === item.name ? 'rgba(96,165,250,0.2)' : 'rgba(255,255,255,0.1)',
                            border: '1px solid rgba(96,165,250,0.3)',
                            borderRadius: '8px',
                            color: '#7f1d1d',
                            cursor: 'pointer',
                            padding: '0.5rem 0.75rem',
                            fontSize: '0.875rem',
                            whiteSpace: 'nowrap'
                          }
                        }, expandedChart === item.name ? t.hideChart : t.showChart)
                      ]),
                      expandedChart === item.name && usage.chartData.values.length > 0 && h('div', { key: 'chart', style: { marginTop: '1rem', background: 'rgba(0,0,0,0.2)', padding: '1rem', borderRadius: '8px' }}, [
                        h('div', { key: 'title', style: { fontSize: '0.875rem', color: '#64748b', marginBottom: '0.5rem' }}, t.usageChart),
                        h('div', { key: 'chart-container', style: { height: '200px', position: 'relative' }}, [
                          h('canvas', { key: 'canvas', id: 'chart-' + item.name, ref: (canvas) => {
                            if (canvas && expandedChart === item.name) {
                              const ctx = canvas.getContext('2d');
                              if (canvas.chart) canvas.chart.destroy();
                              canvas.chart = new Chart(ctx, {
                                type: 'line',
                                data: {
                                  labels: usage.chartData.labels,
                                  datasets: [{
                                    label: t.qty,
                                    data: usage.chartData.values,
                                    borderColor: '#7f1d1d',
                                    backgroundColor: 'rgba(127,29,29,0.1)',
                                    tension: 0,  // 직선 제거 (부드러운 곡선 X)
                                    fill: false,  // 배경 채우기 제거
                                    pointRadius: 6,  // 포인트 크기
                                    pointBackgroundColor: '#7f1d1d',  // 포인트 색상
                                    pointBorderColor: '#ffffff',  // 포인트 테두리
                                    pointBorderWidth: 2,  // 포인트 테두리 두께
                                    pointHoverRadius: 8,  // 마우스 올렸을 때 크기
                                    showLine: true  // 선은 표시 (포인트 연결)
                                  }]
                                },
                                options: {
                                  responsive: true,
                                  maintainAspectRatio: false,
                                  plugins: { legend: { display: false }},
                                  scales: {
                                    y: { 
                                      beginAtZero: true,
                                      grid: { color: 'rgba(255,255,255,0.1)' },
                                      ticks: { color: '#2c3e50' }
                                    },
                                    x: { 
                                      grid: { color: 'rgba(255,255,255,0.1)' },
                                      ticks: { color: '#2c3e50' }
                                    }
                                  }
                                }
                              });
                            }
                          }})
                        ])
                      ])
                    ]);
                  });
              })()
            ],

            reportsSubTab === 'count' && (
              countRecords.length === 0 ? h('div', { key: 'empty', className: 'card', style: { textAlign: 'center', padding: '2rem', color: '#64748b' }}, t.noData) :
              h('div', { key: 'count-list' }, countRecords.map((record, i) =>
                h('div', { key: i, className: 'card', style: { color: '#2c3e50' }}, [
                  h('div', { key: 'header', style: { display: 'flex', justifyContent: 'space-between', marginBottom: '0.75rem', paddingBottom: '0.75rem', borderBottom: '2px solid #e2e8f0' }}, [
                    h('div', { key: 'date', style: { fontWeight: '600' }}, record.date + ' ' + record.time),
                    h('div', { key: 'total', style: { fontWeight: '700', color: '#7f1d1d' }}, '$' + record.totalValue.toFixed(2))
                  ]),
                  h('div', { key: 'summary', style: { fontSize: '0.875rem', color: '#64748b', marginBottom: '0.75rem' }}, record.totalItems + ' items'),
                  h('button', { 
                    key: 'download', 
                    className: 'btn', 
                    onClick: () => downloadCountRecordExcel(record),
                    style: { background: 'linear-gradient(135deg, #7f1d1d 0%, #991b1b 100%)', fontSize: '0.875rem', padding: '0.5rem 1rem' }
                  }, '📥 엑셀 다운로드')
                ])
              ))
            ),

            reportsSubTab === 'excel' && h('div', { key: 'excel-tab', className: 'card', style: { textAlign: 'center', padding: '3rem' }}, [
              h('div', { key: 'icon', style: { fontSize: '3rem', marginBottom: '1rem' }}, canExportExcel() ? '📥' : '❌'),
              h('h3', { key: 'title', style: { marginBottom: '0.5rem', color: canExportExcel() ? '#fff' : '#f87171' }}, t.exportExcel),
              h('p', { key: 'desc', style: { color: '#64748b', marginBottom: '1.5rem', fontSize: '0.875rem' }}, 
                items.length + ' items • ' + (new Date().toISOString().split('T')[0])),
              !canExportExcel() && h('div', { key: 'requirements', style: { background: 'rgba(248,113,113,0.1)', border: '1px solid rgba(248,113,113,0.3)', borderRadius: '8px', padding: '1rem', marginBottom: '1.5rem', textAlign: 'left' }}, [
                h('div', { key: 'title', style: { fontWeight: '600', marginBottom: '0.5rem', color: '#f87171' }}, language === 'ko' ? '필요한 작업:' : 'Required:'),
                getExcelRequirements().map((req, i) => 
                  h('div', { key: i, style: { fontSize: '0.875rem', color: '#64748b', marginLeft: '0.5rem', marginTop: '0.25rem' }}, '• ' + req)
                )
              ]),
              h('button', { 
                key: 'btn', 
                className: 'btn', 
                onClick: canExportExcel() ? exportToExcel : null,
                disabled: !canExportExcel(),
                style: { 
                  maxWidth: '300px', 
                  margin: '0 auto',
                  opacity: canExportExcel() ? 1 : 0.5,
                  cursor: canExportExcel() ? 'pointer' : 'not-allowed',
                  background: canExportExcel() ? 'linear-gradient(135deg, #7f1d1d 0%, #991b1b 100%)' : 'rgba(255,255,255,0.1)'
                }
              }, '📥 ' + t.exportExcel),
              
              h('div', { key: 'divider', style: { margin: '2rem 0', borderTop: '1px solid #e2e8f0' }}),
              
              h('div', { key: 'monthly-section' }, [
                h('div', { key: 'icon', style: { fontSize: '2.5rem', marginBottom: '1rem' }}, '📊'),
                h('h3', { key: 'title', style: { marginBottom: '0.5rem', color: '#7f1d1d' }}, '월간 사용량 리포트'),
                h('p', { key: 'desc', style: { color: '#64748b', marginBottom: '1.5rem', fontSize: '0.875rem' }}, 
                  '이번 달 구매 내역을 기반으로 아이템별 사용량과 비용을 분석합니다.'),
                h('button', { 
                  key: 'monthly-btn', 
                  className: 'btn', 
                  onClick: downloadMonthlyUsageExcel,
                  style: { 
                    maxWidth: '300px', 
                    margin: '0 auto',
                    background: 'linear-gradient(135deg, #4ade80 0%, #22c55e 100%)'
                  }
                }, '📥 월간 사용량 다운로드')
              ])
            ])
          ]),

          activeTab === 'add' && h('div', { key: 'add' }, [
            h('div', { key: 'tabs', style: { display: 'flex', gap: '0.5rem', marginBottom: '1.5rem', overflowX: 'auto' }}, [
              h('button', { key: 'items', className: 'nav-btn' + (addSubTab === 'items' ? ' active' : ''), onClick: () => setAddSubTab('items') }, t.addItems),
              h('button', { key: 'vendors', className: 'nav-btn' + (addSubTab === 'vendors' ? ' active' : ''), onClick: () => setAddSubTab('vendors') }, t.manageVendors),
              h('button', { key: 'categories', className: 'nav-btn' + (addSubTab === 'categories' ? ' active' : ''), onClick: () => setAddSubTab('categories') }, t.manageCategories || '분류 관리')
            ]),

            addSubTab === 'items' && h('div', { key: 'items-content' }, [
              h('div', { key: 'add-form', className: 'card', style: { background: 'rgba(96,165,250,0.05)', border: '1px solid rgba(96,165,250,0.2)', marginBottom: '2rem' }}, [
                h('h3', { key: 'title', style: { marginBottom: '1rem', color: '#7f1d1d' }}, t.addNewItem),
                h('div', { key: 'inputs', className: 'input-group' }, [
                  // 영어 이름 (필수)
                  h('input', { 
                    key: 'name', 
                    type: 'text', 
                    placeholder: t.itemName + ' (English) *', 
                    value: newItem.name, 
                    onChange: (e) => setNewItem({...newItem, name: e.target.value}) 
                  }),
                  // 한국어 이름
                  h('input', { 
                    key: 'name-ko', 
                    type: 'text', 
                    placeholder: '한국어 이름 (선택)', 
                    value: newItem.name_ko || '', 
                    onChange: (e) => setNewItem({...newItem, name_ko: e.target.value}) 
                  }),
                  // 스페인어 이름
                  h('input', { 
                    key: 'name-es', 
                    type: 'text', 
                    placeholder: 'Nombre en Español (opcional)', 
                    value: newItem.name_es || '', 
                    onChange: (e) => setNewItem({...newItem, name_es: e.target.value}) 
                  }),
                  h('select', { key: 'vendor', value: newItem.vendor, onChange: (e) => setNewItem({...newItem, vendor: e.target.value}) },
                    [h('option', { key: 'empty', value: '' }, t.selectVendor)].concat(vendors.map(v => h('option', { key: v, value: v }, v)))
                  ),
                  h('select', { key: 'item-category', value: newItem.itemCategory || '', onChange: (e) => setNewItem({...newItem, itemCategory: e.target.value}) },
                    [h('option', { key: 'empty', value: '' }, t.itemCategory || '분류 선택')].concat(categories.map(c => h('option', { key: c, value: c }, c)))
                  ),
                  h('div', { key: 'row', style: { display: 'grid', gridTemplateColumns: 'repeat(3, 1fr)', gap: '0.75rem' }}, [
                    h('input', { key: 'price', type: 'number', placeholder: '$ ' + t.price, value: newItem.price || '', onChange: (e) => setNewItem({...newItem, price: parseFloat(e.target.value) || 0}) }),
                    h('input', { key: 'par', type: 'number', placeholder: 'PAR', value: newItem.par || '', onChange: (e) => setNewItem({...newItem, par: parseFloat(e.target.value) || 0}) }),
                    h('select', { key: 'category', value: newItem.category, onChange: (e) => setNewItem({...newItem, category: e.target.value}) }, [
                      h('option', { key: 'frozen', value: 'frozen' }, '❄️ ' + t.frozen),
                      h('option', { key: 'refrigerated', value: 'refrigerated' }, '🧊 ' + t.refrigerated),
                      h('option', { key: 'dry', value: 'dry' }, '📦 ' + t.dry)
                    ])
                  ])
                ]),
                h('button', { key: 'btn', className: 'btn', onClick: addNewItem, style: { marginTop: '0.75rem' }}, '+ ' + t.addItem)
              ]),

              h('h3', { key: 'manage-title', style: { marginBottom: '1rem' }}, t.manageItems),
              h('input', { 
                key: 'search', 
                type: 'text', 
                placeholder: '🔍 ' + t.searchItems, 
                value: itemSearch, 
                onChange: (e) => {
                  setItemSearch(e.target.value);
                  setSearchTrigger(prev => prev + 1);
                },
                style: { marginBottom: '1rem' }
              }),
              h('div', { key: 'items-list-' + itemSearch + '-' + searchTrigger }, [
                (() => {
                  let filtered = Array.isArray(items) ? items : [];
                  
                  // 검색어 필터링
                  if (itemSearch) {
                    filtered = filtered.filter(item => 
                      item.name.toLowerCase().includes(itemSearch.toLowerCase())
                    );
                  }
                  
                  return (Array.isArray(filtered) ? filtered : []).map((item, filterIdx) => {
                    const idx = items.findIndex(i => i.name === item.name);
                return h('div', { key: 'item-' + idx, className: 'card', style: { color: '#2c3e50' }}, [
                  editingItem === idx ? h('div', { key: 'edit', className: 'input-group' }, [
                    h('input', { 
                      key: 'name', 
                      type: 'text', 
                      placeholder: 'English Name *',
                      value: item.name, 
                      onChange: (e) => { const u = [...items]; u[idx].name = e.target.value; setItems(u); }
                    }),
                    h('input', { 
                      key: 'name-ko', 
                      type: 'text', 
                      placeholder: '한국어 이름',
                      value: item.name_ko || '', 
                      onChange: (e) => { const u = [...items]; u[idx].name_ko = e.target.value; setItems(u); }
                    }),
                    h('input', { 
                      key: 'name-es', 
                      type: 'text', 
                      placeholder: 'Nombre en Español',
                      value: item.name_es || '', 
                      onChange: (e) => { const u = [...items]; u[idx].name_es = e.target.value; setItems(u); }
                    }),
                    h('select', { 
                      key: 'vendor', 
                      value: item.vendor, 
                      onChange: async (e) => { 
                        const newVendor = e.target.value;
                        const itemName = item.name;
                        
                        // items 업데이트
                        const u = [...items]; 
                        u[idx].vendor = newVendor; 
                        setItems(u);
                        await window.db.ref(getPath('items')).set(u);
                        
                        // Shopping List에 해당 아이템이 있으면 업데이트
                        if (shoppingList.length > 0) {
                          const shoppingIndex = shoppingList.findIndex(si => si.name === itemName);
                          if (shoppingIndex !== -1) {
                            const updatedShopping = [...shoppingList];
                            updatedShopping[shoppingIndex].selected_vendor = newVendor;
                            setShoppingList(updatedShopping);
                            await window.db.ref(getPath('shopping')).set(updatedShopping);
                            console.log(`✅ Shopping List도 업데이트: ${itemName} → ${newVendor}`);
                          }
                        }
                      },
                      style: {
                        background: !vendors.includes(item.vendor) ? '#fef2f2' : 'white',
                        border: !vendors.includes(item.vendor) ? '2px solid #ef4444' : '1px solid #e2e8f0',
                        color: !vendors.includes(item.vendor) ? '#ef4444' : '#2c3e50',
                        fontWeight: !vendors.includes(item.vendor) ? '700' : '400'
                      }
                    }, [
                      !vendors.includes(item.vendor) && h('option', { key: 'invalid', value: item.vendor }, `⚠️ ${item.vendor} (삭제됨)`),
                      ...vendors.map(v => h('option', { key: v, value: v }, v))
                    ]),
                    h('select', { key: 'item-category', value: itemCategories[item.name] || '', onChange: (e) => updateItemCategory(item.name, e.target.value) },
                      [h('option', { key: 'empty', value: '' }, t.itemCategory || '분류 선택')].concat(categories.map(c => h('option', { key: c, value: c }, c)))
                    ),
                    h('div', { key: 'row', style: { display: 'grid', gridTemplateColumns: 'repeat(4, 1fr)', gap: '0.5rem', alignItems: 'center' }}, [
                      h('div', { key: 'price-wrapper', style: { display: 'flex', alignItems: 'center', gap: '0.25rem' }}, [
                        h('label', { key: 'label', style: { fontWeight: '600', color: '#2c3e50', fontSize: '0.75rem', whiteSpace: 'nowrap' }}, '$'),
                        h('input', { 
                          key: 'price', 
                          type: 'number',
                          inputMode: 'decimal',
                          pattern: '[0-9]*',
                          value: item.price,
                          onFocus: (e) => e.target.select(),
                          onChange: (e) => { const u = [...items]; u[idx].price = parseFloat(e.target.value) || 0; setItems(u); }, 
                          placeholder: '0.00', 
                          style: { flex: 1, minWidth: '60px' }
                        })
                      ]),
                      h('div', { key: 'par-wrapper', style: { display: 'flex', alignItems: 'center', gap: '0.25rem' }}, [
                        h('label', { key: 'label', style: { fontWeight: '600', color: '#2c3e50', fontSize: '0.75rem', whiteSpace: 'nowrap' }}, 'PAR'),
                        h('input', { 
                          key: 'par', 
                          type: 'number',
                          inputMode: 'decimal',
                          pattern: '[0-9]*',
                          value: item.par,
                          onFocus: (e) => e.target.select(),
                          onChange: (e) => { const u = [...items]; u[idx].par = parseFloat(e.target.value) || 0; setItems(u); }, 
                          placeholder: '0', 
                          style: { flex: 1, minWidth: '50px' }
                        })
                      ]),
                      h('select', { key: 'category', value: item.category, onChange: (e) => { const u = [...items]; u[idx].category = e.target.value; setItems(u); }}, [
                        h('option', { key: 'frozen', value: 'frozen' }, '❄️ ' + t.frozen),
                        h('option', { key: 'refrigerated', value: 'refrigerated' }, '🧊 ' + t.refrigerated),
                        h('option', { key: 'dry', value: 'dry' }, '📦 ' + t.dry)
                      ]),
                      h('button', { key: 'save', onClick: saveEditItem, style: { background: '#4ade80', border: 'none', borderRadius: '8px', color: '#000', cursor: 'pointer', padding: '0.5rem', fontWeight: '600' }}, '✓')
                    ])
                  ]) : h('div', { key: 'view', style: { display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}, [
                    h('div', { key: 'info' }, [
                      h('div', { key: 'name', style: { fontWeight: '600', display: 'flex', alignItems: 'center', gap: '0.5rem', marginBottom: '0.25rem', color: '#2c3e50' }}, [
                        h('span', { key: 'icon', style: { color: categoryColors[item.category] }}, storageIcons[item.category]),
                        h('span', { key: 'text' }, item.name + (itemCategories[item.name] ? ' - ' + itemCategories[item.name] : ''))
                      ]),
                      h('div', { key: 'meta', style: { fontSize: '0.75rem', color: 'rgba(255,255,255,0.5)' }}, item.vendor + ' • $' + item.price + ' • PAR: ' + item.par)
                    ]),
                    h('div', { key: 'actions', style: { display: 'flex', gap: '0.5rem' }}, [
                      h('button', { 
                        key: 'image', 
                        onClick: () => {
                          setSelectedItemForImage(item);
                          setShowImageModal(true);
                        }, 
                        style: { 
                          background: 'rgba(168,85,247,0.1)', 
                          border: '1px solid rgba(168,85,247,0.3)', 
                          borderRadius: '8px', 
                          color: '#a855f7', 
                          cursor: 'pointer', 
                          padding: '0.5rem', 
                          fontSize: '0.875rem',
                          position: 'relative'
                        }
                      }, [
                        '📸',
                        item.imageUrl && h('span', {
                          key: 'check',
                          style: {
                            position: 'absolute',
                            top: '-4px',
                            right: '-4px',
                            background: '#10b981',
                            color: 'white',
                            borderRadius: '50%',
                            width: '16px',
                            height: '16px',
                            display: 'flex',
                            alignItems: 'center',
                            justifyContent: 'center',
                            fontSize: '10px',
                            fontWeight: 'bold'
                          }
                        }, '✓')
                      ]),
                      h('button', { key: 'edit', onClick: () => setEditingItem(idx), style: { background: 'rgba(96,165,250,0.1)', border: '1px solid rgba(96,165,250,0.3)', borderRadius: '8px', color: '#7f1d1d', cursor: 'pointer', padding: '0.5rem', fontSize: '0.875rem' }}, '✏️'),
                      h('button', { key: 'delete', onClick: () => deleteItem(idx), style: { background: 'rgba(248,113,113,0.1)', border: '1px solid rgba(248,113,113,0.3)', borderRadius: '8px', color: '#f87171', cursor: 'pointer', padding: '0.5rem', fontSize: '0.875rem' }}, '🗑️')
                    ])
                  ])
                ]);
              });
            })()
              ]),
              items.length > 50 && h('div', { key: 'more', style: { textAlign: 'center', padding: '1rem', color: 'rgba(255,255,255,0.5)' }}, 'Showing first 50 items')
            ]),

            addSubTab === 'vendors' && h('div', { key: 'vendors-content' }, [
              h('div', { key: 'add-form', className: 'card', style: { background: 'rgba(96,165,250,0.05)', border: '1px solid rgba(96,165,250,0.2)', marginBottom: '2rem' }}, [
                h('h3', { key: 'title', style: { marginBottom: '1rem', color: '#7f1d1d' }}, t.addVendor),
                h('div', { key: 'inputs', style: { display: 'flex', gap: '0.75rem' }}, [
                  h('input', { key: 'name', type: 'text', placeholder: t.vendorName, value: newVendor, onChange: (e) => setNewVendor(e.target.value), style: { flex: 1 }}),
                  h('button', { key: 'btn', className: 'btn', onClick: addVendor, style: { width: 'auto', padding: '0.75rem 1.5rem' }}, '+ ' + t.addVendor)
                ])
              ]),

              h('h3', { key: 'manage-title', style: { marginBottom: '1rem' }}, t.manageVendors),
              h('div', { key: 'list', style: { display: 'grid', gap: '0.75rem' }},
                vendors.map((vendor, idx) =>
                  h('div', { key: idx, className: 'card', style: { display: 'flex', justifyContent: 'space-between', alignItems: 'center', padding: '1rem' }}, [
                    h('span', { key: 'name', style: { fontWeight: '600' }}, vendor),
                    h('button', { key: 'delete', onClick: () => deleteVendor(vendor), style: { background: 'rgba(248,113,113,0.1)', border: '1px solid rgba(248,113,113,0.3)', borderRadius: '8px', color: '#f87171', cursor: 'pointer', padding: '0.5rem', fontSize: '0.875rem' }}, '🗑️')
                  ])
                )
              ),

              h('div', { key: 'reset', style: { marginTop: '3rem', paddingTop: '2rem', borderTop: '2px solid rgba(248,113,113,0.2)' }},
                h('button', { key: 'btn', className: 'btn btn-danger', onClick: () => setShowResetModal(true) }, '⚠️ ' + t.resetData)
              )
            ]),

            addSubTab === 'categories' && h('div', { key: 'categories-content' }, [
              h('div', { key: 'add-form', className: 'card', style: { background: 'rgba(96,165,250,0.05)', border: '1px solid rgba(96,165,250,0.2)', marginBottom: '2rem' }}, [
                h('h3', { key: 'title', style: { marginBottom: '1rem', color: '#7f1d1d' }}, t.addCategory),
                h('div', { key: 'inputs', className: 'input-group', style: { display: 'flex', flexDirection: 'column', gap: '0.75rem' }}, [
                  h('input', { 
                    key: 'name-en', 
                    type: 'text', 
                    placeholder: (language === 'ko' ? '영어명 (필수) *' : language === 'es' ? 'Nombre en inglés (requerido) *' : 'English name (required) *'), 
                    value: newCategory.name_en, 
                    onChange: (e) => setNewCategory({...newCategory, name_en: e.target.value}),
                    style: { width: '100%', padding: '0.75rem', fontSize: '1rem', border: '2px solid #e2e8f0', borderRadius: '8px' }
                  }),
                  h('input', { 
                    key: 'name-ko', 
                    type: 'text', 
                    placeholder: (language === 'ko' ? '한국어명 (선택)' : language === 'es' ? 'Nombre en coreano (opcional)' : 'Korean name (optional)'), 
                    value: newCategory.name_ko, 
                    onChange: (e) => setNewCategory({...newCategory, name_ko: e.target.value}),
                    style: { width: '100%', padding: '0.75rem', fontSize: '1rem', border: '2px solid #e2e8f0', borderRadius: '8px' }
                  }),
                  h('input', { 
                    key: 'name-es', 
                    type: 'text', 
                    placeholder: (language === 'ko' ? '스페인어명 (선택)' : language === 'es' ? 'Nombre en español (opcional)' : 'Spanish name (optional)'), 
                    value: newCategory.name_es, 
                    onChange: (e) => setNewCategory({...newCategory, name_es: e.target.value}),
                    style: { width: '100%', padding: '0.75rem', fontSize: '1rem', border: '2px solid #e2e8f0', borderRadius: '8px' }
                  }),
                  h('div', { key: 'emoji-section', style: { marginBottom: '0.5rem' }}, [
                    h('span', { key: 'label', style: { fontSize: '0.875rem', color: '#64748b', display: 'block', marginBottom: '0.5rem' }}, (language === 'ko' ? '이모지 선택:' : language === 'es' ? 'Seleccionar emoji:' : 'Select emoji:')),
                    h('div', { key: 'emoji-grid', style: { 
                      display: 'grid', 
                      gridTemplateColumns: 'repeat(auto-fill, minmax(40px, 1fr))',
                      gap: '0.5rem',
                      maxWidth: '100%'
                    }}, 
                      ['📦', '🥩', '🦐', '🥬', '🍕', '🍔', '🍟', '🥤', '🍺', '🧤', '🍦', '🧹', '⚙️', '🇰🇷'].map(emoji =>
                        h('button', {
                          key: emoji,
                          onClick: () => setNewCategory({...newCategory, icon: emoji}),
                          style: {
                            width: '100%',
                            aspectRatio: '1',
                            border: newCategory.icon === emoji ? '2px solid #7f1d1d' : '1px solid #e2e8f0',
                            borderRadius: '8px',
                            background: newCategory.icon === emoji ? 'rgba(127,29,29,0.1)' : 'white',
                            cursor: 'pointer',
                            fontSize: '1.5rem',
                            display: 'flex',
                            alignItems: 'center',
                            justifyContent: 'center',
                            padding: '0',
                  whiteSpace: 'nowrap'
                          }
                        }, emoji)
                      )
                    )
                  ]),
                  h('button', { 
                    key: 'btn', 
                    className: 'btn', 
                    onClick: addCategory, 
                    disabled: !newCategory.name_en.trim(),
                    style: { marginTop: '0.5rem', opacity: newCategory.name_en.trim() ? 1 : 0.5 }
                  }, '+ ' + t.addCategory)
                ])
              ]),

              h('h3', { key: 'manage-title', style: { marginBottom: '1rem' }}, t.manageCategories),
              h('div', { key: 'list', style: { display: 'grid', gap: '0.75rem' }},
                categories.map((category, idx) =>
                  h('div', { key: idx, className: 'card', style: { display: 'flex', justifyContent: 'space-between', alignItems: 'center', padding: '1rem' }}, [
                    h('div', { key: 'info', style: { display: 'flex', alignItems: 'center', gap: '0.5rem' }}, [
                      h('span', { key: 'icon', style: { fontSize: '1.5rem' }}, getCategoryIcon(category)),
                      h('span', { key: 'name', style: { fontWeight: '600' }}, getCategoryName(category))
                    ]),
                    h('button', { key: 'delete', onClick: () => deleteCategory(category), style: { background: 'rgba(248,113,113,0.1)', border: '1px solid rgba(248,113,113,0.3)', borderRadius: '8px', color: '#f87171', cursor: 'pointer', padding: '0.5rem', fontSize: '0.875rem' }}, '🗑️ ' + (t.deleteCategory || '삭제'))
                  ])
                )
              )
            ])
          ]),
          
          // 사진 모달
          showImageModal && selectedItemForImage && h('div', {
            key: 'image-modal',
            style: {
              position: 'fixed',
              top: 0,
              left: 0,
              right: 0,
              bottom: 0,
              background: 'rgba(0,0,0,0.5)',
              display: 'flex',
              alignItems: 'center',
              justifyContent: 'center',
              zIndex: 1000,
              padding: '1rem'
            },
            onClick: () => {
              if (!uploadingImage) {
                setShowImageModal(false);
                setSelectedItemForImage(null);
              }
            }
          }, [
            h('div', {
              key: 'modal-content',
              className: 'card',
              style: {
                maxWidth: '500px',
                width: '100%',
                maxHeight: '80vh',
                overflow: 'auto'
              },
              onClick: (e) => e.stopPropagation()
            }, [
              h('h3', { 
                key: 'title', 
                style: { color: '#7f1d1d', marginBottom: '1rem' }
              }, '📸 ' + selectedItemForImage.name),
              
              // 현재 사진 표시
              selectedItemForImage.imageUrl ? h('div', { key: 'current-image' }, [
                h('img', {
                  key: 'img',
                  src: selectedItemForImage.imageUrl,
                  style: {
                    width: '100%',
                    maxHeight: '300px',
                    objectFit: 'contain',
                    borderRadius: '8px',
                    marginBottom: '1rem',
                    background: '#f3f4f6'
                  }
                }),
                h('button', {
                  key: 'delete',
                  className: 'btn',
                  onClick: () => deleteItemImage(selectedItemForImage.name),
                  style: {
                    background: '#ef4444',
                    marginBottom: '1rem',
                    width: '100%'
                  }
                }, language === 'ko' ? '🗑️ 사진 삭제' : '🗑️ Delete Image')
              ]) : h('div', {
                key: 'no-image',
                style: {
                  padding: '2rem',
                  background: '#f3f4f6',
                  borderRadius: '8px',
                  textAlign: 'center',
                  color: '#64748b',
                  marginBottom: '1rem'
                }
              }, language === 'ko' ? '사진이 없습니다' : 'No image'),
              
              // 파일 업로드
              h('div', { key: 'upload' }, [
                h('label', {
                  key: 'label',
                  style: {
                    display: 'block',
                    marginBottom: '0.5rem',
                    fontWeight: '600',
                    color: '#2c3e50'
                  }
                }, language === 'ko' ? '새 사진 업로드:' : 'Upload new image:'),
                h('input', {
                  key: 'file',
                  type: 'file',
                  accept: 'image/*',
                  onChange: (e) => {
                    const file = e.target.files[0];
                    if (file) {
                      uploadItemImage(selectedItemForImage.name, file);
                    }
                  },
                  disabled: uploadingImage,
                  style: {
                    width: '100%',
                    padding: '0.75rem',
                    border: '2px solid #e2e8f0',
                    borderRadius: '8px',
                    marginBottom: '1rem'
                  }
                }),
                uploadingImage && h('div', {
                  key: 'uploading',
                  style: {
                    padding: '0.75rem',
                    background: '#dbeafe',
                    borderRadius: '8px',
                    color: '#1e40af',
                    textAlign: 'center',
                    marginBottom: '1rem'
                  }
                }, language === 'ko' ? '업로드 중...' : 'Uploading...')
              ]),
              
              // 닫기 버튼
              h('button', {
                key: 'close',
                className: 'btn',
                onClick: () => {
                  setShowImageModal(false);
                  setSelectedItemForImage(null);
                },
                disabled: uploadingImage,
                style: {
                  background: '#64748b',
                  width: '100%'
                }
              }, language === 'ko' ? '닫기' : 'Close')
            ])
          ])
        ]),

        showSimpleView && h('div', { key: 'simple-modal', className: 'modal', onClick: () => { if (!purchaseData) setShowSimpleView(false); } },
          h('div', { 
            className: 'modal-content', 
            onClick: (e) => e.stopPropagation(),
            style: {
              maxWidth: '500px',
              width: '90%',
              maxHeight: '85vh',
              padding: '1.25rem'
            }
          }, [
            h('h3', { 
              key: 'title', 
              style: { 
                marginBottom: '0.75rem', 
                color: '#7f1d1d',
                fontSize: '1.25rem'
              }
            }, purchaseData ? '📋 Order Confirmation' : t.simpleView),
            h('pre', { 
              key: 'text', 
              style: { 
                background: '#f3f4f6', 
                padding: '0.875rem', 
                borderRadius: '8px', 
                fontSize: '0.8rem', 
                whiteSpace: 'pre-wrap', 
                marginBottom: '0.875rem', 
                maxHeight: '50vh', 
                overflow: 'auto',
                lineHeight: '1.4'
              }
            }, generateSimpleText()),
            purchaseData ? h('div', { 
              key: 'buttons', 
              style: { 
                display: 'flex', 
                flexDirection: 'column',
                gap: '0.5rem'
              }
            }, [
              h('button', { 
                key: 'copy', 
                className: 'btn', 
                onClick: copyToClipboard,
                style: {
                  background: '#3b82f6',
                  padding: '0.75rem',
                  fontSize: '0.95rem'
                }
              }, copySuccess ? '✓ Copied!' : '📋 Copy to Clipboard'),
              h('div', {
                key: 'action-buttons',
                style: {
                  display: 'grid',
                  gridTemplateColumns: '1fr 1fr',
                  gap: '0.5rem'
                }
              }, [
                h('button', { 
                  key: 'cancel', 
                  className: 'btn btn-secondary', 
                  onClick: () => { 
                    setShowSimpleView(false); 
                    setPurchaseData(null); 
                    setCopySuccess(false);
                  },
                  style: {
                    padding: '0.75rem',
                    fontSize: '0.95rem'
                  }
                }, t.cancel),
                h('button', { 
                  key: 'confirm', 
                  className: 'btn', 
                  onClick: confirmOrderFromSimpleView, 
                  style: { 
                    background: 'linear-gradient(135deg, #4ade80 0%, #22c55e 100%)',
                    padding: '0.75rem',
                    fontSize: '0.95rem'
                  }
                }, '✓ Complete')
              ])
            ]) : h('button', { 
              key: 'copy', 
              className: 'btn', 
              onClick: copyToClipboard,
              style: {
                padding: '0.75rem',
                fontSize: '0.95rem'
              }
            }, copySuccess ? '✓ Copied!' : '📋 Copy')
          ])
        ),

        selectedPurchase && h('div', { key: 'purchase-modal', className: 'modal', onClick: () => setSelectedPurchase(null) },
          h('div', { className: 'modal-content', onClick: (e) => e.stopPropagation() }, [
            h('h3', { key: 'title', style: { marginBottom: '1rem', color: '#7f1d1d' }}, '구매 내역 - ' + selectedPurchase.date),
            h('div', { key: 'summary', style: { marginBottom: '1rem', padding: '1rem', background: '#f8fafc', borderRadius: '8px' }}, [
              h('div', { key: 'total', style: { fontSize: '1.5rem', fontWeight: '700', color: '#4ade80' }}, '$' + selectedPurchase.totalCost.toFixed(2)),
              h('div', { key: 'items', style: { fontSize: '0.875rem', color: '#64748b' }}, selectedPurchase.totalItems + ' items')
            ]),
            h('pre', { key: 'text', style: { background: '#f3f4f6', padding: '1rem', borderRadius: '8px', fontSize: '0.875rem', whiteSpace: 'pre-wrap', marginBottom: '1rem', maxHeight: '50vh', overflow: 'auto' }}, 
              Object.entries(selectedPurchase.items.reduce((acc, item) => {
                const vendor = item.vendor || 'Unknown';
                if (!acc[vendor]) acc[vendor] = [];
                acc[vendor].push(item);
                return acc;
              }, {})).map(([vendor, items]) =>
                vendor + ':\n' + items.map(item => '  ' + item.name + ' - ' + item.quantity + ' × $' + item.price + ' = $' + item.total.toFixed(2)).join('\n')
              ).join('\n\n')
            ),
            h('button', { key: 'close', className: 'btn', onClick: () => setSelectedPurchase(null) }, '닫기')
          ])
        ),

        selectedDateRecords && h('div', { key: 'count-records-modal', className: 'modal', onClick: () => setSelectedDateRecords(null) },
          h('div', { className: 'modal-content', onClick: (e) => e.stopPropagation() }, [
            h('h3', { key: 'title', style: { marginBottom: '1rem', color: '#7f1d1d', display: 'flex', alignItems: 'center', gap: '0.5rem' }}, [
              h('span', { key: 'icon' }, '📅'),
              h('span', { key: 'text' }, selectedDateRecords.date)
            ]),
            h('div', { key: 'count', style: { marginBottom: '1rem', padding: '1rem', background: '#f0fdf4', borderRadius: '8px', border: '2px solid #4ade80' }}, [
              h('div', { key: 'label', style: { fontSize: '0.875rem', color: '#64748b', marginBottom: '0.25rem' }}, t.countCompleted || '실사 완료'),
              h('div', { key: 'value', style: { fontSize: '1.5rem', fontWeight: '700', color: '#22c55e' }}, selectedDateRecords.records.length + ' ' + (language === 'ko' ? '건' : language === 'es' ? 'registros' : 'records'))
            ]),
            h('div', { key: 'records', style: { maxHeight: '50vh', overflow: 'auto' }}, 
              selectedDateRecords.records.map((record, idx) => 
                h('div', { 
                  key: idx, 
                  className: 'card',
                  style: { 
                    marginBottom: '0.75rem',
                    padding: '1rem',
                    background: 'white',
                    border: '2px solid #e2e8f0',
                    borderRadius: '8px'
                  }
                }, [
                  h('div', { key: 'header', style: { display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '0.5rem' }}, [
                    h('div', { key: 'user', style: { display: 'flex', alignItems: 'center', gap: '0.5rem' }}, [
                      h('span', { key: 'icon', style: { fontSize: '1.5rem' }}, '👤'),
                      h('span', { key: 'name', style: { fontWeight: '700', color: '#2c3e50', fontSize: '1rem' }}, record.userName || 'Unknown')
                    ]),
                    h('div', { key: 'time', style: { fontSize: '0.875rem', color: '#64748b' }}, 
                      record.timestamp ? new Date(record.timestamp).toLocaleTimeString(language === 'ko' ? 'ko-KR' : language === 'es' ? 'es-ES' : 'en-US', { hour: '2-digit', minute: '2-digit' }) : ''
                    )
                  ]),
                  record.items && h('div', { key: 'items', style: { fontSize: '0.875rem', color: '#64748b' }}, 
                    (language === 'ko' ? '품목 수: ' : language === 'es' ? 'Artículos: ' : 'Items: ') + record.items.length
                  )
                ])
              )
            ),
            h('button', { key: 'close', className: 'btn', onClick: () => setSelectedDateRecords(null), style: { marginTop: '1rem' }}, t.close || '닫기')
          ])
        ),

        vendorToDelete && h('div', { key: 'vendor-delete-modal', className: 'modal', onClick: () => { setVendorToDelete(null); setVendorReassignments({}); }},
          h('div', { className: 'modal-content', onClick: (e) => e.stopPropagation(), style: { maxWidth: '600px' }}, [
            h('h3', { key: 'title', style: { marginBottom: '1rem', color: '#f87171' }}, '⚠️ Vendor 삭제'),
            h('p', { key: 'warning', style: { marginBottom: '1rem', color: '#666', fontSize: '0.95rem' }}, 
              `"${vendorToDelete}"를 사용하는 아이템이 ${Object.keys(vendorReassignments).length}개 있습니다. 각 아이템을 다른 vendor로 옮겨주세요.`
            ),
            h('div', { key: 'items', style: { maxHeight: '400px', overflow: 'auto', marginBottom: '1rem' }},
              Object.entries(vendorReassignments).map(([itemName, selectedVendor]) => 
                h('div', {
                  key: itemName,
                  style: {
                    display: 'flex',
                    alignItems: 'center',
                    gap: '1rem',
                    padding: '0.75rem',
                    marginBottom: '0.5rem',
                    background: '#f8fafc',
                    borderRadius: '8px',
                    border: '1px solid #e2e8f0'
                  }
                }, [
                  h('div', { key: 'name', style: { flex: 1, fontWeight: '600', color: '#2c3e50' }}, itemName),
                  h('div', { key: 'arrow', style: { color: '#64748b', fontSize: '1.2rem' }}, '→'),
                  h('select', {
                    key: 'select',
                    value: selectedVendor,
                    onChange: (e) => {
                      setVendorReassignments({
                        ...vendorReassignments,
                        [itemName]: e.target.value
                      });
                    },
                    style: {
                      padding: '0.5rem',
                      borderRadius: '6px',
                      border: '2px solid #e2e8f0',
                      background: 'white',
                      minWidth: '150px',
                      fontWeight: '600'
                    }
                  }, vendors.filter(v => v !== vendorToDelete).map(v => 
                    h('option', { key: v, value: v }, v)
                  ))
                ])
              )
            ),
            h('div', { key: 'buttons', style: { display: 'flex', gap: '0.75rem' }}, [
              h('button', { 
                key: 'cancel', 
                className: 'btn btn-secondary', 
                onClick: () => { 
                  setVendorToDelete(null); 
                  setVendorReassignments({}); 
                },
                style: { flex: 1 }
              }, '취소'),
              h('button', { 
                key: 'confirm', 
                className: 'btn btn-danger', 
                onClick: confirmVendorDeletion,
                disabled: Object.values(vendorReassignments).some(v => !v),
                style: { 
                  flex: 1,
                  opacity: Object.values(vendorReassignments).some(v => !v) ? 0.5 : 1
                }
              }, `✓ 확인 및 "${vendorToDelete}" 삭제`)
            ])
          ])
        ),

        showResetModal && h('div', { key: 'reset-modal', className: 'modal', onClick: () => { setShowResetModal(false); setResetPassword(''); }},
          h('div', { className: 'modal-content', onClick: (e) => e.stopPropagation() }, [
            h('h3', { key: 'title', style: { marginBottom: '1rem', color: '#f87171' }}, '⚠️ ' + t.resetData),
            h('p', { key: 'warn', style: { marginBottom: '1rem', color: '#666' }}, t.resetWarning),
            h('input', { 
              key: 'pwd', 
              type: 'tel', 
              pattern: '[0-9]*',
              inputMode: 'numeric',
              placeholder: t.enterPassword, 
              value: resetPassword, 
              onChange: (e) => setResetPassword(e.target.value), 
              onKeyPress: (e) => e.key === 'Enter' && handleResetData(), 
              style: { marginBottom: '1rem' }
            }),
            h('div', { key: 'btns', style: { display: 'flex', gap: '0.75rem' }}, [
              h('button', { key: 'cancel', className: 'btn btn-secondary', onClick: () => { setShowResetModal(false); setResetPassword(''); }}, t.cancel),
              h('button', { key: 'reset', className: 'btn btn-danger', onClick: handleResetData }, t.reset)
            ])
          ])
        ),

        showScrollButtons && h('button', { 
          key: 'scroll-top', 
          className: 'scroll-btn scroll-btn-top',
          onClick: scrollToTop,
          style: { opacity: showScrollButtons ? 1 : 0, pointerEvents: showScrollButtons ? 'auto' : 'none' }
        }, '↑'),

        showScrollButtons && h('button', { 
          key: 'scroll-bottom', 
          className: 'scroll-btn scroll-btn-bottom',
          onClick: scrollToBottom,
          style: { opacity: showScrollButtons ? 1 : 0, pointerEvents: showScrollButtons ? 'auto' : 'none' }
        }, '↓')
      ]);
    }

    const root = createRoot(document.getElementById('root'));
    root.render(h(App));
  </script>
</body>
</html>
